// ======= AUTH =======
const SESSION_KEY = 'session';

const loginOverlay = document.getElementById('loginOverlay');
const appRoot = document.getElementById('appRoot');
const loginInput = document.getElementById('loginInput');
const passwordInput = document.getElementById('passwordInput');
const errorMessage = document.getElementById('errorMessage');
const loginButton = document.getElementById('loginButton');

function getSession() {
  try {
    const raw = localStorage.getItem(SESSION_KEY);
    if (!raw) return null;
    const s = JSON.parse(raw);
    if (!s || !s.user || !s.role) return null;
    return s;
  } catch(e) {
    return null;
  }
}

function setSession(user, role, allowedFilter) {
  localStorage.setItem(SESSION_KEY, JSON.stringify({
    user, role, allowedFilter: allowedFilter || null, loginAt: Date.now()
  }));
}

function clearSession() {
  localStorage.removeItem(SESSION_KEY);
}

function isAuthed() {
  return getSession() !== null;
}

function getRole() {
  const s = getSession();
  return s ? s.role : '';
}

function getAllowedFilter() {
  const s = getSession();
  return s ? s.allowedFilter : null;
}

function normalizeLoginValue(v) {
  return (v || '').trim().toUpperCase();
}

// Маппинг логина фотографа (латиница) → ключ фильтра
const ROLE_TO_FILTER = {
  'P1': 'p1',
  'P2': 'p2',
  'P3': 'p3',
  'K1': 'k1',
  'V':  'v',
  'S1': 's1',
  'S2': 's2',
};

/**
 * Returns the Latin filter key for a photographer login, or null if not recognised.
 * @param {string} normalizedLogin - Uppercase Latin login (e.g. 'P1', 'K1', 'V').
 * @returns {string|null} Filter key (e.g. 'p1') or null.
 */
function getPhotographerFilter(normalizedLogin) {
  return ROLE_TO_FILTER[normalizedLogin] || null;
}

function removeErrorState() {
  loginInput.classList.remove('error', 'success');
  passwordInput.classList.remove('error', 'success');
  errorMessage.classList.remove('visible');
  loginButton.disabled = false;
}

function showLogin() {
  appRoot.style.display = 'none';
  loginOverlay.classList.add('visible');
  loginOverlay.setAttribute('aria-hidden', 'false');
  removeErrorState();
  // небольшой UX: фокус в логин
  setTimeout(() => loginInput.focus(), 0);
}

function hideLogin() {
  loginOverlay.classList.remove('visible');
  loginOverlay.setAttribute('aria-hidden', 'true');
  appRoot.style.display = 'flex';
  removeErrorState();
  loginInput.value = '';
  passwordInput.value = '';
}


// ======= MENU LOGIC (как в твоём меню) =======
const avatar = document.getElementById('avatar');
const adminWrapper = document.getElementById('adminWrapper');
const adminText = document.getElementById('adminText');
const filterCapsule = document.getElementById('filterCapsule');
const statusCapsule = document.getElementById('statusCapsule');
const conditionCapsule = document.getElementById('conditionCapsule');
const searchInput = document.getElementById('searchInput');
const carsGrid = document.getElementById('carsGrid');

// ======= OFFSET LOGIC =======
// Grab the sticky header element so we can calculate its height dynamically.
const stickyHeaderEl = document.getElementById('stickyHeader');
/**
 * Adjusts the top offset of the car grid so its first row never appears
 * behind the sticky header. Without this, content can slide under
 * the header as the user scrolls because position: sticky takes the
 * header out of normal flow.
 */
function adjustContentOffset() {
  if (!stickyHeaderEl || !carsGrid) return;
  // Use offsetHeight which includes padding and borders of the header but
  // not any external margin. This gives us a reliable height for
  // spacing the grid below it.
  const headerHeight = stickyHeaderEl.offsetHeight;
  // пробрасываем высоту шапки в CSS, чтобы drawer/overlay всегда были ПОД шапкой
  document.documentElement.style.setProperty('--header-height', headerHeight + 'px');
  carsGrid.style.marginTop = headerHeight + 'px';
}

// Recalculate the offset on resize to handle different viewport widths.
window.addEventListener('resize', adjustContentOffset);

let activeFilter = null;
let activeStatus = 'actual';
let activeCondition = 'new';
let searchQuery = '';
let logoutModule = null;


function applyAccessControl(session) {
  const isAdmin = session && session.role === 'admin';

  // иконка зависит от роли: корона — admin, фотоаппарат — photographer
  avatar.innerHTML = isAdmin
    ? `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M11.219 3.375L8 7.399L4.781 3.375A1.002 1.002 0 0 0 3 4v15c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V4a1.002 1.002 0 0 0-1.781-.625L16 7.399l-3.219-4.024c-.381-.474-1.181-.474-1.562 0M5 19v-2h14.001v2zm10.219-9.375c.381.475 1.182.475 1.563 0L19 6.851L19.001 15H5V6.851l2.219 2.774c.381.475 1.182.475 1.563 0L12 5.601z"/></svg>`
    : `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 8c-2.168 0-4 1.832-4 4s1.832 4 4 4s4-1.832 4-4s-1.832-4-4-4m0 6c-1.065 0-2-.935-2-2s.935-2 2-2s2 .935 2 2s-.935 2-2 2"/><path fill="currentColor" d="M20 5h-2.586l-2.707-2.707A.996.996 0 0 0 14 2h-4a.996.996 0 0 0-.707.293L6.586 5H4c-1.103 0-2 .897-2 2v11c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2M4 18V7h3c.266 0 .52-.105.707-.293L10.414 4h3.172l2.707 2.707A.996.996 0 0 0 17 7h3l.002 11z"/></svg>`;

  // текст: "ADMIN" или логин фотографа
  adminText.textContent = isAdmin ? 'ADMIN' : (session ? session.user : '');

  // шапка всегда видима, кнопка выхода всегда присутствует
  adminWrapper.style.display = '';
  showLogoutModule();

  const buttons = Array.from(document.querySelectorAll('.filter-capsule-btn'));

  if (isAdmin) {
    // разблокируем все
    buttons.forEach(b => { b.disabled = false; });
    return;
  }

  // роль фотографа: фиксируем один фильтр и блокируем остальные
  const fixedFilter = session ? session.allowedFilter : null;
  activeFilter = fixedFilter;

  buttons.forEach(b => {
    const f = b.dataset.filter;
    const isMine = f === fixedFilter;
    b.classList.toggle('active', isMine);
    b.disabled = !isMine;
  });
}



function createLogoutModule() {
  const module = document.createElement('div');
  module.className = 'logout-module';
  module.textContent = 'Выйти';
  module.id = 'logoutModule';

  module.addEventListener('click', (e) => {
    e.stopPropagation();
    clearSession();
    hideLogoutModule();
    resetUIToDefaults();
    showLogin();
  });

  return module;
}

function showLogoutModule() {
  if (logoutModule) return;
  logoutModule = createLogoutModule();
  adminWrapper.insertBefore(logoutModule, avatar);
}

function hideLogoutModule() {
  if (!logoutModule) return;
  logoutModule.remove();
  logoutModule = null;
}

function resetUIToDefaults() {
  activeFilter = null;
  activeStatus = 'actual';
  activeCondition = 'new';
  searchQuery = '';
  searchInput.value = '';
  document.querySelectorAll('.filter-capsule-btn').forEach(b => { b.classList.remove('active'); b.disabled = false; });
  document.querySelectorAll('.status-capsule-btn').forEach(b => b.classList.toggle('active', b.dataset.status === 'actual'));
  document.querySelectorAll('.condition-capsule-btn').forEach(b => b.classList.toggle('active', b.dataset.condition === 'new'));
  adminWrapper.style.display = '';
}

document.addEventListener('click', (e) => {
  const linkItem = e.target.closest('.link-item');
  if (linkItem) {
    e.stopPropagation();
    alert(`Переход по ссылке: ${linkItem.textContent}`);
  }
});

const handleFilterClick = (e) => {
  // фотографу нельзя менять точки
  if (getRole() && getRole() !== 'admin') return;

  const btn = e.target.closest('.filter-capsule-btn');
  if (!btn) return;

  const filter = btn.dataset.filter;
  document.querySelectorAll('.filter-capsule-btn').forEach(b => b.classList.remove('active'));

  if (activeFilter === filter) {
    activeFilter = null;
  } else {
    activeFilter = filter;
    btn.classList.add('active');
  }
  renderCars();
};

const handleStatusClick = (e) => {
  const btn = e.target.closest('.status-capsule-btn');
  if (!btn) return;

  const status = btn.dataset.status;
  document.querySelectorAll('.status-capsule-btn').forEach(b => b.classList.remove('active'));

  activeStatus = status;
  btn.classList.add('active');
  renderCars();
};


const handleConditionClick = (e) => {
  const btn = e.target.closest('.condition-capsule-btn');
  if (!btn) return;

  const condition = btn.dataset.condition;
  document.querySelectorAll('.condition-capsule-btn').forEach(b => b.classList.remove('active'));

  activeCondition = condition;
  btn.classList.add('active');
  renderCars();
};


searchInput.addEventListener('input', (e) => {
  searchQuery = e.target.value;
  renderCars();
});

const handleCarClick = (e) => {
  // если клик по ссылке внутри карточки — не открываем панель
  if (e.target.closest('.link-item')) return;

  const card = e.target.closest('.car-card');
  if (!card) return;

  // пока панель пустая — просто открываем
  openDrawer();
};

filterCapsule.addEventListener('click', handleFilterClick);
statusCapsule.addEventListener('click', handleStatusClick);
conditionCapsule.addEventListener('click', handleConditionClick);
carsGrid.addEventListener('click', handleCarClick);




const DRAWER_DATA_URL = 'data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InJ1Ij4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9IlVURi04Ii8+CjxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIi8+CjxsaW5rIHJlbD0icHJlY29ubmVjdCIgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbSI+CjxsaW5rIHJlbD0icHJlY29ubmVjdCIgaHJlZj0iaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbSIgY3Jvc3NvcmlnaW4+CjxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9SW50ZXI6d2dodEA0MDA7NTAwOzYwMDs3MDAmZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiPgo8c3R5bGU+CiAgICA6cm9vdHsKICAgICAgLS1pbnRlci1yZWd1bGFyOiA0MDA7CiAgICAgIC0taW50ZXItbWVkaXVtOiA1MDA7CiAgICAgIC0taW50ZXItc2VtaWJvbGQ6IDYwMDsKCiAgICAgIC0tcGFnZS1iZzogI0YxRjFGMTsKCiAgICAgIC0td2hpdGU6ICNGRkZGRkY7CiAgICAgIC0tdGV4dC1wcmltYXJ5OiAjMUExQTFBOwogICAgICAtLXRleHQtc2Vjb25kYXJ5OiAjNEI1NTYzOwogICAgICAtLXRleHQtdGVydGlhcnk6ICM4MDgwODA7CgogICAgICAtLWJvcmRlcjogI0U4RThFODsKICAgICAgLS1kaXZpZGVyOiAjRThFOEU4OwoKICAgICAgLS1hZGQtcGhvdG8tY29sb3I6IHZhcigtLWJvcmRlcik7CiAgICAgIC0tYWRkLXBob3RvLWNvbG9yLXVzZWQ6IHZhcigtLXVzZWQtYm9yZGVyKTsKCiAgICAgIC0tYnRuLWRhcms6ICMxQTFBMUE7CiAgICAgIC0tYnRuLWRhcmstaG92ZXI6ICMyQTJCMkU7CgogICAgICAtLWJ0bi1kYW5nZXI6ICNGRjRENTc7CiAgICAgIC0tYnRuLWRhbmdlci1ob3ZlcjogI0U2M0I0NTsKCiAgICAgIC0tdXNlZC1iZzogI0VBRjBFRDsKICAgICAgLS11c2VkLWJvcmRlcjogIzAyRDE1QzsKICAgICAgLS11c2VkLWRpdmlkZXI6ICNFN0YwRUI7CiAgICAgIC0tdXNlZC1wYWdlLWJnOiAjRUNGMEVFOwoKICAgICAgLS10aWxlLWVtcHR5OiB2YXIoLS1wYWdlLWJnKTsKICAgICAgLS10aWxlLWFkZDogdHJhbnNwYXJlbnQ7CiAgICAgIC0tdGlsZS1hZGQtdXNlZDogdHJhbnNwYXJlbnQ7CiAgICAgIC0tdGlsZS1lbXB0eS11c2VkOiAjRDFFREREOwoKICAgICAgLS1zaGFkb3ctZmxvYXQ6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjEyKTsKCiAgICAgIC0tcmFkaXVzLWNhcmQ6IDIwcHg7CiAgICAgIC0tcmFkaXVzLWJ0bjogMTBweDsKICAvKiBEZWZpbmUgbGFyZ2VyIHJhZGl1cyB2YWx1ZXMgdG8gbWF0Y2ggY2FyZCBzdHlsaW5nIGZyb20gcGFnZTEgKi8KICAtLXJhZGl1cy1sZzogMjRweDsKICAtLXJhZGl1cy1tZDogMTJweDsKCiAgICAgIC0tZ2FwLXRpbGVzOiA0cHg7CiAgICAgIC0tdGlsZS1yYXRpbzogMTYvOTsKCiAgICAgIC0tYnRuLXNpemU6IGNsYW1wKDM2cHgsIDR2dywgNDJweCk7CiAgICAgIC0tY2FyZC1wYWQ6IDIwcHg7CgogICAgICAvKiB2aWV3ZXIgY29sb3JzICjQv9C+0LQg0YDQtdGE0LXRgNC10L3RgSkgKi8KICAgICAgLS12aWV3ZXItb3ZlcmxheTogcmdiYSgyMzMsIDIzNiwgMjM5LCAwLjk1KTsgLyog0YHQtdGA0YvQuSDRgdC70L7QuSAqLwogICAgICAtLXZpZXdlci1wYW5lbDogcmdiYSgxNywgMjQsIDM5LCAwLjkyKTsgICAgICAvKiDRgtGR0LzQvdGL0Lkg0LHQu9C+0LogKi8KICAgICAgLS12aWV3ZXItcGFuZWwtMjogcmdiYSgxNywgMjQsIDM5LCAwLjgyKTsKICAgICAgLS12aWV3ZXItc3Ryb2tlOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTApOwogICAgICAtLXZpZXdlci1zdHJva2UtMjogcmdiYSgyNTUsMjU1LDI1NSwwLjE2KTsKICAgIH0KCiAgICAqe2JveC1zaXppbmc6Ym9yZGVyLWJveDsgbWFyZ2luOjA7IHBhZGRpbmc6MDt9CiAgICBodG1sLGJvZHl7aGVpZ2h0OmF1dG87bWluLWhlaWdodDowO3dpZHRoOjEwMCU7b3ZlcmZsb3cteDpoaWRkZW47b3ZlcmZsb3cteTp2aXNpYmxlO30KICAgIGJvZHl7CiAgICAgIGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzYW5zLXNlcmlmOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wYWdlLWJnKTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICAgIHBhZGRpbmc6IDIwcHg7CiAgICAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IGFudGlhbGlhc2VkOwogICAgICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOwogICAgfQoKICAgIC53cmFwewogICAgICBtYXgtd2lkdGg6IDEwMCU7CiAgICAgIG1hcmdpbjogMDsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47CiAgICAgIGdhcDogMjBweDsKICAgIH0KCiAgICAvKiBTZWN0aW9uIGhlYWRlciAqLwogICAgLnNlY3Rpb24taGVhZGVyewogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47CiAgICAgIGdhcDogMTJweDsKICAgIH0KICAgIC5zZWN0aW9uLXRpdGxlewogICAgICBmb250LXNpemU6IDIwcHg7CiAgICAgIGZvbnQtd2VpZ2h0OiB2YXIoLS1pbnRlci1zZW1pYm9sZCk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOwogICAgfQogICAgLnNlY3Rpb24tYWN0aW9uc3sKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGdhcDogOHB4OwogICAgfQoKICAgIC8qIEJ1dHRvbnMgKi8KICAgIC5pY29uLWJ0bnsKICAgICAgd2lkdGg6IHZhcigtLWJ0bi1zaXplKTsKICAgICAgaGVpZ2h0OiB2YXIoLS1idG4tc2l6ZSk7CiAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1idG4pOwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOwogICAgICBjdXJzb3I6cG9pbnRlcjsKICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjE1cyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOwogICAgICBmbGV4LXNocmluazowOwogICAgICBwYWRkaW5nOiAwOwogICAgICBsaW5lLWhlaWdodDogMDsKICAgIH0KICAgIC5pY29uLWJ0bjphY3RpdmV7dHJhbnNmb3JtOiBzY2FsZSgwLjk4KTt9CiAgICAuaWNvbi1idG4tLWRhcmt7YmFja2dyb3VuZDogdmFyKC0tYnRuLWRhcmspOyBjb2xvcjogI2ZmZjt9CiAgICAuaWNvbi1idG4tLWRhcms6aG92ZXJ7YmFja2dyb3VuZDogdmFyKC0tYnRuLWRhcmstaG92ZXIpO30KICAgIC5pY29uLWJ0bi0tZGFuZ2Vye2JhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXIpOyBjb2xvcjogI2ZmZjt9CiAgICAuaWNvbi1idG4tLWRhbmdlcjpob3ZlcntiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFuZ2VyLWhvdmVyKTt9CiAgICAuaWNvbi1idG4tLWdob3N0ewogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTApOwogICAgICBjb2xvcjojZmZmOwogICAgICBib3JkZXI6IG5vbmU7CiAgICB9CiAgICAuaWNvbi1idG4tLWdob3N0OmhvdmVyeyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTYpOyB9CgogICAgLmljb257CiAgICAgIHdpZHRoOiAyNHB4OwogICAgICBoZWlnaHQ6IDI0cHg7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOwogICAgfQogICAgLmljb24gc3ZnewogICAgICB3aWR0aDogMThweDsgICAgICAgICAgICAgICAvKiDQstC40LfRg9Cw0LvRjNC90L4gItGC0L7QvdGM0YjQtSIgKi8KICAgICAgaGVpZ2h0OiAxOHB4OwogICAgICBkaXNwbGF5OmJsb2NrOwogICAgICBvcGFjaXR5OiAwLjkyOwogICAgfQoKICAgIC5yb3RhdGUtNDV7IHRyYW5zZm9ybTogcm90YXRlKDQ1ZGVnKTsgfQoKICAgIC8qID09PT09INCh0LLQvtGA0LDRh9C40LLQsNC10LzRi9C1INGB0LXQutGG0LjQuCDQutCw0YDRgtC+0YfQutC4INCw0LLRgtC+0LzQvtCx0LjQu9GPID09PT09ICovCiAgICAuY29sbGFwc2Utc2VjdGlvbiB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgICAgLyogVXNlIGxhcmdlciBib3JkZXItcmFkaXVzIGZvciBjb2xsYXBzaWJsZSBzZWN0aW9ucyB0byBtYXRjaCBwYWdlMSBkZXNpZ24gKi8KICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLWxnKTsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgIH0KICAgIC5zZWN0aW9uLWhlYWRlciB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgcGFkZGluZzogMTZweCAyMHB4OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMTVzIGVhc2U7CiAgICB9CiAgICAuc2VjdGlvbi1oZWFkZXI6aG92ZXIgewogICAgICAvKiBVc2UgbGlnaHQgZ3JleSBob3ZlciBjb2xvdXIgc2ltaWxhciB0byBwYWdlMSAoI0VERURFRCkgKi8KICAgICAgYmFja2dyb3VuZDogI0VERURFRDsKICAgIH0KICAgIC5zZWN0aW9uLWhlYWRlci1sZWZ0IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgZ2FwOiAxMnB4OwogICAgfQogICAgLnNlY3Rpb24taGVhZGVyLXRpdGxlIHsKICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICBmb250LXdlaWdodDogdmFyKC0taW50ZXItc2VtaWJvbGQpOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsKICAgICAgZm9udC1mYW1pbHk6ICdJbnRlcicsIHNhbnMtc2VyaWY7CiAgICB9CiAgICAuY29sbGFwc2UtaWNvbiB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICB3aWR0aDogMjRweDsKICAgICAgaGVpZ2h0OiAyNHB4OwogICAgICBjb2xvcjogI0RBREFEQTsKICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTsKICAgIH0KICAgIC5jb2xsYXBzZS1pY29uIHN2ZyB7CiAgICAgIHdpZHRoOiAyNHB4OwogICAgICBoZWlnaHQ6IDI0cHg7CiAgICB9CiAgICAuY29sbGFwc2UtaWNvbi5leHBhbmRlZCB7CiAgICAgIHRyYW5zZm9ybTogcm90YXRlKDkwZGVnKTsKICAgIH0KICAgIC5zZWN0aW9uLWNvbnRlbnQgewogICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgICAgcGFkZGluZzogdmFyKC0tY2FyZC1wYWQpOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS13aGl0ZSk7CiAgICB9CiAgICAuc2VjdGlvbi1jb250ZW50LmNvbGxhcHNlZCB7CiAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAuc3BlY3MtZ3JpZCB7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMjIwcHgsIDFmcikpOwogICAgICBnYXA6IDIwcHggMjRweDsKICAgIH0KICAgIC5zcGVjLWl0ZW0gewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBnYXA6IDZweDsKICAgIH0KICAgIC5zcGVjLWxhYmVsIHsKICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBmb250LXdlaWdodDogdmFyKC0taW50ZXItbWVkaXVtKTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgZm9udC1mYW1pbHk6ICdJbnRlcicsIHNhbnMtc2VyaWY7CiAgICB9CiAgICAuc3BlYy12YWx1ZSB7CiAgICAgIGZvbnQtc2l6ZTogMTVweDsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7CiAgICAgIGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzYW5zLXNlcmlmOwogICAgfQoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICDQlNC+0L/QvtC70L3QuNGC0LXQu9GM0L3QsNGPINC40L3RhNC+0YDQvNCw0YbQuNGPICjRgdC60L7Qv9C40YDQvtCy0LDQvdC+INC4INCw0LTQsNC/0YLQuNGA0L7QstCw0L3QviDQuNC3IHBhZ2UxKQogICAgICAg0K3RgtC4INGB0YLQuNC70Lgg0L/RgNC40LzQtdC90Y/RjtGC0YHRjyDRgtC+0LvRjNC60L4g0LLQvdGD0YLRgNC4INGB0LXQutGG0LjQuCAjYWRkaXRpb25hbFNlY3Rpb24KICAgICAgINGH0YLQvtCx0Ysg0LLQvdC10YjQvdC40LUg0Y3Qu9C10LzQtdC90YLRiyDRgdGC0YDQsNC90LjRhtGLINC+0YHRgtCw0LvQuNGB0Ywg0L3QtdC40LfQvNC10L3QvdGL0LzQuC4KICAgICovCgogICAgLyog0JfQsNCz0L7Qu9C+0LLQvtC6INC60LDRgNGC0L7Rh9C60Lgg0LDQstGC0L7QvNC+0LHQuNC70Y8gKi8KICAgIC5jYXItY2FyZC10aXRsZXsKICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICBmb250LXdlaWdodDogdmFyKC0taW50ZXItc2VtaWJvbGQpOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsKICAgIH0KCiAgICAvKiDQkdC70L7QuiDQuCDQv9C+0LTQv9GD0L3QutGC0Ysg0LTQvtC/LiDQuNC90YTQvtGA0LzQsNGG0LjQuCAqLwogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5hZGRpdGlvbmFsLWJsb2NrIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgZ2FwOiAyMHB4OwogICAgICBwYWRkaW5nOiAwOwogICAgfQogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5hZGRpdGlvbmFsLWl0ZW0gewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBnYXA6IDIwcHg7CiAgICB9CiAgICAvKiDRg9GB0YLRgNCw0L3Rj9C10Lwg0LTQstC+0LnQvdC+0Lkg0L7RgtGB0YLRg9C/INC/0YDQuCDQv9GD0YHRgtGL0YUg0YHQv9C40YHQutCw0YUgKi8KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAuYWRkaXRpb25hbC1pdGVtLmlzLWVtcHR5IHsKICAgICAgZ2FwOiAwOwogICAgfQogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5hZGRpdGlvbmFsLWl0ZW0uaXMtZW1wdHkgLmNvbW1lbnRzLWxpc3QsCiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmFkZGl0aW9uYWwtaXRlbS5pcy1lbXB0eSAubGlua3MtbGlzdCB7CiAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmFkZGl0aW9uYWwtaGVhZGVyIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgZ2FwOiA4cHg7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmFkZGl0aW9uYWwtdGl0bGUgewogICAgICBmb250LXNpemU6IDIwcHg7CiAgICAgIGZvbnQtd2VpZ2h0OiB2YXIoLS1pbnRlci1zZW1pYm9sZCk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOwogICAgICBmb250LWZhbWlseTogJ0ludGVyJywgc2Fucy1zZXJpZjsKICAgIH0KICAgIC8qINCh0L/QuNGB0L7QuiDQutC+0LzQvNC10L3RgtCw0YDQuNC10LIgKi8KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAuY29tbWVudHMtbGlzdCB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgIGdhcDogNHB4OwogICAgfQogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5jb21tZW50LWJsb2NrIHsKICAgICAgYmFja2dyb3VuZDogI0YxRjFGMTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLW1kKTsKICAgICAgcGFkZGluZzogMjBweDsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDsKICAgICAgZ2FwOiAxMnB4OwogICAgICBtaW4taGVpZ2h0OiBjYWxjKHZhcigtLWJ0bi1zaXplKSArIDQwcHgpOwogICAgICBmb250LWZhbWlseTogSW50ZXIsIHN5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgU2Vnb2UgVUksIFJvYm90bywgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgIH0KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAuY29tbWVudC10ZXh0IHsKICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsKICAgICAgZmxleDogMTsKICAgICAgd29yZC1icmVhazogYnJlYWstd29yZDsKICAgICAgcGFkZGluZy1yaWdodDogMjBweDsKICAgIH0KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAuY29tbWVudC1pbnB1dCB7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBmb250LWZhbWlseTogaW5oZXJpdDsKICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBsaW5lLWhlaWdodDogaW5oZXJpdDsKICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICAgIC8qIEluaGVyaXQgdGhlIGxpZ2h0IGdyZXkgYmFja2dyb3VuZCBmcm9tIHRoZSBjb250YWluZXIgKi8KICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsKICAgICAgLyogU2hvdyBhIHN1YnRsZSBib3JkZXIgbGlrZSBpbiBwYWdlMSAqLwogICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtYnRuKTsKICAgICAgb3V0bGluZTogbm9uZSAhaW1wb3J0YW50OwogICAgICBib3gtc2hhZG93OiBub25lICFpbXBvcnRhbnQ7CiAgICAgIHBhZGRpbmc6IDA7CiAgICAgIG1hcmdpbjogMDsKICAgICAgcmVzaXplOiBub25lOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICBtaW4taGVpZ2h0OiAxLjZlbTsKICAgICAgaGVpZ2h0OiBhdXRvOwogICAgICBmbGV4OiAxOwogICAgICBwYWRkaW5nLXJpZ2h0OiAyMHB4OwogICAgICAtd2Via2l0LXRleHQtc2l6ZS1hZGp1c3Q6IDEwMCU7CiAgICAgIHRleHQtc2l6ZS1hZGp1c3Q6IDEwMCU7CiAgICB9CgogICAgLyogQ2hhbmdlIGJvcmRlciBjb2xvciBvZiB0aGUgY29tbWVudCB0ZXh0YXJlYSBvbiBmb2N1cyBzaW1pbGFyIHRvIHBhZ2UxICovCiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmNvbW1lbnQtaW5wdXQ6Zm9jdXMgewogICAgICBvdXRsaW5lOiBub25lOwogICAgICBib3JkZXItY29sb3I6IHZhcigtLXRleHQtdGVydGlhcnkpOwogICAgfQogICAgLyog0KHQv9C40YHQvtC6INGB0YHRi9C70L7QuiAqLwogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rcy1saXN0IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgZ2FwOiA0cHg7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstaXRlbSB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgcGFkZGluZzogMjBweDsKICAgICAgYmFja2dyb3VuZDogI0YxRjFGMTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLW1kKTsKICAgICAgZ2FwOiAxMnB4OwogICAgICBoZWlnaHQ6IGNhbGModmFyKC0tYnRuLXNpemUpICsgNDBweCk7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstaW5mbyB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4OiAxOwogICAgICBtaW4td2lkdGg6IDA7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstdHlwZSB7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgZm9udC13ZWlnaHQ6IHZhcigtLWludGVyLW1lZGl1bSk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOwogICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICBmbGV4OiAwIDAgYXV0bzsKICAgIH0KICAgIC8qINC00L7QsdCw0LLQu9GP0LXQvCDQtNCy0L7QtdGC0L7Rh9C40LUg0L/QvtGB0LvQtSDQvdCw0LfQstCw0L3QuNGPINGC0LjQv9CwICovCiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstaXRlbTpub3QoLmVkaXRpbmcpIC5saW5rLXR5cGU6OmFmdGVyIHsKICAgICAgY29udGVudDogIjoiOwogICAgICBtYXJnaW4tcmlnaHQ6IDZweDsKICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstdXJsIHsKICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsKICAgICAgLyogdW5kZXJsaW5lIG9ubHkgdW5kZXIgdGhlIHRleHQgKG5vdCB0aGUgd2hvbGUgZmxleCB3aWR0aCkgKi8KICAgICAgdGV4dC1kZWNvcmF0aW9uLWxpbmU6IHVuZGVybGluZTsKICAgICAgdGV4dC1kZWNvcmF0aW9uLXN0eWxlOiBkYXNoZWQ7CiAgICAgIHRleHQtZGVjb3JhdGlvbi1jb2xvcjogI0NCRDVFMTsKICAgICAgdGV4dC11bmRlcmxpbmUtb2Zmc2V0OiAycHg7CgogICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKICAgICAgZmxleDogMSAxIGF1dG87CiAgICAgIG1pbi13aWR0aDogMDsKICAgIH0KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAubGluay11cmw6aG92ZXIgewogICAgICB0ZXh0LWRlY29yYXRpb24tc3R5bGU6IHNvbGlkOwogICAgICB0ZXh0LWRlY29yYXRpb24tY29sb3I6ICM2NDc0OEI7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstZWRpdCB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4OiAxOwogICAgICBtaW4td2lkdGg6IDA7CiAgICAgIGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzYW5zLXNlcmlmOwogICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgIGxpbmUtaGVpZ2h0OiBub3JtYWw7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstdHlwZS1pbnB1dCB7CiAgICAgIHdpZHRoOiAxMjBweDsKICAgICAgbWluLXdpZHRoOiAxMjBweDsKICAgICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICAgIGZvbnQtZmFtaWx5OiBpbmhlcml0OwogICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgIGZvbnQtd2VpZ2h0OiB2YXIoLS1pbnRlci1tZWRpdW0pOwogICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbWQpOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS13aGl0ZSk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOwogICAgICBoZWlnaHQ6IHZhcigtLWJ0bi1zaXplKTsKICAgICAgZmxleDogMCAwIGF1dG87CiAgICAgIG92ZXJmbG93OiB2aXNpYmxlOwogICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgfQogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rLXVybC1pbnB1dCB7CiAgICAgIGZsZXg6IDE7CiAgICAgIG1pbi13aWR0aDogMTQwcHg7CiAgICAgIHBhZGRpbmc6IDZweCAxMHB4OwogICAgICBmb250LWZhbWlseTogaW5oZXJpdDsKICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBmb250LXdlaWdodDogNDAwOwogICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbWQpOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS13aGl0ZSk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOwogICAgICBoZWlnaHQ6IHZhcigtLWJ0bi1zaXplKTsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICAgIC13ZWJraXQtdGV4dC1zaXplLWFkanVzdDogMTAwJTsKICAgIH0KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAubGluay10eXBlLWlucHV0OmZvY3VzLAogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rLXVybC1pbnB1dDpmb2N1cyB7CiAgICAgIG91dGxpbmU6IG5vbmU7CiAgICAgIGJvcmRlci1jb2xvcjogIzk0QTNCODsKICAgIH0KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAubGluay1hY3Rpb25zIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgZ2FwOiA4cHg7CiAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgfQogICAgLyog0KHRgtC40LvQuCDQutC90L7Qv9C+0Log0LLQvdGD0YLRgNC4INCx0LvQvtC60LAg0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90L7QuSDQuNC90YTQvtGA0LzQsNGG0LjQuCAqLwogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5pY29uLWJ0bi5lZGl0LWJ1dHRvbiB7CiAgICAgIGJhY2tncm91bmQ6ICMxQTFBMUE7CiAgICAgIGNvbG9yOiAjRkZGRkZGOwogICAgICBib3JkZXI6IG5vbmU7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmljb24tYnRuLmVkaXQtYnV0dG9uOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZDogIzJBMkEyQTsKICAgICAgY29sb3I6ICNGRkZGRkY7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmljb24tYnRuLmljb24tYnRuLS11cGxvYWQgewogICAgICBiYWNrZ3JvdW5kOiAjREFEQURBOwogICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgYm9yZGVyOiBub25lOwogICAgfQogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5pY29uLWJ0bi5pY29uLWJ0bi0tdXBsb2FkOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZDogI0QyRDJEMjsKICAgICAgY29sb3I6ICMxQTFBMUE7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ1dHRvbiB7CiAgICAgIC8qIE1hdGNoIHBhZ2UxOiByZWQgZmlsbGVkIGJ1dHRvbiB3aXRoIHdoaXRlIGljb24gKi8KICAgICAgYmFja2dyb3VuZDogdmFyKC0tYnRuLWRhbmdlcik7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgY29sb3I6ICNGRkZGRkY7CiAgICB9CiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ1dHRvbjpob3ZlciB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXItaG92ZXIpOwogICAgICBjb2xvcjogI0ZGRkZGRjsKICAgIH0KCiAgICAvKiBFbnN1cmUgdGhlIHRyYXNoIGljb24gaW5zaWRlIHRoZSBkZWxldGUgYnV0dG9uIHVzZXMgdGhlIGJ1dHRvbidzIHdoaXRlIGNvbG91ciAqLwogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5hY3Rpb24tYnV0dG9uLmRlbGV0ZS1idXR0b24gc3ZnLAogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5hY3Rpb24tYnV0dG9uLmRlbGV0ZS1idXR0b246aG92ZXIgc3ZnIHsKICAgICAgZmlsbDogI0ZGRkZGRjsKICAgIH0KCiAgICAvKiBGb3JjZSBwYXRocyBpbnNpZGUgdGhlIHRyYXNoIGljb24gdG8gdXNlIHdoaXRlIGZpbGwgZm9yIHByb3BlciBjb250cmFzdCAqLwogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5hY3Rpb24tYnV0dG9uLmRlbGV0ZS1idXR0b24gc3ZnIHBhdGgsCiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ1dHRvbjpob3ZlciBzdmcgcGF0aCB7CiAgICAgIGZpbGw6ICNGRkZGRkYgIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBSZW1vdmUgcm91bmRlZCBjb3JuZXJzIGZyb20gdGhlIHRleHRhcmVhIG9ubHkgd2hlbiBlZGl0aW5nIHRvIG1hdGNoIHBhZ2UxICovCiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmNvbW1lbnQtYmxvY2suZWRpdGluZyAuY29tbWVudC1pbnB1dHsKICAgICAgYm9yZGVyLXJhZGl1czogMCAhaW1wb3J0YW50OwogICAgfQoKICAgIC8qIFVzZSBidXR0b24tc2l6ZWQgcmFkaXVzIGZvciBsaW5rIGlucHV0cyB0byBiZXR0ZXIgbWF0Y2ggcGFnZTEgKi8KICAgICNhZGRpdGlvbmFsU2VjdGlvbiAubGluay10eXBlLWlucHV0LAogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rLXVybC1pbnB1dHsKICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLWJ0bik7CiAgICB9CgogICAgLyogT24gZm9jdXMsIHVzZSB0ZXJ0aWFyeSB0ZXh0IGNvbG91ciBmb3IgbGluayBpbnB1dCBib3JkZXJzIChzaW1pbGFyIHRvIHBhZ2UxKSAqLwogICAgI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rLXR5cGUtaW5wdXQ6Zm9jdXMsCiAgICAjYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstdXJsLWlucHV0OmZvY3VzewogICAgICBib3JkZXItY29sb3I6IHZhcigtLXRleHQtdGVydGlhcnkpOwogICAgfQoKICAgIC8qIEtpdHMgZ3JpZCAo0LrQsNC6INCyINCc0LXQvdGOLmh0bTogYXV0by1maWxsICsgbWlubWF4KSAqLwogICAgLmtpdHN7CiAgICAgIGRpc3BsYXk6Z3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoNTIwcHgsIDFmcikpOwogICAgICBnYXA6IDIwcHg7CiAgICAgIGFsaWduLWl0ZW1zOnN0YXJ0OwogICAgfQoKICAgIEBtZWRpYSAobWF4LXdpZHRoOiAxMTAwcHgpewogICAgICAua2l0c3sgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoNDYwcHgsIDFmcikpOyB9CiAgICB9CiAgICBAbWVkaWEgKG1heC13aWR0aDogNzgwcHgpewogICAgICBib2R5eyBwYWRkaW5nOiAyMHB4OyB9Ci5raXRzeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgfQogICAgfQoKICAgIC8qIEtpdCBjYXJkICovCiAgICAua2l0LWNhcmR7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLWNhcmQpOwogICAgICBwYWRkaW5nOiB2YXIoLS1jYXJkLXBhZCk7CiAgICAgIG1pbi13aWR0aDogMDsKICAgICAgCiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIH0KCiAgICAvKiBEcmFnIGhhbmRsZSAo0LLQtdGA0YXQvdC40Lkg0LrQvtC90YLRg9GAKSAqLwogICAgLmtpdC1kcmFnLWhhbmRsZXsKICAgICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICAgIHRvcDowOwogICAgICBsZWZ0OjA7CiAgICAgIHJpZ2h0OjA7CiAgICAgIGhlaWdodDogMTRweDsKICAgICAgY3Vyc29yOiBncmFiOwogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogdmFyKC0tcmFkaXVzLWNhcmQpOwogICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogdmFyKC0tcmFkaXVzLWNhcmQpOwogICAgfQogICAgLmtpdC1kcmFnLWhhbmRsZTpob3ZlcnsgYmFja2dyb3VuZDogcmdiYSgyNiwyNiwyNiwwLjAzKTsgfQogICAgLmtpdC1jYXJkLmlzLWRyYWdnaW5nIC5raXQtZHJhZy1oYW5kbGV7IGN1cnNvcjogZ3JhYmJpbmc7IH0KCiAgICAua2l0LWNhcmQuaXMtZHJhZ2dpbmd7CiAgICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1mbG9hdCk7CiAgICB9CgogICAgLmtpdC1wbGFjZWhvbGRlcnsKICAgICAgLyogcGxhY2Vob2xkZXIgb2NjdXBpZXMgc3BhY2UgYnV0IGlzIGludmlzaWJsZSAobm8gJ2xhbmRpbmcgc2xvdCcgVUkpICovCiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtY2FyZCk7CiAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgfQogICAgLmtpdC1jYXJkLmlzLXVzZWQgKyAua2l0LXBsYWNlaG9sZGVyeyBib3JkZXItY29sb3I6IHZhcigtLXVzZWQtYm9yZGVyKTsgfQoKICAgIC5raXQtY2FyZC5pcy11c2VkewogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS11c2VkLWJnKTsKICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS11c2VkLWJvcmRlcik7CiAgICB9CgogICAgLmtpdC10b3B7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjsKICAgICAgZ2FwOiAxMnB4OwogICAgfQoKICAgIC5raXQtdGl0bGV7CiAgICAgIGZvbnQtc2l6ZTogMjBweDsKICAgICAgZm9udC13ZWlnaHQ6IHZhcigtLWludGVyLXNlbWlib2xkKTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICAgIG1pbi13aWR0aDogMDsKICAgICAgZmxleDogMTsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB9CiAgICAua2l0LXRpdGxlW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdeyBvdXRsaW5lOm5vbmU7IH0KICAgIC5raXQtYWN0aW9uc3sKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4LXNocmluazowOwogICAgfQoKICAgIC8qIGRpdmlkZXIgbXVzdCBzcGFuIGZ1bGwgd2lkdGggKi8KICAgIC5raXQtZGl2aWRlcnsKICAgICAgaGVpZ2h0OiAxcHg7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWRpdmlkZXIpOwogICAgICBtYXJnaW46IDIwcHggMDsgLyogMTZweCDQvtGCINGI0LDQv9C60Lgg0LTQviDQu9C40L3QuNC4INC4IDE2cHgg0L7RgiDQu9C40L3QuNC4INC00L4gJ9CY0YHQv9C+0LvRjNC30L7QstCw0L3QvicgKi8KICAgICAgLyogZnVsbC1ibGVlZCDQstC90YPRgtGA0Lgg0LrQsNGA0YLQvtGH0LrQuCDQv9GA0LggcGFkZGluZyA0MHB4ICovCiAgICAgIG1hcmdpbi1sZWZ0OiBjYWxjKHZhcigtLWNhcmQtcGFkKSAqIC0xKTsKICAgICAgbWFyZ2luLXJpZ2h0OiBjYWxjKHZhcigtLWNhcmQtcGFkKSAqIC0xKTsKICAgIH0KCiAgICAua2l0LWNhcmQuaXMtdXNlZCAua2l0LWRpdmlkZXJ7IGJhY2tncm91bmQ6IHZhcigtLXVzZWQtYm9yZGVyKTsgfQoKICAgIC8qIFVzZWQgcm93ICovCiAgICAua2l0LXVzZWQtcm93ewogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAgZ2FwOiAxMHB4OwogICAgICB1c2VyLXNlbGVjdDpub25lOwogICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwoKICAgICAgLyogc2FtZSB0eXBvZ3JhcGh5IGFzIGZvb3RlciAoItCS0YHQtdCz0L4g0YTQvtGC0L4iLCAi0JfQsNCz0YDRg9C20LXQvdC+IikgKi8KICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBmb250LXdlaWdodDogdmFyKC0taW50ZXItcmVndWxhcik7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LXRlcnRpYXJ5KTsKCiAgICAgIC8qIHJvdyBpdHNlbGYgaXMgbm90IGNsaWNrYWJsZTsgb25seSB0aGUgY2hlY2tib3ggaXMgKi8KICAgICAgY3Vyc29yOiBkZWZhdWx0OwogICAgfQoKICAgIC5raXQtY2hlY2t7IGN1cnNvcjogZGVmYXVsdDsgfQogICAgLmtpdC1jYXJkLmlzLWVkaXQgLmtpdC1jaGVja3sgY3Vyc29yOiBwb2ludGVyOyB9Cgoua2l0LWNoZWNrewogICAgICB3aWR0aDogMjBweDsKICAgICAgaGVpZ2h0OiAyMHB4OwogICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLXBhZ2UtYmcpOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgZmxleC1zaHJpbms6MDsKICAgIH0KICAgIC5raXQtY2FyZC5pcy11c2VkIC5raXQtY2hlY2t7IGJhY2tncm91bmQ6ICMwMkQxNUM7IH0KICAgIC5raXQtY2hlY2sgc3Zne3dpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGNvbG9yOiAjZmZmOyBkaXNwbGF5Om5vbmU7IG9wYWNpdHk6IDE7fQogICAgLmtpdC1jYXJkLmlzLXVzZWQgLmtpdC1jaGVjayBzdmd7ZGlzcGxheTpibG9jazt9CgogICAgLyogUGhvdG8gZ3JpZCAqLwogICAgLmtpdC1ncmlkewogICAgICBkaXNwbGF5OmdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDMsIG1pbm1heCgwLCAxZnIpKTsKICAgICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiByZXBlYXQoMiwgYXV0byk7CiAgICAgIGdhcDogdmFyKC0tZ2FwLXRpbGVzKTsKICAgIH0KCiAgICAudGlsZXsKICAgICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBhc3BlY3QtcmF0aW86IHZhcigtLXRpbGUtcmF0aW8pOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS10aWxlLWVtcHR5KTsKICAgICAgb3ZlcmZsb3c6aGlkZGVuOwogICAgICBib3JkZXItcmFkaXVzOiAwOyAvKiDQutCy0LDQtNGA0LDRgtC90YvQtSAqLwogICAgICBjdXJzb3I6IGRlZmF1bHQ7CiAgICB9CiAgICAua2l0LWNhcmQuaXMtdXNlZCAudGlsZS5pcy1lbXB0eXsgYmFja2dyb3VuZDogdmFyKC0tdGlsZS1lbXB0eS11c2VkKTsgfQoKICAgIC50aWxlLmlzLWFkZHsKICAgICAgLyog0LHQtdC3INC+0LHQstC+0LTQutC4OyDQvdC10LnRgtGA0LDQu9GM0L3Ri9C5INGB0LXRgNGL0Lkg0YfRg9GC0Ywg0YHQstC10YLQu9C10LUsINCx0LvQuNC30LrQviDQuiDRhNC+0L3Rgzsg0L/Qu9GO0YEg4oCUINGH0ZHRgNC90YvQuSAqLwogICAgICBiYWNrZ3JvdW5kOiAjREFEQURBOwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgIGNvbG9yOiAjMUExQTFBOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgY3Vyc29yOnBvaW50ZXI7CiAgICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDE0MG1zIGVhc2U7CiAgICB9CiAgICAudGlsZS5pcy1hZGQ6aG92ZXJ7CiAgICAgIGJhY2tncm91bmQ6ICNEMkQyRDI7CiAgICB9CiAgICAudGlsZS5pcy1hZGQuaXMtZHJhZ292ZXJ7CiAgICAgIGJhY2tncm91bmQ6ICNEMkQyRDI7CiAgICB9CgogICAgLyogUGx1cyBzaXplIGluICJhZGQgcGhvdG8iIHRpbGUgKi8KICAgIC50aWxlLmlzLWFkZCAuaWNvbnsgd2lkdGg6IDMwcHg7IGhlaWdodDogMzBweDsgfQogICAgLnRpbGUuaXMtYWRkIC5pY29uIHN2Z3sgd2lkdGg6IDMwcHg7IGhlaWdodDogMzBweDsgb3BhY2l0eTogMTsgfQogICAgLmtpdC1jYXJkLmlzLXVzZWQgLnRpbGUuaXMtYWRkewogICAgICBiYWNrZ3JvdW5kOiAjRDFFREREOwogICAgICBjb2xvcjogIzFBMUExQTsKICAgIH0KCiAgICAudGlsZSBpbWd7CiAgICAgIHdpZHRoOjEwMCU7CiAgICAgIGhlaWdodDoxMDAlOwogICAgICBvYmplY3QtZml0OiBjb3ZlcjsKICAgICAgZGlzcGxheTpibG9jazsKICAgIH0KCiAgICAvKiBIb3Zlcjogb25seSBkYXJrZW4sIG5vIGljb25zICovCiAgICAudGlsZS5pcy1waG90bzo6YWZ0ZXIsCiAgICAuY29sbGFnZS1jZWxsLmlzLXBob3RvOjphZnRlcnsKICAgICAgY29udGVudDoiIjsKICAgICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICAgIGluc2V0OjA7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMCk7CiAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4xNXMgZWFzZTsKICAgICAgcG9pbnRlci1ldmVudHM6bm9uZTsKICAgIH0KICAgIC50aWxlLmlzLXBob3RvOmhvdmVyOjphZnRlcnsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjI1KTsgfQoKICAgIC8qIGNvbGxhZ2UgKHRpbGUgNikgKi8KICAgIC50aWxlLmlzLWNvbGxhZ2V7IHBhZGRpbmc6MDsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7IH0KICAgIC5jb2xsYWdlLWdyaWR7CiAgICAgIHdpZHRoOjEwMCU7CiAgICAgIGhlaWdodDoxMDAlOwogICAgICBkaXNwbGF5OmdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDIsIDFmcik7CiAgICAgIGdyaWQtdGVtcGxhdGUtcm93czogcmVwZWF0KDIsIDFmcik7CiAgICAgIGdhcDogdmFyKC0tZ2FwLXRpbGVzKTsKICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAuY29sbGFnZS1jZWxsewogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgb3ZlcmZsb3c6aGlkZGVuOwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS10aWxlLWVtcHR5KTsKICAgICAgY3Vyc29yOnBvaW50ZXI7CiAgICB9CiAgICAua2l0LWNhcmQuaXMtdXNlZCAuY29sbGFnZS1jZWxsLmlzLWVtcHR5eyBiYWNrZ3JvdW5kOiB2YXIoLS10aWxlLWVtcHR5LXVzZWQpOyB9CiAgICAuY29sbGFnZS1jZWxsIGltZ3sgd2lkdGg6MTAwJTsgaGVpZ2h0OjEwMCU7IG9iamVjdC1maXQ6IGNvdmVyOyBkaXNwbGF5OmJsb2NrOyB9CiAgICAuY29sbGFnZS1jZWxsLmlzLXBob3RvOmhvdmVyOjphZnRlcnsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjI1KTsgfQoKICAgIC5tb3JlLW92ZXJsYXl7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICBpbnNldDowOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjYpOwogICAgICBjb2xvcjojZmZmOwogICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgIGZvbnQtd2VpZ2h0OiB2YXIoLS1pbnRlci1tZWRpdW0pOwogICAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgfQoKICAgIC5raXQtZm9vdGVyewogICAgICBtYXJnaW4tdG9wOiAyMHB4OwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOwogICAgICBnYXA6IDEycHg7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgY29sb3I6IHZhcigtLXRleHQtdGVydGlhcnkpOwogICAgICBmb250LXdlaWdodDogdmFyKC0taW50ZXItcmVndWxhcik7CiAgICB9CiAgICAua2l0LWNhcmQuaXMtdXNlZCAua2l0LWZvb3RlcnsgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsgfQoKICAgIAogICAgLyogPT09PT0gVmlld2VyICjQv9C10YDQtdGA0LDQsdC+0YLQsNC9OiBmdWxsLXNjcmVlbiArIGJsdXIgYmFja2dyb3VuZCArINC70LXQvdGC0LAg0YHQv9GA0LDQstCwKSA9PT09PSAqLwogICAgLnZpZXdlci1iYWNrZHJvcHsKICAgICAgcG9zaXRpb246Zml4ZWQ7CiAgICAgIGluc2V0OjA7CiAgICAgIGRpc3BsYXk6bm9uZTsKICAgICAgei1pbmRleDogOTk5OwogICAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgfQogICAgLnZpZXdlci1iYWNrZHJvcC5vcGVuewogICAgICBkaXNwbGF5OmJsb2NrOwogICAgICBwb2ludGVyLWV2ZW50czphdXRvOwogICAgfQoKICAgIC8qIEJsdXIgZXZlcnl0aGluZyBiZWhpbmQgdmlld2VyICovCiAgICBib2R5LnZpZXdlci1vcGVuID4gKjpub3QoLnZpZXdlci1iYWNrZHJvcCl7CiAgICAgIGZpbHRlcjogYmx1cigxOHB4KTsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVaKDApOwogICAgfQoKICAgIC52aWV3ZXJ7CiAgICAgIHBvc2l0aW9uOmZpeGVkOwogICAgICBpbnNldDogMDsKICAgICAgcGFkZGluZzogMjBweDsKICAgICAgZGlzcGxheTpncmlkOwogICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDEzMnB4IDFmcjsKICAgICAgZ2FwOiAxNnB4OwogICAgICB6LWluZGV4OiAxMDAwOwogICAgfQoKICAgIEBtZWRpYSAobWF4LXdpZHRoOiA5MDBweCl7CiAgICAgIC52aWV3ZXJ7IHBhZGRpbmc6IDE2cHg7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMTEwcHggMWZyOyB9CiAgICB9CgogICAgLnZpZXdlci1yYWlsewogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBwYWRkaW5nOiAxMHB4OwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOmNvbHVtbjsKICAgICAgZ2FwOiA4cHg7CiAgICAgIG1pbi1oZWlnaHQ6IDA7CiAgICB9CgogICAgLnJhaWwtYnRuewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAzNnB4OwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgY3Vyc29yOnBvaW50ZXI7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4wOCk7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgY29sb3I6I2ZmZjsKICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjE1cyBlYXNlOwogICAgICBmbGV4LXNocmluazowOwogICAgfQogICAgLnJhaWwtYnRuOmhvdmVyeyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTQpOyB9CiAgICAucmFpbC1idG46ZGlzYWJsZWR7IG9wYWNpdHk6IDAuNTsgY3Vyc29yOiBkZWZhdWx0OyB9CgogICAgLnZpZXdlci10aHVtYnN7CiAgICAgIG92ZXJmbG93OmF1dG87CiAgICAgIHNjcm9sbC1iZWhhdmlvcjogc21vb3RoOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOmNvbHVtbjsKICAgICAgZ2FwOiA4cHg7CiAgICAgIHBhZGRpbmctcmlnaHQ6IDJweDsKICAgICAgbWluLWhlaWdodDogMDsKICAgICAgZmxleDogMTsKICAgIH0KICAgIC52aWV3ZXItdGh1bWJzOjotd2Via2l0LXNjcm9sbGJhcnsgd2lkdGg6IDZweDsgfQogICAgLnZpZXdlci10aHVtYnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1ieyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTgpOyBib3JkZXItcmFkaXVzOiA2cHg7IH0KICAgIC52aWV3ZXItdGh1bWJzOjotd2Via2l0LXNjcm9sbGJhci10cmFja3sgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjA2KTsgfQoKICAgIC50aHVtYnsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjQ1cyBjdWJpYy1iZXppZXIoMC4yMiwgMSwgMC4zNiwgMSk7CiAgICAgIGFzcGVjdC1yYXRpbzogMS8xOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpOwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBvdmVyZmxvdzpoaWRkZW47CiAgICAgIGN1cnNvcjpwb2ludGVyOwogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBmbGV4LXNocmluazogMDsKICAgIH0KICAgIC50aHVtYiBpbWd7IHdpZHRoOjEwMCU7IGhlaWdodDoxMDAlOyBvYmplY3QtZml0OiBjb3ZlcjsgZGlzcGxheTpibG9jazsgfQogICAgLnRodW1iOjphZnRlcnsKICAgICAgY29udGVudDoiIjsKICAgICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICAgIGluc2V0OjA7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC41OCk7CiAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC40NXMgY3ViaWMtYmV6aWVyKDAuMjIsIDEsIDAuMzYsIDEpLCBvcGFjaXR5IDAuNDVzIGN1YmljLWJlemllcigwLjIyLCAxLCAwLjM2LCAxKTsKICAgICAgcG9pbnRlci1ldmVudHM6bm9uZTsKICAgIH0KICAgIC50aHVtYjpob3Zlcjo6YWZ0ZXJ7IGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC41OCk7IH0KICAgIC50aHVtYi5hY3RpdmV7CiAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwwLjM1KTsKICAgIH0KICAgIC50aHVtYi5hY3RpdmU6OmFmdGVyeyBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMCk7IH0KICAgIC50aHVtYiBpbWd7IHRyYW5zaXRpb246IG9wYWNpdHkgMC40NXMgY3ViaWMtYmV6aWVyKDAuMjIsIDEsIDAuMzYsIDEpOyB9CiAgICAudGh1bWIuYWN0aXZlIGltZ3sgb3BhY2l0eTogMTsgfQoKICAgIC8qIFJpZ2h0OiB2ZXJ0aWNhbCBmaWxtc3RyaXAgKHByZXYvY3VycmVudC9uZXh0KSAqLwogICAgLnZpZXdlci1zdGFnZXsKICAgICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgIG92ZXJmbG93OmhpZGRlbjsKICAgICAgbWluLWhlaWdodDogMDsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXI7CiAgICB9CgogICAgLnN0YWdlLXN0YWNrewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOmNvbHVtbjsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOwogICAgICBnYXA6IDEycHg7CiAgICAgIHBhZGRpbmc6IDE4cHggMTZweDsKICAgIH0KCiAgICAuc3RhZ2UtaXRlbXsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOwogICAgICB1c2VyLXNlbGVjdDpub25lOwogICAgICAtd2Via2l0LXVzZXItZHJhZzpub25lOwogICAgfQoKICAgIC5zdGFnZS1pdGVtLnByZXZpZXd7CiAgICAgIGhlaWdodDogMTh2aDsKICAgICAgb3BhY2l0eTogMC4zMiAhaW1wb3J0YW50OwogICAgICBjdXJzb3I6cG9pbnRlcjsKICAgIAogICAgICAKICAgICAgCiAgICB9CgogICAgLnN0YWdlLWl0ZW0ucHJldmlldzpob3Zlcnsgb3BhY2l0eTogMC4zMiAhaW1wb3J0YW50OyB9CgogICAgLnN0YWdlLWl0ZW0ubWFpbnsKICAgICAgaGVpZ2h0OiA1OHZoOwogICAgfQoKICAgIEBtZWRpYSAobWF4LWhlaWdodDogNzQwcHgpewogICAgICAuc3RhZ2UtaXRlbS5wcmV2aWV3eyBoZWlnaHQ6IDE2dmg7IH0KICAgICAgLnN0YWdlLWl0ZW0ubWFpbnsgaGVpZ2h0OiA1MnZoOyB9CiAgICB9CgogICAgLnN0YWdlLWltZ3sKICAgICAgbWF4LXdpZHRoOiAxMDAlOwogICAgICBtYXgtaGVpZ2h0OiAxMDAlOwogICAgICBvYmplY3QtZml0OiBjb250YWluOwogICAgICB1c2VyLXNlbGVjdDpub25lOwogICAgICAtd2Via2l0LXVzZXItZHJhZzpub25lOwogICAgfQoKICAgIC5zdGFnZS1pdGVtLm1haW4gLnN0YWdlLWltZ3sKICAgICAgbWF4LXdpZHRoOiA5NiU7CiAgICAgIG1heC1oZWlnaHQ6IDk2JTsKICAgIH0KCiAgICAvKiBzdWJ0bGUgaG92ZXIgb24gcHJldmlld3MgKi8KICAgIC8qIFRvcCBjb250cm9scyAqLwogICAgLnZpZXdlci10b3BiYXJ7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICB0b3A6IDE0cHg7CiAgICAgIHJpZ2h0OiAxNHB4OwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAgZ2FwOiAxMHB4OwogICAgICB6LWluZGV4OiA1OwogICAgfQogICAgLnZpZXdlci1jb3VudGVyewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMjBweDsKICAgICAgbGVmdDogMjBweDsKICAgICAgei1pbmRleDogMjU7CiAgICAgIGNvbG9yOiAjMDAwMDAwOwogICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgfQoKICAgIC8qIFJpZ2h0IHNpZGUgdmVydGljYWwgbmF2IGJ1dHRvbnMgKG9wdGlvbmFsKSAqLwogICAgLnZuYXZ7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICByaWdodDogMTZweDsKICAgICAgdG9wOiA1MCU7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47CiAgICAgIGdhcDogMTBweDsKICAgICAgei1pbmRleDogNTsKICAgIH0KICAgIC52bmF2IC5uYXYtYnRuewogICAgICB3aWR0aDogNDZweDsKICAgICAgaGVpZ2h0OiA0NnB4OwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4xMCk7CiAgICAgIGNvbG9yOiNmZmY7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOwogICAgICBjdXJzb3I6cG9pbnRlcjsKICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjE1cyBlYXNlOwogICAgfQogICAgLnZuYXYgLm5hdi1idG46aG92ZXJ7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4xNik7IH0KICAgIC52bmF2IC5uYXYtYnRuIHN2Z3sgd2lkdGg6IDIwcHg7IGhlaWdodDogMjBweDsgZGlzcGxheTpibG9jazsgfQoKICAgIC8qIHByZXZlbnQgYmFja2Ryb3AgY2xpY2sgc2VsZWN0aW5nICovCiAgICAudmlld2VyLCAudmlld2VyICp7IC13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjogdHJhbnNwYXJlbnQ7IH0KICAKICAgIC5pY29uLWJ0bi0tdXBsb2FkewogICAgICAvKiBzYW1lIHN0eWxlIGFzICJhZGQgcGhvdG8iIHRpbGUgKi8KICAgICAgYmFja2dyb3VuZDogI0RBREFEQTsKICAgICAgY29sb3I6ICMxQTFBMUE7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAxNDBtcyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOwogICAgfQogICAgLmljb24tYnRuLS11cGxvYWQ6aG92ZXJ7CiAgICAgIGJhY2tncm91bmQ6ICNEMkQyRDI7CiAgICB9CgogIAogICAgLyogPT09PT0gVmlld2VyIG92ZXJyaWRlcyB0byBtYXRjaCBsYXRlc3Qgc3BlYyA9PT09PSAqLwogICAgLyogQmFja2dyb3VuZDogYmx1ciBvbmx5LCBubyB0aW50ICovCiAgICBib2R5LnZpZXdlci1vcGVuID4gKjpub3QoLnZpZXdlci1iYWNrZHJvcCl7CiAgICAgIGZpbHRlcjogYmx1cigxOHB4KTsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVaKDApOwogICAgfQoKICAgIC52aWV3ZXJ7IHBhZGRpbmc6IDA7IGdhcDogMDsgfSAvKiBmdWxsLXNjcmVlbiwgbm8gZXh0cmEgbWFyZ2lucyAqLwoKICAgIC8qIExlZnQgcmFpbCB1c2VzIGJsdXIgKGdsYXNzKSAqLwogICAgLnZpZXdlci1yYWlsewogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTApOwogICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMThweCk7CiAgICAgIC13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE4cHgpOwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgIHBhZGRpbmc6IDEwcHg7CiAgICAgIHdpZHRoOiAxMzJweDsKICAgIH0KCiAgICAvKiBSYWlsIGJ1dHRvbnM6IGJsYWNrIHdpdGggd2hpdGUgYXJyb3cgKi8KICAgIC5yYWlsLWJ0bnsKICAgICAgYmFja2dyb3VuZDogIzFBMUExQTsKICAgICAgY29sb3I6ICNGRkZGRkY7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgYm9yZGVyLXJhZGl1czogMDsKICAgICAgaGVpZ2h0OiA1MnB4OwogICAgfQogICAgLnJhaWwtYnRuOmhvdmVyeyBiYWNrZ3JvdW5kOiAjMkEyQjJFOyB9CgogICAgLyogdGh1bWJzIGdhcCA0cHggKi8KICAgIC52aWV3ZXItdGh1bWJzeyBnYXA6IDRweDsgfQogICAgLnRodW1iewogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4xOCk7CiAgICB9CgogICAgLyogU3RhZ2U6IGFsc28gZ2xhc3MgYmx1ciAqLwogICAgLnZpZXdlci1zdGFnZXsKICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjA4KTsKICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE4cHgpOwogICAgICAtd2Via2l0LWJhY2tkcm9wLWZpbHRlcjogYmx1cigxOHB4KTsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgfQoKICAgIC8qIFZlcnRpY2FsIHN0YWNrOiBzaG93IHByZXYvbmV4dCBzbGlnaHRseSAqLwogICAgLnN0YWdlLXN0YWNrewogICAgICBnYXA6IDRweDsKICAgICAgcGFkZGluZzogMDsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICB3aWR0aDogMTAwJTsKICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB9CiAgICAuc3RhZ2UtaXRlbS5wcmV2aWV3ewogICAgICBoZWlnaHQ6IDE4dmg7CiAgICAgIG9wYWNpdHk6IDAuMzIgIWltcG9ydGFudDsKICAgIH0KICAgIC5zdGFnZS1pdGVtLm1haW57CiAgICAgIGhlaWdodDogNjR2aDsKICAgIH0KICAgIC5zdGFnZS1pdGVtLm1haW4gLnN0YWdlLWltZ3sKICAgICAgbWF4LXdpZHRoOiAxMDAlOwogICAgICBtYXgtaGVpZ2h0OiAxMDAlOwogICAgfQogICAgLnN0YWdlLWltZ3sgbWF4LXdpZHRoOiAxMDAlOyBtYXgtaGVpZ2h0OiAxMDAlOyB9CgogICAgLyogQ2xvc2UgYnV0dG9uOiBzdGFuZGFyZCBibGFjayBzcXVhcmUgd2l0aCByYWRpdXMgKHVzZXMgb3VyIGljb24tYnRuIGRhcmspICovCiAgICAjdmlld2VyQ2xvc2V7CiAgICAgIGJhY2tncm91bmQ6ICMxQTFBMUE7CiAgICAgIGNvbG9yOiAjRkZGRkZGOwogICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtYnRuKTsKICAgICAgYm9yZGVyOiBub25lOwogICAgfQoKICAgIC8qIFRvcGJhciBwb3NpdGlvbmluZyAqLwogICAgLnZpZXdlci10b3BiYXJ7IHRvcDogMjBweDsgcmlnaHQ6IDIwcHg7IGdhcDogMTBweDsgfQoKICAgIC8qIERlbGV0ZSBidXR0b246IG9ubHkgaW4gZWRpdCwgb24gbWFpbiBwaG90byB0b3AtcmlnaHQgd2l0aCAyMHB4IGluc2V0ICovCiAgICAjdmlld2VyRGVsZXRlQnRuewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMjBweDsKICAgICAgcmlnaHQ6IDIwcHg7CiAgICAgIHotaW5kZXg6IDY7CiAgICB9CiAgICAvKiBXaGVuIGRlbGV0ZSBzaG93biwga2VlcCBjbG9zZSBhdCB0aGUgdmVyeSB0b3AtcmlnaHQgKHN0YWNrKSAqLwogICAgI3ZpZXdlckNsb3NlewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMjBweDsKICAgICAgcmlnaHQ6IDIwcHg7CiAgICAgIHotaW5kZXg6IDc7CiAgICB9CgogICAgLyogQ291bnRlciBzdWJ0bGUgKi8KICAgIC52aWV3ZXItY291bnRlcnsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB0b3A6IDIwcHg7CiAgICAgIGxlZnQ6IDIwcHg7CiAgICAgIHotaW5kZXg6IDI1OwogICAgICBjb2xvcjogIzAwMDAwMDsKICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBmb250LXdlaWdodDogNTAwOwogICAgICB1c2VyLXNlbGVjdDogbm9uZTsKICAgIH0KCiAgICAvKiBSZW1vdmUgYW55IHJlbWFpbmluZyBuYXYgYmxvY2tzICovCiAgICAudm5hdnsgZGlzcGxheTpub25lICFpbXBvcnRhbnQ7IH0KCiAgCiAgICAvKiA9PT09PSBWaWV3ZXIgdHVuZTogY2VudGVyIGltYWdlIGJpZ2dlciwgcHJldmlld3MgMjAlIHZpc2libGUgYW5kIDIwJSBzbWFsbGVyID09PT09ICovCiAgICAudmlld2VyeyBwYWRkaW5nOiAwOyB9CiAgICAudmlld2VyeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDEzMnB4IDFmcjsgfQogICAgLnZpZXdlci1yYWlseyB3aWR0aDogMTMycHg7IH0KICAgIC52aWV3ZXJ7IGdhcDogNHB4OyB9IC8qIDRweCBiZXR3ZWVuIGxlZnQgcmFpbCBhbmQgc3RhZ2UgKi8KCiAgICAudmlld2VyLXN0YWdleyBwYWRkaW5nLXJpZ2h0OiA0cHg7IH0gLyogNHB4IGZyb20gcmlnaHQgZWRnZSAqLwogICAgLnN0YWdlLXN0YWNrewogICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBwYWRkaW5nOiAwOwogICAgICBnYXA6IDRweDsgLyogZ2FwcyBiZXR3ZWVuIHBob3RvcyA0cHggKi8KICAgICAgZGlzcGxheTpncmlkOwogICAgICBncmlkLXRlbXBsYXRlLXJvd3M6IDIwdmggMWZyIDIwdmg7IC8qIHZpc2libGUgYXJlYSBmb3IgcHJldi9uZXh0IH4yMCUgKi8KICAgICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICAgIGp1c3RpZnktaXRlbXM6IHN0cmV0Y2g7CiAgICB9CiAgICAuc3RhZ2UtaXRlbXsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXI7CiAgICAgIG92ZXJmbG93OmhpZGRlbjsKICAgIH0KICAgIC8qIG1haW4gdGFrZXMgbW9zdCBzcGFjZSAqLwogICAgLnN0YWdlLWl0ZW0ubWFpbnsKICAgICAgbWluLWhlaWdodDogMDsKICAgIH0KICAgIC5zdGFnZS1pdGVtLm1haW4gLnN0YWdlLWltZ3sKICAgICAgd2lkdGg6IGNhbGMoMTAwJSAtIDhweCk7ICAvKiA0cHggZnJvbSBsZWZ0IChnYXApICsgNHB4IGZyb20gcmlnaHQgKHN0YWdlIHBhZGRpbmcpIGFwcHJveGltYXRpb24gKi8KICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBtYXgtd2lkdGg6IG5vbmU7CiAgICAgIG1heC1oZWlnaHQ6IG5vbmU7CiAgICAgIG9iamVjdC1maXQ6IGNvbnRhaW47CiAgICB9CiAgICAvKiBwcmV2aWV3cyBhcmUgMjAlIHNtYWxsZXIgdGhhbiBtYWluIHZpc3VhbGx5IHZpYSBzY2FsZSAqLwogICAgLnN0YWdlLWl0ZW0ucHJldmlld3sKICAgICAgb3BhY2l0eTogMC4zMiAhaW1wb3J0YW50OwogICAgfQogICAgLnN0YWdlLWl0ZW0ucHJldmlldyAuc3RhZ2UtaW1newogICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsKICAgICAgZmlsdGVyOiBub25lICFpbXBvcnRhbnQ7CiAgICB9CgogIAogICAgLyogPT09PT0gUEFUQ0ggdjI3OiBmb3JjZSBvdmVycmlkZSAobWFpbiDQvNCw0LrRgdC40LzQsNC70YzQvdC+INCx0L7Qu9GM0YjQvtC5LCBwcmV2L25leHQgPSDRgtC+0YIg0LbQtSDQutCw0LTRgCwg0LLQuNC00L3QsCDRgtC+0LvRjNC60L4g0L/QvtC70L7RgdC60LApID09PT09ICovCiAgICAudmlld2VyewogICAgICBpbnNldDowOwogICAgICBwYWRkaW5nOjAgIWltcG9ydGFudDsKICAgICAgZ2FwOjRweCAhaW1wb3J0YW50OwogICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDE1NnB4IDFmciAhaW1wb3J0YW50OwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpOwogICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMThweCk7CiAgICAgIC13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE4cHgpOwogICAgfQoKICAgIC8qIFJhaWwgYW5kIHN0YWdlIHRyYW5zcGFyZW50IHNvIG5vIHNlYW1zICovCiAgICAudmlld2VyLXJhaWwsCiAgICAudmlld2VyLXN0YWdlewogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50OwogICAgICBiYWNrZHJvcC1maWx0ZXI6IG5vbmUgIWltcG9ydGFudDsKICAgICAgLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6IG5vbmUgIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBMRUZUIFJBSUw6IHNwYWNpbmcgNHB4IGV2ZXJ5d2hlcmUgKi8KICAgIC52aWV3ZXItcmFpbHsKICAgICAgd2lkdGg6IDE1NnB4ICFpbXBvcnRhbnQ7CiAgICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgIG1pbi1oZWlnaHQ6IDEwMHZoOwogICAgICBkaXNwbGF5OmZsZXggIWltcG9ydGFudDsKICAgICAgZmxleC1kaXJlY3Rpb246Y29sdW1uICFpbXBvcnRhbnQ7CiAgICAgIGdhcDogNHB4ICFpbXBvcnRhbnQ7CiAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICB9CgogICAgLnJhaWwtYnRuewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiA1NnB4OwogICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJhY2tncm91bmQ6ICMxQTFBMUEgIWltcG9ydGFudDsKICAgICAgY29sb3I6ICNGRkZGRkY7CiAgICAgIGRpc3BsYXk6ZmxleCAhaW1wb3J0YW50OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXIgIWltcG9ydGFudDsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlciAhaW1wb3J0YW50OwogICAgICBvcGFjaXR5OiAxICFpbXBvcnRhbnQ7CiAgICAgIGZsZXg6IDAgMCBhdXRvOwogICAgfQogICAgLnJhaWwtYnRuOmhvdmVyeyBiYWNrZ3JvdW5kOiMyQTJCMkUgIWltcG9ydGFudDsgfQogICAgLnJhaWwtYnRuOmRpc2FibGVkeyBiYWNrZ3JvdW5kOiMxQTFBMUEgIWltcG9ydGFudDsgY3Vyc29yOiBkZWZhdWx0OyB9CiAgICAucmFpbC1idG46ZGlzYWJsZWQgc3ZneyBvcGFjaXR5OiAwLjM1OyB9CgogICAgLnJhaWwtYnRuIHN2Z3sgd2lkdGg6IDMwcHg7IGhlaWdodDogMzBweDsgb3BhY2l0eTogMC45MjsgfQoKICAgIC52aWV3ZXItdGh1bWJzewogICAgICBmbGV4OiAxIDEgYXV0bzsKICAgICAgbWluLWhlaWdodDogMDsKICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgZGlzcGxheTpmbGV4ICFpbXBvcnRhbnQ7CiAgICAgIGZsZXgtZGlyZWN0aW9uOmNvbHVtbiAhaW1wb3J0YW50OwogICAgICBnYXA6IDRweCAhaW1wb3J0YW50OwogICAgICBvdmVyZmxvdzogYXV0bzsKICAgICAgc2Nyb2xsYmFyLXdpZHRoOiBub25lOwogICAgfQogICAgLnZpZXdlci10aHVtYnM6Oi13ZWJraXQtc2Nyb2xsYmFyeyB3aWR0aDogMDsgaGVpZ2h0OiAwOyB9CgogICAgLnRodW1iewogICAgICB3aWR0aDogMTAwJTsKICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuNDVzIGN1YmljLWJlemllcigwLjIyLCAxLCAwLjM2LCAxKTsKICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgb3ZlcmZsb3c6aGlkZGVuOwogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgZmxleDogMCAwIGF1dG87CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4xOCk7CiAgICB9CgogICAgLyogVGh1bWJzIGRhcmtlciB3aGVuIG5vdCBhY3RpdmUgKi8KICAgIC50aHVtYjo6YWZ0ZXJ7CiAgICAgIGNvbnRlbnQ6IiI7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICBpbnNldDowOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuNTgpOwogICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuNDVzIGN1YmljLWJlemllcigwLjIyLCAxLCAwLjM2LCAxKSwgb3BhY2l0eSAwLjQ1cyBjdWJpYy1iZXppZXIoMC4yMiwgMSwgMC4zNiwgMSk7CiAgICAgIHBvaW50ZXItZXZlbnRzOm5vbmU7CiAgICB9CiAgICAudGh1bWI6aG92ZXI6OmFmdGVyeyBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuNTgpOyB9CiAgICAudGh1bWIuYWN0aXZlOjphZnRlcnsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjApOyB9CiAgICAudGh1bWIgaW1neyB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNDVzIGN1YmljLWJlemllcigwLjIyLCAxLCAwLjM2LCAxKTsgfQogICAgLnRodW1iLmFjdGl2ZSBpbWd7IG9wYWNpdHk6IDE7IH0KCiAgICAvKiBTVEFHRTogZm9yY2UgZnVsbCBoZWlnaHQsIG5vIGlubmVyIHBhZGRpbmcgKi8KICAgIC52aWV3ZXItc3RhZ2V7CiAgICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgIG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlICFpbXBvcnRhbnQ7CiAgICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7CiAgICAgIG1pbi1oZWlnaHQ6IDEwMHZoOwogICAgfQoKICAgIC8qIENvcmU6IGFic29sdXRlIHN0YWNraW5nLCAxOjEgZnJhbWluZyBmb3IgYWxsIHRocmVlICovCiAgICAuc3RhZ2Utc3RhY2t7CiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZSAhaW1wb3J0YW50OwogICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwoKICAgICAgLyogVmlzaWJsZSBzbGl2ZXI7IHNtYWxsZXIgPT4gbWFpbiBiaWdnZXIgKi8KICAgICAgLS1wZWVrOiBjbGFtcCg0NHB4LCA3dmgsIDgwcHgpOwogICAgICAtLWdhcDogNHB4OwogICAgfQoKICAgIC5zdGFnZS1pdGVtewogICAgICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsKICAgICAgbGVmdDogMCAhaW1wb3J0YW50OwogICAgICByaWdodDogMCAhaW1wb3J0YW50OwogICAgICB0b3A6IGNhbGModmFyKC0tcGVlaykgKyB2YXIoLS1nYXApKSAhaW1wb3J0YW50OwogICAgICBib3R0b206IGNhbGModmFyKC0tcGVlaykgKyB2YXIoLS1nYXApKSAhaW1wb3J0YW50OwoKICAgICAgd2lkdGg6IGF1dG8gIWltcG9ydGFudDsKICAgICAgaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7CgogICAgICBkaXNwbGF5OmZsZXggIWltcG9ydGFudDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyICFpbXBvcnRhbnQ7CiAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXIgIWltcG9ydGFudDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwogICAgfQoKICAgIC5zdGFnZS1pdGVtLm1haW57CiAgICAgIHotaW5kZXg6IDI7CiAgICAgIG9wYWNpdHk6IDE7CiAgICAgIGN1cnNvcjogZGVmYXVsdDsKICAgICAgdHJhbnNmb3JtOiBub25lICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLnN0YWdlLWl0ZW0ucHJldmlld3sKICAgICAgei1pbmRleDogMTsKICAgICAgb3BhY2l0eTogMC4zMiAhaW1wb3J0YW50OyAgICAgICAgICAgICAgICAvKiDRgtC10LzQvdC10LUgKi8KICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICBoZWlnaHQ6IGF1dG8gIWltcG9ydGFudDsgICAgICAgLyog0YPQsdC40YLRjCDRgdGC0LDRgNGL0LUgMTh2aCAqLwogICAgfQoKICAgIC8qIFNoaWZ0IGJ5IGl0cyBvd24gZnJhbWUgaGVpZ2h0ICsgNHB4IGdhcCBzbyBvbmx5IHBlZWsgaXMgdmlzaWJsZSAqLwogICAgI3N0YWdlUHJldnsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKGNhbGMoLTEwMCUgLSB2YXIoLS1nYXApKSkgIWltcG9ydGFudDsgfQogICAgI3N0YWdlTmV4dHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKGNhbGMoIDEwMCUgKyB2YXIoLS1nYXApKSkgIWltcG9ydGFudDsgfQoKICAgIC8qIFByZXYvTmV4dCBhcmUgMjAlIG5hcnJvd2VyIHRoYW4gbWFpbiAoMTAlIGluc2V0IGZyb20gZWFjaCBzaWRlKSAqLwogICAgI3N0YWdlUHJldiwgI3N0YWdlTmV4dHsKICAgICAgbGVmdDogMTAlICFpbXBvcnRhbnQ7CiAgICAgIHJpZ2h0OiAxMCUgIWltcG9ydGFudDsKICAgIH0KCiAgICAuc3RhZ2UtaW1newogICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICAgICAgbWF4LXdpZHRoOiBub25lICFpbXBvcnRhbnQ7CiAgICAgIG1heC1oZWlnaHQ6IG5vbmUgIWltcG9ydGFudDsKICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsKICAgIH0KICAgIC5zdGFnZS1pdGVtLnByZXZpZXcgLnN0YWdlLWltZ3sKICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgIG9iamVjdC1maXQ6IGNvbnRhaW47CiAgICAgIGZpbHRlcjogbm9uZSAhaW1wb3J0YW50OwogICAgfQoKICAgIC8qIERlbGV0ZSBpbnNpZGUgbWFpbiwgMjBweCBpbnNldCAqLwogICAgI3N0YWdlTWFpbnsgcG9zaXRpb246IHJlbGF0aXZlOyB9CiAgICAjdmlld2VyRGVsZXRlQnRuewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMjBweDsKICAgICAgcmlnaHQ6IDIwcHg7CiAgICAgIHotaW5kZXg6IDEwOwogICAgfQoKICAgICN2aWV3ZXJDbG9zZXsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB0b3A6IDIwcHg7CiAgICAgIHJpZ2h0OiAyMHB4OwogICAgICB6LWluZGV4OiAyMDsKICAgIH0KCiAgCiAgICAvKiBDT1VOVEVSIE9WRVJSSURFICovCiAgICAudmlld2VyLXN0YWdlIC52aWV3ZXItY291bnRlcnsKICAgICAgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7CiAgICAgIHRvcDogMjBweCAhaW1wb3J0YW50OwogICAgICBsZWZ0OiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgIHJpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7CiAgICAgIGJvdHRvbTogYXV0byAhaW1wb3J0YW50OwogICAgCiAgCiAgICB9CiAgICAvKiA9PT09PSBQQVRDSCB2MzY6IHNpbmdsZSBjZW50ZXJlZCBwaG90bywgbWF4IGZpbGwgd2l0aCBmaXhlZCBpbnNldHMgPT09PT0gKi8KICAgIC8qIFJpZ2h0IHN0YWdlIHNob3VsZCBiZSBhIGNsZWFuIHZpZXdwb3J0ICovCiAgICAudmlld2VyLXN0YWdlewogICAgICBwb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgfQoKICAgIC8qIFN0YWdlIHN0YWNrIGp1c3QgZmlsbHMgc3RhZ2UgKi8KICAgICNzdGFnZVN0YWNrewogICAgICBwb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudDsKICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgIG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBNYWluIHBob3RvIGZyYW1lOiB0b3AvYm90dG9tIDRweCwgbGVmdC9yaWdodCAyMHB4ICovCiAgICAjc3RhZ2VNYWluewogICAgICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsKICAgICAgdG9wOiA0cHggIWltcG9ydGFudDsKICAgICAgYm90dG9tOiA0cHggIWltcG9ydGFudDsKICAgICAgbGVmdDogdmFyKC0tbWFpbi1sZWZ0LCAyMHB4KSAhaW1wb3J0YW50OwogICAgICByaWdodDogdmFyKC0tbWFpbi1yaWdodCwgMjBweCkgIWltcG9ydGFudDsKICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgIG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBQaG90bzogbWF4aW1pemUgYXJlYSB3aXRob3V0IGNyb3BwaW5nIChkZWNpc2lvbjogY29udGFpbikgKi8KICAgICN2aWV3ZXJJbWd7CiAgICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50OwogICAgICBtYXgtd2lkdGg6IG5vbmUgIWltcG9ydGFudDsKICAgICAgbWF4LWhlaWdodDogbm9uZSAhaW1wb3J0YW50OwogICAgICBvYmplY3QtZml0OiBjb250YWluICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLyogRGVsZXRlIGJ1dHRvbiBzdGF5cyBpbnNpZGUgcGhvdG8sIDIwcHggaW5zZXQgKi8KICAgICN2aWV3ZXJEZWxldGVCdG57CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZSAhaW1wb3J0YW50OwogICAgICB0b3A6IDIwcHggIWltcG9ydGFudDsKICAgICAgcmlnaHQ6IDIwcHggIWltcG9ydGFudDsKICAgICAgei1pbmRleDogMTAgIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBDb3VudGVyOiB0b3AtbGVmdCAyMHB4IChhbHJlYWR5KSwga2VlcCBibGFjayAqLwogICAgLnZpZXdlci1jb3VudGVyewogICAgICB0b3A6IDIwcHggIWltcG9ydGFudDsKICAgICAgbGVmdDogMjBweCAhaW1wb3J0YW50OwogICAgICBjb2xvcjogIzAwMDAwMCAhaW1wb3J0YW50OwogICAgICB6LWluZGV4OiAyNSAhaW1wb3J0YW50OwogICAgfQoKICAgIC8qIENsb3NlIGJ1dHRvbjogdG9wLXJpZ2h0IDIwcHggKi8KICAgICN2aWV3ZXJDbG9zZXsKICAgICAgdG9wOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgIHJpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgIHotaW5kZXg6IDMwICFpbXBvcnRhbnQ7CiAgICB9CgogIAogICAgLyogPT09PT0gVmlld2VyIGFjdGlvbnMgc3RhY2sgKGNsb3NlICsgZGVsZXRlKSA9PT09PSAqLwogICAgLnZpZXdlci1hY3Rpb25zewogICAgICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsKICAgICAgdG9wOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgIHJpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgIHotaW5kZXg6IDUwICFpbXBvcnRhbnQ7CiAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbiAhaW1wb3J0YW50OwogICAgICBnYXA6IDhweCAhaW1wb3J0YW50OwogICAgICBhbGlnbi1pdGVtczogZmxleC1lbmQgIWltcG9ydGFudDsKICAgIH0KICAgICN2aWV3ZXJDbG9zZSwKICAgICN2aWV3ZXJEZWxldGVCdG57CiAgICAgIHBvc2l0aW9uOiBzdGF0aWMgIWltcG9ydGFudDsKICAgICAgdG9wOiBhdXRvICFpbXBvcnRhbnQ7CiAgICAgIHJpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7CiAgICAgIGxlZnQ6IGF1dG8gIWltcG9ydGFudDsKICAgICAgYm90dG9tOiBhdXRvICFpbXBvcnRhbnQ7CiAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgfQoKICAKCi8qINCU0L7Qv9C+0LvQvdC40YLQtdC70YzQvdCw0Y8g0LjQvdGE0L7RgNC80LDRhtC40Y8gKi8KICAgICAgICAuYWRkaXRpb25hbC1ibG9jayB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGdhcDogMjBweDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICB9CgogICAgICAgIC5hZGRpdGlvbmFsLWl0ZW0gewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICBnYXA6IDIwcHg7CiAgICAgICAgfQoKICAgICAgICAvKiAtLS0gc3BhY2luZyB3aGVuIGNvbW1lbnRzL2xpbmtzIGxpc3RzIGFyZSBlbXB0eSAtLS0KICAgICAgICAgICDQotGA0LXQsdC+0LLQsNC90LjQtTog0LzQtdC20LTRgyDQutC90L7Qv9C60LDQvNC4ICgrKSAi0JrQvtC80LzQtdC90YLQsNGA0LjQuSIg0LggItCf0YDQuNC60YDQtdC/0LvRkdC90L3Ri9C1INGB0YHRi9C70LrQuCIg0LTQvtC70LbQvdC+INCx0YvRgtGMIDIwcHgsCiAgICAgICAgICAg0LHQtdC3INGD0LTQstC+0LXQvdC40Y8gMjArMjAuINCf0L7RjdGC0L7QvNGDINGD0LHQuNGA0LDQtdC8INCy0L3Rg9GC0YDQtdC90L3QuNC5IGdhcCDRgyDRgdC10LrRhtC40LgsINC60L7Qs9C00LAg0YHQv9C40YHQvtC6INC/0YPRgdGC0L7QuS4gKi8KICAgICAgICAuYWRkaXRpb25hbC1pdGVtLmlzLWVtcHR5IHsgZ2FwOiAwOyB9CiAgICAgICAgLmFkZGl0aW9uYWwtaXRlbS5pcy1lbXB0eSAuY29tbWVudHMtbGlzdCwKICAgICAgICAuYWRkaXRpb25hbC1pdGVtLmlzLWVtcHR5IC5saW5rcy1saXN0IHsgZGlzcGxheTogbm9uZTsgfQoKCiAgICAgICAgLmFkZGl0aW9uYWwtaGVhZGVyIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZ2FwOiA4cHg7CiAgICAgICAgfQoKICAgICAgICAuYWRkaXRpb25hbC10aXRsZSB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICAgICAgY29sb3I6ICMxQTFBMUE7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAiSW50ZXIiLCBzYW5zLXNlcmlmOwogICAgICAgICAgICB0ZXh0LXRyYW5zZm9ybTogbm9uZTsKICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDA7CiAgICAgICAgfQoKICAgICAgICAvKiDQldC00LjQvdGL0Lkg0YHRgtC40LvRjCDQtNC70Y8g0LLRgdC10YUg0LrQvdC+0L/QvtC6ICovCiAgICAgICAgLmFjdGlvbi1idXR0b24gewogICAgICAgICAgICB3aWR0aDogdmFyKC0tYnV0dG9uLXNpemUpOwogICAgICAgICAgICBoZWlnaHQ6IHZhcigtLWJ1dHRvbi1zaXplKTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLXJlZ3VsYXIpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtc20pOwogICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC10ZXJ0aWFyeSk7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2U7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDE7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgICAgIH0KCiAgICAgICAgLmFjdGlvbi1idXR0b246aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmF5LTEwMCk7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZ3JheS00MDApOwogICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsKICAgICAgICB9CgogICAgICAgIC8qIEljb24gYnV0dG9ucyAobmV3IHNwZWMpICovCiAgICAgICAgLmljb24tYnRuewogICAgICAgICAgICB3aWR0aDogdmFyKC0tYnRuLXNpemUpOwogICAgICAgICAgICBoZWlnaHQ6IHZhcigtLWJ0bi1zaXplKTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zbSk7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLXJlZ3VsYXIpOwogICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC10ZXJ0aWFyeSk7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2U7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgICAgIH0KCiAgICAgICAgLmljb24tYnRuOmhvdmVyewogICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmF5LTEwMCk7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZ3JheS00MDApOwogICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsKICAgICAgICB9CgogICAgICAgIC5pY29uLWJ0biAuaWNvbnsKICAgICAgICAgICAgd2lkdGg6IDI0cHg7CiAgICAgICAgICAgIGhlaWdodDogMjRweDsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgICAgIH0KCiAgICAgICAgLyogRGVmYXVsdCBTVkcgc2l6ZSBmb3IgZWRpdCBpY29uICovCiAgICAgICAgLmljb24tYnRuIC5pY29uIHN2Z3sKICAgICAgICAgICAgd2lkdGg6IDE4cHg7CiAgICAgICAgICAgIGhlaWdodDogMThweDsKICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7CiAgICAgICAgfQoKICAgICAgICAvKiBFZGl0IChwZW5jaWwpIGJ1dHRvbiAqLwogICAgICAgIC5pY29uLWJ0bi5lZGl0LWJ1dHRvbnsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzFBMUExQTsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBjb2xvcjogI0ZGRkZGRjsKICAgICAgICB9CgogICAgICAgIC5pY29uLWJ0bi5lZGl0LWJ1dHRvbjpob3ZlcnsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzJBMkEyQTsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBjb2xvcjogI0ZGRkZGRjsKICAgICAgICB9CgogICAgICAgIC8qIFVwbG9hZCAoKykgYnV0dG9uICovCiAgICAgICAgLmljb24tYnRuLmljb24tYnRuLS11cGxvYWR7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNEQURBREE7CiAgICAgICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICAgICAgY29sb3I6ICMxQTFBMUE7CiAgICAgICAgfQoKICAgICAgICAuaWNvbi1idG4uaWNvbi1idG4tLXVwbG9hZDpob3ZlcnsKICAgICAgICAgICAgYmFja2dyb3VuZDogI0QyRDJEMjsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgICB9CgogICAgICAgIC8qIFBsdXMgU1ZHIHNpemUgKHNhbWUgYXMgZWRpdCkgKi8KICAgICAgICAuaWNvbi1idG4uaWNvbi1idG4tLXVwbG9hZCAuaWNvbiBzdmd7CiAgICAgICAgICAgIHdpZHRoOiAxOHB4OwogICAgICAgICAgICBoZWlnaHQ6IDE4cHg7CiAgICAgICAgfQoKCiAgICAgICAgLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ0biB7CiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1yZWQtZXJyb3IpOwogICAgICAgIH0KCiAgICAgICAgLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ0bjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXJlZC1lcnJvcik7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcmVkLWVycm9yKTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KCiAgICAgICAgLmRlbGV0ZS1idXR0b246OmJlZm9yZSB7IGNvbnRlbnQ6IG5vbmU7IH0KICAgICAgICAuZGVsZXRlLWJ1dHRvbiBzdmd7d2lkdGg6MThweDtoZWlnaHQ6MThweDtkaXNwbGF5OmJsb2NrO30KCiAgICAgICAgLmRvd25sb2FkLWJ1dHRvbiBzdmcgewogICAgICAgICAgICB3aWR0aDogMjBweDsKICAgICAgICAgICAgaGVpZ2h0OiAyMHB4OwogICAgICAgIH0KCiAgICAgICAgLyog0JrQvtC80LzQtdC90YLQsNGA0LjQuSAqLwogICAgICAgIC5jb21tZW50cy1saXN0IHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICAgICAgZ2FwOiA0cHg7IC8qINCe0YLRgdGC0YPQvyDQvNC10LbQtNGDINCx0LvQvtC60LDQvNC4ICovCiAgICAgICAgfQoKICAgICAgICAuY29tbWVudC1ibG9jayB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNGMUYxRjE7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1tZCk7CiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7CiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7CiAgICAgICAgICAgIGdhcDogMTJweDsKICAgICAgICAgICAgbWluLWhlaWdodDogY2FsYyh2YXIoLS1idG4tc2l6ZSkgKyA0MHB4KTsgLyog0JzQuNC90LjQvNCw0LvRjNC90LDRjyDQstGL0YHQvtGC0LAg0LrQsNC6INGDINGB0YHRi9C70L7QuiAqLwogICAgICAgIAogICAgICAgICAgICBmb250LWZhbWlseTogSW50ZXIsIHN5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgU2Vnb2UgVUksIFJvYm90bywgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgICAgICB9CgogICAgICAgIC5jb21tZW50LXRleHQgewogICAgICAgICAgICBmb250OiBpbmhlcml0OwogICAgICAgICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgICAgICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOwogICAgICAgICAgICBmbGV4OiAxOwogICAgICAgICAgICB3b3JkLWJyZWFrOiBicmVhay13b3JkOwoKICAgICAgICAgICAgLyog0L7RgdGC0LDQstC70Y/QtdC8IOKAnNCy0L7Qt9C00YPRheKAnSDQtNC+INC60L3QvtC/0LrQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPICovCiAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDIwcHg7CiAgICAgICAgfQoKICAgICAgICAuY29tbWVudC1pbnB1dCB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBmb250OiBpbmhlcml0OwogICAgICAgICAgICBsaW5lLWhlaWdodDogaW5oZXJpdDsKICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CgogICAgICAgICAgICAvKiDQstCy0L7QtCDQv9GA0Y/QvNC+IOKAnNCyINGB0LXRgNC+0Lwg0LrRg9Cx0LjQutC14oCdICovCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50OwogICAgICAgICAgICBvdXRsaW5lOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOwogICAgICAgICAgICBhcHBlYXJhbmNlOiBub25lOwogICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgIHJlc2l6ZTogbm9uZTsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsgLyog0YPQsdC40YDQsNC10Lwg0YHQutGA0L7Qu9C7ICovCiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDEuNmVtOwogICAgICAgICAgICBoZWlnaHQ6IGF1dG87CiAgICAgICAgICAgIGZsZXg6IDE7CiAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDIwcHg7CgogICAgICAgICAgICAvKiDQp9GC0L7QsdGLINCv0L3QtNC10LrRgS9DaHJvbWUg0L3QtSDigJzQv9C+0LTRgtCw0YHQutC40LLQsNC74oCdINGA0LDQt9C80LXRgNGLINGC0LXQutGB0YLQsCAqLwogICAgICAgICAgICAtd2Via2l0LXRleHQtc2l6ZS1hZGp1c3Q6IDEwMCU7CiAgICAgICAgICAgIHRleHQtc2l6ZS1hZGp1c3Q6IDEwMCU7CiAgICAgICAgfQoKICAgICAgICAuY29tbWVudC1pbnB1dDpmb2N1cyB7CiAgICAgICAgICAgIG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgYm94LXNoYWRvdzogbm9uZSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmNvbW1lbnQtaW5wdXQ6Zm9jdXMgewogICAgICAgICAgICBvdXRsaW5lOiBub25lOwogICAgICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLWdyYXktNTAwKTsKICAgICAgICB9CgogICAgICAgIC8qINCh0YHRi9C70LrQuCAqLwogICAgICAgIC5saW5rcy1saXN0IHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICAgICAgZ2FwOiA0cHg7IC8qINCe0YLRgdGC0YPQvyDQvNC10LbQtNGDINCx0LvQvtC60LDQvNC4ICovCiAgICAgICAgfQoKICAgICAgICAubGluay1pdGVtIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjRjFGMUYxOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbWQpOwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgICAgICAgICBnYXA6IDEycHg7CiAgICAgICAgICAgIGhlaWdodDogY2FsYyh2YXIoLS1idG4tc2l6ZSkgKyA0MHB4KTsKICAgICAgICB9CgogICAgICAgIC5saW5rLWl0ZW0uZWRpdGluZ3sKICAgICAgICAgICAgLyog0YTQuNC60YHQuNGA0YPQtdC8INCy0YvRgdC+0YLRgyDQuCDQstGL0YDQsNCy0L3QuNCy0LDQvdC40LUg0LjQvdC/0YPRgtC+0LIg0L/QviDRhtC10L3RgtGA0YMgKi8KICAgICAgICB9CgogICAgICAgIAogICAgICAgIC5saW5rLWluZm8gewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBnYXA6IDhweDsKICAgICAgICAgICAgZmxleDogMTsKICAgICAgICAgICAgbWluLXdpZHRoOiAwOyAvKiDQktCw0LbQvdC+INC00LvRjyDQvtCx0YDQtdC30LrQuCDRgtC10LrRgdGC0LAgKi8KICAgICAgICB9CgogICAgICAgIC5saW5rLXR5cGUgewogICAgICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiB2YXIoLS1pbnRlci1tZWRpdW0pOwogICAgICAgICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgICAgICAgZmxleDogMCAwIGF1dG87IC8qINC/0L7QutCw0LfRi9Cy0LDQtdC8INGC0LXQutGB0YIg0YLQuNC/0LAg0L/QvtC70L3QvtGB0YLRjNGOICovCiAgICAgICAgfQoKLyog0JTQstC+0LXRgtC+0YfQuNC1INC/0L7RgdC70LUg0L3QsNC30LLQsNC90LjRjyAo0YLQvtC70YzQutC+INCyICLRgdC/0L7QutC+0LnQvdC+0LwiINGA0LXQttC40LzQtSkgKi8KLmxpbmstaXRlbTpub3QoLmVkaXRpbmcpIC5saW5rLXR5cGU6OmFmdGVyewogICAgICAgICAgICBjb250ZW50OiAiOiI7CiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogNnB4OwogICAgICAgICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgICB9CgogICAgICAgIC5saW5rLXVybCB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IGRhc2hlZCB2YXIoLS1ncmF5LTQwMCk7CiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogICAgICAgICAgICBmbGV4OiAxIDEgYXV0bzsgICAvKiDRgdGB0YvQu9C60LAg0LfQsNC90LjQvNCw0LXRgiDQvtGB0YLQsNGC0L7QuiAqLwogICAgICAgICAgICBtaW4td2lkdGg6IDA7ICAgICAgLyog0L/QvtC30LLQvtC70Y/QtdGCINGA0LXQsNC70YzQvdC+INGB0LbQuNC80LDRgtGM0YHRjyAqLwogICAgICAgICAgICBtYXgtd2lkdGg6IG5vbmU7ICAgLyog0L3QtSDQvtCz0YDQsNC90LjRh9C40LLQsNC10LwgMzAwcHggKi8KICAgICAgICB9CgogICAgICAgIC5saW5rLXVybDpob3ZlciB7CiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ncmF5LTYwMCk7CiAgICAgICAgfQoKICAgICAgICAubGluay1lZGl0IHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZ2FwOiA4cHg7CiAgICAgICAgICAgIGZsZXg6IDE7CiAgICAgICAgICAgIG1pbi13aWR0aDogMDsKICAgICAgICAKICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdJbnRlcicsIHNhbnMtc2VyaWY7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDsKICAgICAgICB9CgogICAgICAgIC5saW5rLXR5cGUtaW5wdXQgewogICAgICAgICAgICB3aWR0aDogMTIwcHg7IC8qINC40YHRhdC+0LTQvdC+0LUg0L/Rg9GB0YLQvtC1INGB0L7RgdGC0L7Rj9C90LjQtSAqLwogICAgICAgICAgICBtaW4td2lkdGg6IDEyMHB4OwogICAgICAgICAgICBwYWRkaW5nOiA2cHggMTBweDsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IGluaGVyaXQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IHZhcigtLWludGVyLW1lZGl1bSk7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zbSk7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsKICAgICAgICAgICAgY29sb3I6ICMxQTFBMUE7CiAgICAgICAgICAgIGhlaWdodDogdmFyKC0tYnRuLXNpemUpOwoKICAgICAgICAgICAgLyog0YfRgtC+0LHRiyDQvdC1INGA0LDRgdGC0Y/Qs9C40LLQsNC70L4g0LrQsNGA0YLQvtGH0LrRgyDQsdC10YHQutC+0L3QtdGH0L3QviAqLwogICAgICAgIAogICAgICAgICAgICBmbGV4OiAwIDAgYXV0bzsKICAgICAgICAgICAgb3ZlcmZsb3c6IHZpc2libGU7CiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7fQoKICAgICAgICAubGluay11cmwtaW5wdXQgewogICAgICAgICAgICBmbGV4OiAxOwogICAgICAgICAgICBtaW4td2lkdGg6IDE0MHB4OwogICAgICAgICAgICBwYWRkaW5nOiA2cHggMTBweDsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IGluaGVyaXQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXNtKTsKICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0td2hpdGUpOwogICAgICAgICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgICAgICAgaGVpZ2h0OiB2YXIoLS1idG4tc2l6ZSk7CgogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKICAgICAgICAgICAgLXdlYmtpdC10ZXh0LXNpemUtYWRqdXN0OiAxMDAlOwogICAgICAgIH0KCiAgICAgICAgLmxpbmstdHlwZS1pbnB1dDpmb2N1cywgLmxpbmstdXJsLWlucHV0OmZvY3VzIHsKICAgICAgICAgICAgb3V0bGluZTogbm9uZTsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1ncmF5LTUwMCk7CiAgICAgICAgfQoKICAgICAgICAubGluay1hY3Rpb25zIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZ2FwOiA4cHg7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgICAgIH0KCiAgICAgICAgLyog0JDQtNCw0L/RgtC40LLQvdC+0YHRgtGMICovCiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDkwMHB4KSB7CiAgICAgICAgICAgIC5zcGVjcy1ncmlkIHsKICAgICAgICAgICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDMsIDFmcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3MDBweCkgewogICAgICAgICAgICAuc3BlY3MtZ3JpZCB7CiAgICAgICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgyLCAxZnIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAubGluay11cmwgewogICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAyMDBweDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDYwMHB4KSB7CiAgICAgICAgICAgIC5saW5rLWl0ZW0gewogICAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAubGluay1pbmZvIHsKICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAubGluay11cmwgewogICAgICAgICAgICAgICAgbWF4LXdpZHRoOiBub25lOwogICAgICAgICAgICAgICAgZmxleDogMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmxpbmstZWRpdCB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmxpbmstdHlwZS1pbnB1dCB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmxpbmstdXJsLWlucHV0IHsKICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAubGluay1hY3Rpb25zIHsKICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDQ4MHB4KSB7CiAgICAgICAgICAgIC5zcGVjcy1ncmlkIHsKICAgICAgICAgICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAuc2VjdGlvbi1jb250ZW50IHsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDE2cHg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC5saW5rLXVybCB7CiAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDE1MHB4OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgCi8qID09PT09IEFVVE9DT05URU5UOiBhcHBsaWVkIHN0eWxlcyBmcm9tICLQmtCw0YDRgtC+0YfQutC4INC60L7QvdGC0LXQvdGCIiA9PT09PSAqLwo6cm9vdHsKICAtLWludGVyLXJlZ3VsYXI6IDQwMDsKICAtLWludGVyLW1lZGl1bTogNTAwOwogIC0taW50ZXItc2VtaWJvbGQ6IDYwMDsKICAtLWludGVyLWJvbGQ6IDcwMDsKCiAgLS1wYWdlLWJnOiAjRjFGMUYxOwoKICAtLXdoaXRlOiAjRkZGRkZGOwogIC0tdGV4dC1wcmltYXJ5OiAjMUExQTFBOwogIC0tdGV4dC1zZWNvbmRhcnk6ICM0QjU1NjM7CiAgLS10ZXh0LXRlcnRpYXJ5OiAjODA4MDgwOwoKICAtLWJvcmRlcjogI0U4RThFODsKICAtLWRpdmlkZXI6ICNFOEU4RTg7CgogIC0tYnRuLWRhcms6ICMxQTFBMUE7CiAgLS1idG4tZGFyay1ob3ZlcjogIzJBMkIyRTsKCiAgLS1idG4tZGFuZ2VyOiAjRkY0RDU3OwogIC0tYnRuLWRhbmdlci1ob3ZlcjogI0U2M0I0NTsKCiAgLS1zaGFkb3ctY2FyZDogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4wNCksIDAgMXB4IDJweCByZ2JhKDAsMCwwLDAuMDIpOwogIC0tc2hhZG93LWZsb2F0OiAwIDRweCAxMnB4IHJnYmEoMCwwLDAsMC4xMik7CgogIC0tcmFkaXVzLWNhcmQ6IDIwcHg7CiAgLS1yYWRpdXMtYnRuOiAxMHB4OwogIC0tcmFkaXVzLW1kOiAxMnB4OwoKICAtLWJ0bi1zaXplOiBjbGFtcCgzNnB4LCA0dncsIDQycHgpOwogIC0tY2FyZC1wYWQ6IDIwcHg7CgogIC8qIGFsaWFzZXMgdG8ga2VlcCBleGlzdGluZyBydWxlcyB3b3JraW5nICovCiAgLS1ncmF5LTEwMDogdmFyKC0tcGFnZS1iZyk7CiAgLS1ncmF5LTIwMDogdmFyKC0tYm9yZGVyKTsKICAtLWdyYXktMzAwOiB2YXIoLS1ib3JkZXIpOwogIC0tZ3JheS00MDA6ICNEMUQ1REI7CiAgLS1ncmF5LTUwMDogdmFyKC0tdGV4dC10ZXJ0aWFyeSk7CiAgLS1ncmF5LTYwMDogIzRCNTU2MzsKCiAgLS1ib3JkZXItbGlnaHQ6IHZhcigtLWJvcmRlcik7CiAgLS1ib3JkZXItcmVndWxhcjogdmFyKC0tYm9yZGVyKTsKCiAgLS1yYWRpdXMtc206IHZhcigtLXJhZGl1cy1idG4pOwogIC0tcmFkaXVzLWxnOiB2YXIoLS1yYWRpdXMtY2FyZCk7CiAgLS1zcGFjZS11bml0OiAyMHB4OwogIC0tYnV0dG9uLXNpemU6IHZhcigtLWJ0bi1zaXplKTsKICAtLXJlZC1lcnJvcjogdmFyKC0tYnRuLWRhbmdlcik7Cn0KCmJvZHl7CiAgYmFja2dyb3VuZDogdmFyKC0tcGFnZS1iZyk7CiAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7CiAgcGFkZGluZzogMjBweDsKfQoKLmNvbGxhcHNlLXNlY3Rpb257CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtY2FyZCk7CiAgYm94LXNoYWRvdzogbm9uZTsKfQoKLnNlY3Rpb24taGVhZGVyOmhvdmVyeyBiYWNrZ3JvdW5kOiAjRURFREVEOyB9Cgouc2VjdGlvbi1oZWFkZXItdGl0bGV7CiAgZm9udC13ZWlnaHQ6IHZhcigtLWludGVyLXNlbWlib2xkKTsKICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsKfQoKLnNlY3Rpb24tY29udGVudHsKICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tZGl2aWRlcik7CiAgcGFkZGluZzogdmFyKC0tY2FyZC1wYWQpOwogIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsKfQoKLyogQnV0dG9ucyAodW5pZnkgd2l0aCBpY29uLWJ0biBsb29rKSAqLwouYWN0aW9uLWJ1dHRvbnsKICB3aWR0aDogdmFyKC0tYnRuLXNpemUpOwogIGhlaWdodDogdmFyKC0tYnRuLXNpemUpOwogIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1idG4pOwogIGJvcmRlcjogbm9uZTsKICBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFyayk7CiAgY29sb3I6ICNmZmY7CiAgY3Vyc29yOiBwb2ludGVyOwogIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4xNXMgZWFzZSwgdHJhbnNmb3JtIDAuMXMgZWFzZTsKICBwYWRkaW5nOiAwOwogIGxpbmUtaGVpZ2h0OiAwOwp9Ci5hY3Rpb24tYnV0dG9uOmhvdmVyeyBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFyay1ob3Zlcik7IGNvbG9yOiNmZmY7IH0KLmFjdGlvbi1idXR0b246YWN0aXZleyB0cmFuc2Zvcm06IHNjYWxlKDAuOTgpOyB9CgovKiBJY29ucyBpbnNpZGUgYWN0aW9uIGJ1dHRvbnMgKi8KLmFjdGlvbi1idXR0b24gc3ZnewogIHdpZHRoOiAyMHB4OwogIGhlaWdodDogMjBweDsKICBkaXNwbGF5OiBibG9jazsKfQoKLyogUGx1cyBidXR0b25zIGluICLQlNC+0L/QvtC70L3QuNGC0LXQu9GM0L3QsNGPINC40L3RhNC+0YDQvNCw0YbQuNGPIiAqLwouYWRkaXRpb25hbC1oZWFkZXIgLmljb24tYnRuLmljb24tYnRuLS11cGxvYWR7CiAgYmFja2dyb3VuZDogI0RBREFEQTsKICBjb2xvcjogIzFBMUExQTsKfQouYWRkaXRpb25hbC1oZWFkZXIgLmljb24tYnRuLmljb24tYnRuLS11cGxvYWQ6aG92ZXJ7CiAgYmFja2dyb3VuZDogI0QyRDJEMjsKICBjb2xvcjogIzFBMUExQTsKfQoKCi5hY3Rpb24tYnV0dG9uLmRlbGV0ZS1idG4sCi5hY3Rpb24tYnV0dG9uLmRlbGV0ZS1idXR0b257CiAgYmFja2dyb3VuZDogdmFyKC0tYnRuLWRhbmdlcik7CiAgY29sb3I6ICNmZmY7Cn0KLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ0bjpob3ZlciwKLmFjdGlvbi1idXR0b24uZGVsZXRlLWJ1dHRvbjpob3ZlcnsKICBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFuZ2VyLWhvdmVyKTsKICBjb2xvcjogI2ZmZjsKfQoKLyogSW5uZXIgYmxvY2tzICovCi5jb21tZW50LWJsb2NrLAoubGluay1pdGVtewogIGJhY2tncm91bmQ6ICNGMUYxRjE7CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbWQpOwp9CgovKiBJbnB1dHMgaW4gZWRpdCBtb2RlICovCi5jb21tZW50LWlucHV0LAoubGluay10eXBlLWlucHV0LAoubGluay11cmwtaW5wdXR7CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtYnRuKTsKfQouY29tbWVudC1pbnB1dDpmb2N1cywKLmxpbmstdHlwZS1pbnB1dDpmb2N1cywKLmxpbmstdXJsLWlucHV0OmZvY3VzewogIG91dGxpbmU6IG5vbmU7CiAgYm9yZGVyLWNvbG9yOiB2YXIoLS10ZXh0LXRlcnRpYXJ5KTsKfQoKLyogTGluayB1bmRlcmxpbmUgc3R5bGUgY2xvc2VyIHRvIHJlZiAqLwoubGluay11cmx7CiAgYm9yZGVyLWJvdHRvbTogMXB4IGRhc2hlZCB2YXIoLS10ZXh0LXRlcnRpYXJ5KTsKfQoubGluay11cmw6aG92ZXJ7CiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXRleHQtc2Vjb25kYXJ5KTsKfQoKLmtpdC1jYXJkewogIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgYm9yZGVyLXJhZGl1czogMjBweDsKfQoKCi5raXQtZGl2aWRlcnsKICBoZWlnaHQ6IDFweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1kaXZpZGVyKTsKfQoKCiAgICAgICAgLyog0YPQvdC40YTQuNC60LDRhtC40Y8g0YLQtdC60YHRgtCwINC60L7QvNC80LXQvdGC0LDRgNC40LXQsiDQuCDRgdGB0YvQu9C+0Log0L/QvtC0INGB0YLQuNC70Ywg0LvQtdC50LHQu9C+0LIgKEludGVyIDE0LzQwMCkgKi8KICAgICAgICAuY29tbWVudC10ZXh0LAogICAgICAgIC5saW5rLXR5cGUgewogICAgICAgICAgICBmb250LWZhbWlseTogSW50ZXIsIHN5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgU2Vnb2UgVUksIFJvYm90bywgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgICAgICAgY29sb3I6ICMxQTFBMUE7CiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiBub25lOwogICAgICAgIH0KCiAgICAgICAgLmxpbmstdXJsLAogICAgICAgIC5saW5rLXVybDp2aXNpdGVkLAogICAgICAgIC5saW5rLXVybDpob3ZlciwKICAgICAgICAubGluay11cmw6YWN0aXZlLAogICAgICAgIC5saW5rLXVybDpmb2N1cyB7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiBJbnRlciwgc3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBTZWdvZSBVSSwgUm9ib3RvLCBBcmlhbCwgc2Fucy1zZXJpZjsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgICAgICBmb250LXdlaWdodDogNDAwOwogICAgICAgICAgICBjb2xvcjogIzFBMUExQTsKICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7CiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IG5vbmU7CiAgICAgICAgfQoKCi8qID09PSBMaW5rIGVkaXQgbW9kZTogc2FtZSB0eXBvZ3JhcGh5L2NvbG9ycyBhcyB2aWV3IG1vZGUsIG5vIHVuZGVybGluZSA9PT0gKi8KLmxpbmstaW5mb3ttaW4td2lkdGg6MDt9Ci5saW5rLXR5cGV7CiAgZm9udC1mYW1pbHk6IEludGVyLCBzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIFNlZ29lIFVJLCBSb2JvdG8sIEFyaWFsLCBzYW5zLXNlcmlmOwogIGZvbnQtc2l6ZTogMTRweDsKICBmb250LXdlaWdodDogNDAwOwogIGNvbG9yOiAjMUExQTFBOwogIHdoaXRlLXNwYWNlOiBub3dyYXA7ICAgICAvKiDQv9C+0LrQsNC30YvQstCw0LXQvCDQsiDQvtC00L3RgyDRgdGC0YDQvtC60YMgKi8KICBvdmVyZmxvdzogdmlzaWJsZTsgICAgICAgLyog0J3QlSDQvtCx0YDQtdC30LDQtdC8ICovCiAgdGV4dC1vdmVyZmxvdzogY2xpcDsgICAgIC8qINCx0LXQtyDRgtGA0L7QtdGC0L7Rh9C40Y8gKi8KICBtYXgtd2lkdGg6IG5vbmU7ICAgICAgICAgLyog0LHQtdC3INC70LjQvNC40YLQsCDRiNC40YDQuNC90YsgKi8KICBtaW4td2lkdGg6IDA7CiAgZmxleDogMCAwIGF1dG87ICAgICAgICAgIC8qINGI0LjRgNC40L3QsCA9INGB0L7QtNC10YDQttC40LzQvtC1ICovCn0KCi5saW5rLXVybHsKICBmbGV4OiAxIDEgYXV0bzsKICBtaW4td2lkdGg6IDA7CiAgbWF4LXdpZHRoOiBub25lOwogIG92ZXJmbG93OiBoaWRkZW47CiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKfQoKLyogRWRpdGluZyBsYXlvdXQgc3RheXMgYWxpZ25lZCB3aXRoIGJ1dHRvbnMgKi8KLmxpbmstaXRlbS5lZGl0aW5nIC5saW5rLWVkaXR7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGdhcDogOHB4OwogIGZsZXg6IDE7CiAgbWluLXdpZHRoOiAwOwp9CgovKiBJbnB1dHMgaW4gZWRpdCBtb2RlOiB3aGl0ZSBibG9ja3MgbGlrZSBpbiBpbmFjdGl2ZSBtb2RlLCBrZWVwIGJ1dHRvbi1oZWlnaHQgKi8KLmxpbmstaXRlbS5lZGl0aW5nIC5saW5rLXR5cGUtaW5wdXQsCi5saW5rLWl0ZW0uZWRpdGluZyAubGluay11cmwtaW5wdXR7CiAgZm9udC1mYW1pbHk6IEludGVyLCBzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIFNlZ29lIFVJLCBSb2JvdG8sIEFyaWFsLCBzYW5zLXNlcmlmOwogIGZvbnQtc2l6ZTogMTRweDsKICBmb250LXdlaWdodDogNDAwOwogIGNvbG9yOiAjMUExQTFBOwoKICBiYWNrZ3JvdW5kOiAjRkZGRkZGOwogIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLWJ0bik7CiAgcGFkZGluZzogMCAxMnB4OwoKICBoZWlnaHQ6IHZhcigtLWJ0bi1zaXplKTsKICBsaW5lLWhlaWdodDogY2FsYyh2YXIoLS1idG4tc2l6ZSkgLSAycHgpOyAvKiBjb21wZW5zYXRlIGJvcmRlciAqLwoKICBvdmVyZmxvdzogaGlkZGVuOwogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogIHdoaXRlLXNwYWNlOiBub3dyYXA7Cn0KCi5saW5rLWl0ZW0uZWRpdGluZyAubGluay10eXBlLWlucHV0ewogIC8qINGI0LjRgNC40L3RgyDQt9Cw0LTQsNGR0YIgSlMsINC/0L7Qu9C1INGA0LDRgdGC0ZHRgiDQv9C+INC80LXRgNC1INCy0LLQvtC00LAgKi8KICBmbGV4OiAwIDAgYXV0bzsKICB3aWR0aDogMTIwcHg7CiAgbWF4LXdpZHRoOiA2MCU7Cn0KCi5saW5rLWl0ZW0uZWRpdGluZyAubGluay11cmwtaW5wdXR7CiAgZmxleDogMSAxIGF1dG87CiAgbWluLXdpZHRoOiAwOwp9CgoubGluay1pdGVtLmVkaXRpbmcgLmxpbmstdHlwZS1pbnB1dDpmb2N1cywKLmxpbmstaXRlbS5lZGl0aW5nIC5saW5rLXVybC1pbnB1dDpmb2N1c3sKICBvdXRsaW5lOiBub25lOwogIGJveC1zaGFkb3c6IG5vbmU7CiAgYm9yZGVyLWNvbG9yOiB2YXIoLS10ZXh0LXRlcnRpYXJ5KTsKfQoKCi8qIC0tLSBGSVg6IHJlbW92ZSByb3VuZGVkICJjYXBzdWxlIiBhcm91bmQgY29tbWVudCB0ZXh0YXJlYSBPTkxZIGluIGVkaXQgbW9kZSAtLS0gKi8KLmNvbW1lbnQtYmxvY2suZWRpdGluZyAuY29tbWVudC1pbnB1dHsKICBib3JkZXItcmFkaXVzOiAwICFpbXBvcnRhbnQ7Cn0KCjwvc3R5bGU+CjxzdHlsZT4KLyogRm9yY2UgbGluayB1bmRlcmxpbmUgdG8gYmUgYmxhY2sgYW5kIG9ubHkgdW5kZXIgdGhlIHRleHQgKi8KI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rLXVybCwKI2FkZGl0aW9uYWxTZWN0aW9uIC5saW5rLXVybDp2aXNpdGVkLAojYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstdXJsOmhvdmVyLAojYWRkaXRpb25hbFNlY3Rpb24gLmxpbmstdXJsOmFjdGl2ZSB7CiAgY29sb3I6ICMwMDAgIWltcG9ydGFudDsKICB0ZXh0LWRlY29yYXRpb24tbGluZTogdW5kZXJsaW5lICFpbXBvcnRhbnQ7CiAgdGV4dC1kZWNvcmF0aW9uLWNvbG9yOiAjMDAwICFpbXBvcnRhbnQ7CiAgdGV4dC1kZWNvcmF0aW9uLXRoaWNrbmVzczogZnJvbS1mb250OwogIHRleHQtdW5kZXJsaW5lLW9mZnNldDogMnB4Owp9Cgo8L3N0eWxlPgo8c3R5bGU+Ci8qIFJlc3RvcmUgYnV0dG9uIGNvbG9ycyAob3ZlcnJpZGUgYW55IGdlbmVyaWMgbGluayBjb2xvciBydWxlcykgKi8KI2FkZGl0aW9uYWxTZWN0aW9uIC5pY29uLWJ0bi0tdXBsb2FkIHsgYmFja2dyb3VuZDogI0RBREFEQSAhaW1wb3J0YW50OyBjb2xvcjogIzFBMUExQSAhaW1wb3J0YW50OyBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgfQojYWRkaXRpb25hbFNlY3Rpb24gLmVkaXQtYnV0dG9uIHsgYmFja2dyb3VuZDogIzFBMUExQSAhaW1wb3J0YW50OyBjb2xvcjogI0ZGRkZGRiAhaW1wb3J0YW50OyBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgfQojYWRkaXRpb25hbFNlY3Rpb24gLmRlbGV0ZS1idXR0b24geyBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFuZ2VyKSAhaW1wb3J0YW50OyBjb2xvcjogI0ZGRkZGRiAhaW1wb3J0YW50OyBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgfQojYWRkaXRpb25hbFNlY3Rpb24gLmFjdGlvbi1idXR0b24geyBiYWNrZ3JvdW5kOiB2YXIoLS13aGl0ZSkgIWltcG9ydGFudDsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLXJlZ3VsYXIpICFpbXBvcnRhbnQ7IGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7IH0KI2FkZGl0aW9uYWxTZWN0aW9uIC5hY3Rpb24tYnV0dG9uOmhvdmVyIHsgYmFja2dyb3VuZDogdmFyKC0tYmctaG92ZXIpICFpbXBvcnRhbnQ7IH0KPC9zdHlsZT4KPHN0eWxlPgovKiA9PT0gQnV0dG9uIGNvbG9yIHN0YW5kYXJkaXphdGlvbiAobWF0Y2ggcGFnZTJfZml4ZWQuaHRtKSA9PT0gKi8KLmljb24tYnRuewogIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlLCAjZmZmKTsKICBib3JkZXI6IG5vbmU7CiAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSwgIzFBMUExQSk7Cn0KLmljb24tYnRuLS1kYXJrewogIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYXJrLCAjMUExQTFBKSAhaW1wb3J0YW50OwogIGNvbG9yOiAjZmZmICFpbXBvcnRhbnQ7Cn0KLmljb24tYnRuLS1kYXJrOmhvdmVyewogIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYXJrLWhvdmVyLCAjMkEyQjJFKSAhaW1wb3J0YW50Owp9Ci5pY29uLWJ0bi0tZGFuZ2VyewogIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXIsICNGRjRENTcpICFpbXBvcnRhbnQ7CiAgY29sb3I6ICNmZmYgIWltcG9ydGFudDsKfQouaWNvbi1idG4tLWRhbmdlcjpob3ZlcnsKICBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFuZ2VyLWhvdmVyLCAjRTYzQjQ1KSAhaW1wb3J0YW50Owp9CgovKiBBZGRpdGlvbmFsLWluZm8gaW50ZXJuYWwgYnV0dG9ucyAqLwouYWN0aW9uLWJ1dHRvbi5kZWxldGUtYnV0dG9uewogIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXIsICNGRjRENTcpICFpbXBvcnRhbnQ7CiAgY29sb3I6ICNmZmYgIWltcG9ydGFudDsKICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsKfQouYWN0aW9uLWJ1dHRvbi5kZWxldGUtYnV0dG9uOmhvdmVyewogIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXItaG92ZXIsICNFNjNCNDUpICFpbXBvcnRhbnQ7Cn0KCi8qICJBZGQiIGJ1dHRvbnMgKHBsdXMpIGluIHNlY3Rpb24gaGVhZGVycykgKi8KLmFkZC1idG4sIC5hZGQtY29tbWVudC1idG4sIC5hZGQtbGluay1idG4sICNhZGRDb21tZW50QnRuLCAjYWRkTGlua0J0bnsKICBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFyaywgIzFBMUExQSkgIWltcG9ydGFudDsKICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50OwogIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50Owp9Ci5hZGQtYnRuOmhvdmVyLCAuYWRkLWNvbW1lbnQtYnRuOmhvdmVyLCAuYWRkLWxpbmstYnRuOmhvdmVyLCAjYWRkQ29tbWVudEJ0bjpob3ZlciwgI2FkZExpbmtCdG46aG92ZXJ7CiAgYmFja2dyb3VuZDogdmFyKC0tYnRuLWRhcmstaG92ZXIsICMyQTJCMkUpICFpbXBvcnRhbnQ7Cn0KCi8qIEVkaXQgYnV0dG9ucyBpbnNpZGUgY29udGVudCAqLwouZWRpdC1idXR0b24uaWNvbi1idG4sIC5lZGl0LWJ1dHRvbnsKICAvKiBpZiBpdCdzIGEgcGxhaW4gYnV0dG9uIHdpdGhvdXQgbW9kaWZpZXIgY2xhc3MgKi8KICBiYWNrZ3JvdW5kOiB2YXIoLS1idG4tZGFyaywgIzFBMUExQSk7CiAgY29sb3I6ICNmZmY7Cn0KLmVkaXQtYnV0dG9uOmhvdmVyewogIGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYXJrLWhvdmVyLCAjMkEyQjJFKTsKfQo8L3N0eWxlPgo8c3R5bGU+Ci8qIEVuc3VyZSBhZGRpdGlvbmFsLXNlY3Rpb24gYnV0dG9ucyBmb2xsb3cgcGFnZTJfZml4ZWQuaHRtIHBhbGV0dGUgKi8KI2FkZGl0aW9uYWxTZWN0aW9uIC5pY29uLWJ0bi5pY29uLWJ0bi0tZGFyayB7IGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYXJrLCAjMUExQTFBKTsgY29sb3I6I2ZmZjsgfQojYWRkaXRpb25hbFNlY3Rpb24gLmljb24tYnRuLmljb24tYnRuLS1kYXJrOmhvdmVyIHsgYmFja2dyb3VuZDogdmFyKC0tYnRuLWRhcmstaG92ZXIsICMyQTJCMkUpOyB9CiNhZGRpdGlvbmFsU2VjdGlvbiAuaWNvbi1idG4uaWNvbi1idG4tLWRhbmdlciB7IGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXIsICNGRjRENTcpOyBjb2xvcjojZmZmOyB9CiNhZGRpdGlvbmFsU2VjdGlvbiAuaWNvbi1idG4uaWNvbi1idG4tLWRhbmdlcjpob3ZlciB7IGJhY2tncm91bmQ6IHZhcigtLWJ0bi1kYW5nZXItaG92ZXIsICNFNjNCNDUpOyB9CiNhZGRpdGlvbmFsU2VjdGlvbiAuaWNvbi1idG4uaWNvbi1idG4tLXVwbG9hZCB7IGJhY2tncm91bmQ6I0RBREFEQTsgY29sb3I6IzFBMUExQTsgfQojYWRkaXRpb25hbFNlY3Rpb24gLmljb24tYnRuLmljb24tYnRuLS11cGxvYWQ6aG92ZXIgeyBiYWNrZ3JvdW5kOiNEMkQyRDI7IH0KPC9zdHlsZT4KPHN0eWxlPgovKiBSZW1vdmUgImFjdGl2ZSIgLyB0YXAgaGlnaGxpZ2h0IGJhY2tncm91bmQgb24gY2FyZHMgKNCa0L7QvdGC0LXQvdGCICsg0JDRgNGF0LjQsikgKi8KLmtpdC1jYXJkLAoudGlsZSwKLmNvbGxhZ2UtY2VsbCwKLmtpdC1kcmFnLWhhbmRsZSwKLmtpdC1hY3Rpb25zIGJ1dHRvbnsKICAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50Owp9Cgoua2l0LWNhcmQ6Zm9jdXMsCi5raXQtY2FyZDpmb2N1cy13aXRoaW4sCi5raXQtY2FyZDphY3RpdmV7CiAgb3V0bGluZTogbm9uZSAhaW1wb3J0YW50OwogIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDsKfQoKLyogS2VlcCBjYXJkIGJhY2tncm91bmRzIHN0YWJsZSB3aGVuIGludGVyYWN0ZWQgd2l0aCAqLwoua2l0LWNhcmQ6YWN0aXZleyBiYWNrZ3JvdW5kOiB2YXIoLS13aGl0ZSwgI2ZmZikgIWltcG9ydGFudDsgfQoua2l0LWNhcmQuaXMtdXNlZDphY3RpdmV7IGJhY2tncm91bmQ6IHZhcigtLXVzZWQtYmcsICNEMUVEREQpICFpbXBvcnRhbnQ7IH0KCi8qIEFsc28ga2lsbCBhbnkgZm9jdXMgcmluZyBjYXVzZWQgYnkgY2xpY2thYmxlIGNoaWxkcmVuICovCi5raXQtY2FyZCAqOmZvY3VzeyBvdXRsaW5lOiBub25lICFpbXBvcnRhbnQ7IH0KPC9zdHlsZT4KPHN0eWxlPgovKiA9PT0gS2lsbCBtb2JpbGUgdGFwL2FjdGl2ZSBoaWdobGlnaHQgb24gQUxMIGNsaWNrYWJsZSBjZWxscyBpbnNpZGUg0JrQvtC90YLQtdC90YIv0JDRgNGF0LjQsiA9PT0gKi8KLmtpdHMsIC5raXRzICp7CiAgLXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Owp9CgoudGlsZSwgLmNvbGxhZ2UtY2VsbCwgLmtpdC10aXRsZSwgLmtpdC1jaGVjaywgLmtpdC1kcmFnLWhhbmRsZXsKICAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7CiAgb3V0bGluZTogbm9uZSAhaW1wb3J0YW50Owp9CgovKiBQcmV2ZW50IGFueSBVQSBhY3RpdmUgYmFja2dyb3VuZCBmbGFzaCAqLwoudGlsZTphY3RpdmUsCi5jb2xsYWdlLWNlbGw6YWN0aXZlLAoua2l0LXRpdGxlOmFjdGl2ZSwKLmtpdC1jaGVjazphY3RpdmV7CiAgYmFja2dyb3VuZDogaW5oZXJpdCAhaW1wb3J0YW50Owp9CgovKiBJZiBzb21ldGhpbmcgYXBwbGllcyBhIHRyYW5zbHVjZW50IG92ZXJsYXkgdmlhIGJhY2tncm91bmQtY29sb3IsIG5ldXRyYWxpemUgaXQgKi8KLnRpbGUuaXMtcGhvdG86YWN0aXZlOjphZnRlciwKLmNvbGxhZ2UtY2VsbC5pcy1waG90bzphY3RpdmU6OmFmdGVyewogIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4yNSk7IC8qIHNhbWUgYXMgaG92ZXIsIG5vIGV4dHJhIGZsYXNoICovCn0KPC9zdHlsZT4KPHN0eWxlPgovKiDQmtC+0L3RgtC10L3RgiArINCQ0YDRhdC40LI6IHRoZXNlIGFyZSBwbGFpbiBoZWFkZXJzLCBzaG91bGQgTk9UIGluaGVyaXQgY29sbGFwc2Utc2VjdGlvbiBoZWFkZXIgaG92ZXIvYmFja2dyb3VuZC9wYWRkaW5nICovCi53cmFwID4gLnNlY3Rpb24taGVhZGVyewogIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICBjdXJzb3I6IGRlZmF1bHQgIWltcG9ydGFudDsKICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Owp9Ci53cmFwID4gLnNlY3Rpb24taGVhZGVyOmhvdmVyLAoud3JhcCA+IC5zZWN0aW9uLWhlYWRlcjphY3RpdmUsCi53cmFwID4gLnNlY3Rpb24taGVhZGVyOmZvY3VzLAoud3JhcCA+IC5zZWN0aW9uLWhlYWRlcjpmb2N1cy13aXRoaW57CiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsKICBib3gtc2hhZG93OiBub25lICFpbXBvcnRhbnQ7CiAgb3V0bGluZTogbm9uZSAhaW1wb3J0YW50Owp9Cjwvc3R5bGU+CjxzdHlsZT4KICBodG1sLGJvZHl7aGVpZ2h0OjEwMCU7fQogIGJvZHl7bWFyZ2luOjA7IHBhZGRpbmc6MjBweDsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7fQo8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5Pgo8ZGl2IGNsYXNzPSJ3cmFwIj4KICAgIDwhLS0g0JrQsNGA0YLQvtGH0LrQsCDQsNCy0YLQvtC80L7QsdC40LvRjyDQuCDRgdCy0L7RgNCw0YfQuNCy0LDQtdC80YvQtSDRgdC10LrRhtC40LggLS0+CiAgICA8ZGl2IGNsYXNzPSJjYXItY2FyZC10aXRsZSI+0JrQsNGA0YLQvtGH0LrQsCDQsNCy0YLQvtC80L7QsdC40LvRjzwvZGl2PgoKICAgIDwhLS0g0JHQm9Ce0JogMTog0J7RgdC90L7QstC90YvQtSDRhdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutC4IC0tPgogICAgPGRpdiBjbGFzcz0iY29sbGFwc2Utc2VjdGlvbiIgaWQ9Im1haW5TcGVjc1NlY3Rpb24iPgogICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWhlYWRlciIgaWQ9Im1haW5TcGVjc0hlYWRlciI+CiAgICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1oZWFkZXItbGVmdCI+CiAgICAgICAgICA8c3BhbiBjbGFzcz0iY29sbGFwc2UtaWNvbiIgaWQ9Im1haW5TcGVjc0ljb24iPgogICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPgogICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC4wNjEgMTkuMDYxTDE3LjEyMSAxMmwtNy4wNi03LjA2MWwtMi4xMjIgMi4xMjJMMTIuODc5IDEybC00Ljk0IDQuOTM5eiIgZmlsbD0iY3VycmVudENvbG9yIi8+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9zcGFuPgogICAgICAgICAgPHNwYW4gY2xhc3M9InNlY3Rpb24taGVhZGVyLXRpdGxlIj7QntGB0L3QvtCy0L3Ri9C1INGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60Lg8L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWNvbnRlbnQgY29sbGFwc2VkIiBpZD0ibWFpblNwZWNzQ29udGVudCI+CiAgICAgICAgPGRpdiBjbGFzcz0ic3BlY3MtZ3JpZCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0JzQsNGA0LrQsDwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPkNIRVZST0xFVDwvc3Bhbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3BlYy1pdGVtIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtbGFiZWwiPtCc0L7QtNC10LvRjDwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPk5JVkE8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7Qk9C+0LQg0LLRi9C/0YPRgdC60LA8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLXZhbHVlIj4yMDExPC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0KbQstC10YI8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLXZhbHVlIj7QotC10LzQvdC+LdC60L7RgNC40YfQvdC10LLRi9C5INC80LXRgtCw0LvQu9C40Lo8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7QotC40L8g0LTQstC40LPQsNGC0LXQu9GPPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+0JHQtdC90LfQuNC9PC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0J/RgNC+0LHQtdCzPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+MTQ1wqAwMDDCoNC60Lw8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7QotGA0LDQvdGB0LzQuNGB0YHQuNGPPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+0JzQtdGF0LDQvdC40YfQtdGB0LrQsNGPPC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0KDRg9C70Yw8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLXZhbHVlIj7Qm9C10LLRi9C5PC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPCEtLSDQkdCb0J7QmiAyOiDQlNC+0LrRg9C80LXQvdGC0Ysg0Lgg0YDQtdCz0LjRgdGC0YDQsNGG0LjRjyAtLT4KICAgIDxkaXYgY2xhc3M9ImNvbGxhcHNlLXNlY3Rpb24iIGlkPSJkb2NzU2VjdGlvbiI+CiAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24taGVhZGVyIiBpZD0iZG9jc0hlYWRlciI+CiAgICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1oZWFkZXItbGVmdCI+CiAgICAgICAgICA8c3BhbiBjbGFzcz0iY29sbGFwc2UtaWNvbiIgaWQ9ImRvY3NJY29uIj4KICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgICAgICAgICAgICA8cGF0aCBkPSJNMTAuMDYxIDE5LjA2MUwxNy4xMjEgMTJsLTcuMDYtNy4wNjFsLTIuMTIyIDIuMTIyTDEyLjg3OSAxMmwtNC45NCA0LjkzOXoiIGZpbGw9ImN1cnJlbnRDb2xvciIvPgogICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZWN0aW9uLWhlYWRlci10aXRsZSI+0JTQvtC60YPQvNC10L3RgtGLINC4INGA0LXQs9C40YHRgtGA0LDRhtC40Y88L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWNvbnRlbnQgY29sbGFwc2VkIiBpZD0iZG9jc0NvbnRlbnQiPgogICAgICAgIDxkaXYgY2xhc3M9InNwZWNzLWdyaWQiPgogICAgICAgICAgPGRpdiBjbGFzcz0ic3BlYy1pdGVtIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtbGFiZWwiPlZJTjwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPlg5TDIxMjMwMEIwMzcyOTA1PC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0JPQvtGBLiDQvdC+0LzQtdGAPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+SDI1NUhUMTYxPC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0KHQotChPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+OTkyMzM0NjM2MTwvc3Bhbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3BlYy1pdGVtIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtbGFiZWwiPtCf0KLQoTwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPtCf0KLQoTwvc3Bhbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3BlYy1pdGVtIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtbGFiZWwiPtCu0YAuINC70LjRhtC+PC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+0LzQtdCz0LDQv9C+0LvQuNGBPC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0J3QsCDRg9GH0LXRgtC1PC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy12YWx1ZSI+0JTQsDwvc3Bhbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3BlYy1pdGVtIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtbGFiZWwiPtCf0YDQuNGF0L7QtDwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPjEyLjAyLjIwMjY8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7QkiDQv9GA0L7QtNCw0LbQtTwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPtCh0LXRgNCy0LjRgdC90LDRjyDQutC90LjQttC60LA8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8IS0tINCR0JvQntCaIDM6INCk0LjQvdCw0L3RgdGLINC4INGA0LDRgdGF0L7QtNGLIC0tPgogICAgPGRpdiBjbGFzcz0iY29sbGFwc2Utc2VjdGlvbiIgaWQ9ImZpbmFuY2VTZWN0aW9uIj4KICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1oZWFkZXIiIGlkPSJmaW5hbmNlSGVhZGVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWhlYWRlci1sZWZ0Ij4KICAgICAgICAgIDxzcGFuIGNsYXNzPSJjb2xsYXBzZS1pY29uIiBpZD0iZmluYW5jZUljb24iPgogICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPgogICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC4wNjEgMTkuMDYxTDE3LjEyMSAxMmwtNy4wNi03LjA2MWwtMi4xMjIgMi4xMjJMMTIuODc5IDEybC00Ljk0IDQuOTM5eiIgZmlsbD0iY3VycmVudENvbG9yIi8+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9zcGFuPgogICAgICAgICAgPHNwYW4gY2xhc3M9InNlY3Rpb24taGVhZGVyLXRpdGxlIj7QpNC40L3QsNC90YHRiyDQuCDRgNCw0YHRhdC+0LTRizwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24tY29udGVudCBjb2xsYXBzZWQiIGlkPSJmaW5hbmNlQ29udGVudCI+CiAgICAgICAgPGRpdiBjbGFzcz0ic3BlY3MtZ3JpZCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0JfQsNGF0L7QtDwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPjM1MMKgMDAwwqDigr08L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7Ql9Cw0YXQvtC0INGBINGA0LDRgdGF0L7QtNCw0LzQuDwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPjQ1MMKgMDAwwqDigr08L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7QoNC10LzQvtC90YI8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLXZhbHVlIj4xMDDCoDAwMMKg4oK9PC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0J/RgNC+0LTQsNC20LA8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLXZhbHVlIj44NTDCoDAwMMKg4oK9PC9zcGFuPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGVjLWl0ZW0iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3BlYy1sYWJlbCI+0JDQstGC0L7QstC+0Lc8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLXZhbHVlIj7igJQ8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InNwZWMtaXRlbSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzcGVjLWxhYmVsIj7QodC90Y/RgtC40LUg0YEg0YPRh9C10YLQsDwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNwZWMtdmFsdWUiPuKAlDwvc3Bhbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDwhLS0g0JHQm9Ce0JogNDog0JTQvtC/0L7Qu9C90LjRgtC10LvRjNC90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjyAtLT4KICAgIDxkaXYgY2xhc3M9ImNvbGxhcHNlLXNlY3Rpb24iIGlkPSJhZGRpdGlvbmFsU2VjdGlvbiI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWhlYWRlciIgaWQ9ImFkZGl0aW9uYWxIZWFkZXIiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24taGVhZGVyLWxlZnQiPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iY29sbGFwc2UtaWNvbiIgaWQ9ImFkZGl0aW9uYWxJY29uIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjA2MSAxOS4wNjFMMTcuMTIxIDEybC03LjA2LTcuMDYxbC0yLjEyMiAyLjEyMkwxMi44NzkgMTJsLTQuOTQgNC45Mzl6IiBmaWxsPSJjdXJyZW50Q29sb3IiLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZWN0aW9uLWhlYWRlci10aXRsZSI+0JTQvtC/0L7Qu9C90LjRgtC10LvRjNC90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1jb250ZW50IiBjb2xsYXBzZWQgaWQ9ImFkZGl0aW9uYWxDb250ZW50Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhZGRpdGlvbmFsLWJsb2NrIj4KICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSDQmtC+0LzQvNC10L3RgtCw0YDQuNC4IC0tPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhZGRpdGlvbmFsLWl0ZW0iIGlkPSJjb21tZW50c1NlY3Rpb24iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYWRkaXRpb25hbC1oZWFkZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJhZGRpdGlvbmFsLXRpdGxlIj7QmtC+0LzQvNC10L3RgtCw0YDQuNC5PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS11cGxvYWQgYWRkLWJ1dHRvbiIgaWQ9ImFkZENvbW1lbnRCdG4iIHRpdGxlPSLQlNC+0LHQsNCy0LjRgtGMINC60L7QvNC80LXQvdGC0LDRgNC40LkiIGFyaWEtbGFiZWw9ItCU0L7QsdCw0LLQuNGC0Ywg0LrQvtC80LzQtdC90YLQsNGA0LjQuSI+PHNwYW4gY2xhc3M9Imljb24iPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNMTkgMTFoLTZWNWgtMnY2SDV2Mmg2djZoMnYtNmg2eiIvPjwvc3ZnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29tbWVudHMtbGlzdCIgaWQ9ImNvbW1lbnRzTGlzdCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgICAgICA8IS0tINCf0YDQuNC60YDQtdC/0LvRkdC90L3Ri9C1INGB0YHRi9C70LrQuCAtLT4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYWRkaXRpb25hbC1pdGVtIiBpZD0ibGlua3NTZWN0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImFkZGl0aW9uYWwtaGVhZGVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iYWRkaXRpb25hbC10aXRsZSI+0J/RgNC40LrRgNC10L/Qu9GR0L3QvdGL0LUg0YHRgdGL0LvQutC4PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS11cGxvYWQgYWRkLWJ1dHRvbiIgaWQ9ImFkZExpbmtCdG4iIHRpdGxlPSLQlNC+0LHQsNCy0LjRgtGMINGB0YHRi9C70LrRgyIgYXJpYS1sYWJlbD0i0JTQvtCx0LDQstC40YLRjCDRgdGB0YvQu9C60YMiPjxzcGFuIGNsYXNzPSJpY29uIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTE5IDExaC02VjVoLTJ2Nkg1djJoNnY2aDJ2LTZoNnoiLz48L3N2Zz48L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpbmtzLWxpc3QiIGlkPSJsaW5rc0xpc3QiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9InNlY3Rpb24taGVhZGVyIj4KICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi10aXRsZSIgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEycHg7Ij7QmtC+0L3RgtC10L3RgjxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS11cGxvYWQiIGlkPSJhZGRLaXRCdG4iIHRpdGxlPSLQlNC+0LHQsNCy0LjRgtGMINC60L7QvdGC0LXQvdGCIiBhcmlhLWxhYmVsPSLQlNC+0LHQsNCy0LjRgtGMINC60L7QvdGC0LXQvdGCIj48c3BhbiBjbGFzcz0iaWNvbiIgaWQ9InN2Z1BsdXNCdG4iPjwvc3Bhbj48L2J1dHRvbj48L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1hY3Rpb25zIiBzdHlsZT0iZGlzcGxheTpub25lOyI+PC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJraXRzIiBpZD0ia2l0cyI+PC9kaXY+CgogICAgPCEtLSDQkNGA0YXQuNCyIC0tPgogICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1oZWFkZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiA0cHg7Ij4KICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi10aXRsZSI+0JDRgNGF0LjQsjwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWFjdGlvbnMiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij48L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImtpdHMiIGlkPSJhcmNoaXZlS2l0cyI+PC9kaXY+CgogIDwvZGl2PgoKICA8IS0tIFZpZXdlciAtLT4KICA8ZGl2IGNsYXNzPSJ2aWV3ZXItYmFja2Ryb3AiIGlkPSJ2aWV3ZXJCYWNrZHJvcCIgYXJpYS1oaWRkZW49InRydWUiIHRhYmluZGV4PSItMSI+CiAgICA8ZGl2IGNsYXNzPSJ2aWV3ZXIiIHJvbGU9ImRpYWxvZyIgYXJpYS1tb2RhbD0idHJ1ZSIgYXJpYS1sYWJlbD0i0J/RgNC+0YHQvNC+0YLRgCDRhNC+0YLQviI+CiAgICAgIDxkaXYgY2xhc3M9InZpZXdlci1yYWlsIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJyYWlsLWJ0biIgaWQ9InJhaWxVcCIgYXJpYS1sYWJlbD0i0J/RgNC+0LrRgNGD0YLQuNGC0Ywg0LLQstC10YDRhSI+CiAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik03LjQxIDE1LjQxIDEyIDEwLjgzbDQuNTkgNC41OEwxOCAxNGwtNi02LTYgNnoiLz48L3N2Zz4KICAgICAgICA8L2J1dHRvbj4KICAgICAgICA8ZGl2IGNsYXNzPSJ2aWV3ZXItdGh1bWJzIiBpZD0idmlld2VyVGh1bWJzIj48L2Rpdj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJyYWlsLWJ0biIgaWQ9InJhaWxEb3duIiBhcmlhLWxhYmVsPSLQn9GA0L7QutGA0YPRgtC40YLRjCDQstC90LjQtyI+CiAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Im03LjQxIDguNTkgNC41OSA0LjU4IDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNnoiLz48L3N2Zz4KICAgICAgICA8L2J1dHRvbj4KICAgICAgPC9kaXY+CgogICAgICAKICAgICAgPGRpdiBjbGFzcz0idmlld2VyLXN0YWdlIiBpZD0idmlld2VyU3RhZ2UiPgogICAgICAgIDxkaXYgY2xhc3M9InZpZXdlci1jb3VudGVyIiBpZD0idmlld2VyQ291bnRlciI+MC8wPC9kaXY+CjxkaXYgY2xhc3M9InZpZXdlci1hY3Rpb25zIiBpZD0idmlld2VyQWN0aW9ucyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbi1idG4gaWNvbi1idG4tLWRhcmsiIGlkPSJ2aWV3ZXJDbG9zZSIgYXJpYS1sYWJlbD0i0JfQsNC60YDRi9GC0YwiPgogICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24gcm90YXRlLTQ1IiBpZD0ic3ZnQ2xvc2UiPjwvc3Bhbj4KICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uLWJ0biBpY29uLWJ0bi0tZGFuZ2VyIiBpZD0idmlld2VyRGVsZXRlQnRuIiB0aXRsZT0i0KPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4iIGFyaWEtbGFiZWw9ItCj0LTQsNC70LjRgtGMINGE0L7RgtC+IiBzdHlsZT0iZGlzcGxheTpub25lOyI+CiAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iIGlkPSJzdmdUcmFzaFZpZXdlciI+PC9zcGFuPgogICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgCiAgICAgIDwvZGl2PgoKPGRpdiBjbGFzcz0ic3RhZ2Utc3RhY2siIGlkPSJzdGFnZVN0YWNrIj4KICAgICAgICAgIDxkaXYgY2xhc3M9InN0YWdlLWl0ZW0gbWFpbiIgaWQ9InN0YWdlTWFpbiI+CjxpbWcgY2xhc3M9InN0YWdlLWltZyIgaWQ9InZpZXdlckltZyIgYWx0PSLQpNC+0YLQviDQsNCy0YLQvtC80L7QsdC40LvRjyI+CiAgICAgICAgICA8L2Rpdj4KPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDxpbnB1dCB0eXBlPSJmaWxlIiBpZD0iZmlsZUlucHV0IiBhY2NlcHQ9ImltYWdlLyoiIG11bHRpcGxlIHN0eWxlPSJkaXNwbGF5Om5vbmU7IiAvPgoKICA8c2NyaXB0PgogICAgLyogPT09PT0gU1ZHIElDT05TIChwcm92aWRlZCkgPT09PT0gKi8KICAgIGNvbnN0IFNWR19ET1dOTE9BRCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTYgMThoMTJ2Mkg2em01LTE0djguNTg2TDYuNzA3IDguMjkzTDUuMjkzIDkuNzA3TDEyIDE2LjQxNGw2LjcwNy02LjcwN2wtMS40MTQtMS40MTRMMTMgMTIuNTg2VjR6Ii8+PC9zdmc+YDsKICAgIGNvbnN0IFNWR19UUkFTSCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTUgMjBhMiAyIDAgMCAwIDIgMmgxMGEyIDIgMCAwIDAgMi0yVjhoMlY2aC00VjRhMiAyIDAgMCAwLTItMkg5YTIgMiAwIDAgMC0yIDJ2MkgzdjJoMnpNOSA0aDZ2Mkg5ek04IDhoOXYxMkg3Vjh6Ii8+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNOSAxMGgydjhIOXptNCAwaDJ2OGgtMnoiLz48L3N2Zz5gOwogICAgY29uc3QgU1ZHX1BMVVMgPSBgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMCIgaGVpZ2h0PSIzMCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0xOSAxMWgtNlY1aC0ydjZINXYyaDZ2Nmgydi02aDZ6Ii8+PC9zdmc+YDsKICAgIGNvbnN0IFNWR19JTUFHRV9BREQgPSBgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48dGl0bGU+SW1hZ2UtYWRkIFNWRyBJY29uPC90aXRsZT48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik00IDVoMTN2N2gyVjVjMC0xLjEwMy0uODk3LTItMi0ySDRjLTEuMTAzIDAtMiAuODk3LTIgMnYxMmMwIDEuMTAzLjg5NyAyIDIgMmg4di0ySDR6Ii8+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJtOCAxMWwtMyA0aDExbC00LTZsLTMgNHoiLz48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0xOSAxNGgtMnYzaC0zdjJoM3YzaDJ2LTNoM3YtMmgtM3oiLz48L3N2Zz5gOwogICAgLy8gdXNlcidzIG5ldyBlZGl0IGljb24KICAgIGNvbnN0IFNWR19FRElUID0gYDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE2IDIuMDEybDMgM0wxNi43MTMgNy4zbC0zLTN6TTQgMTR2M2gzbDguMjk5LTguMjg3bC0zLTN6bTAgNmgxNnYySDR6IiBmaWxsPSJjdXJyZW50Q29sb3IiLz48L3N2Zz5gOwogICAgY29uc3QgU1ZHX0NIRUNLID0gYDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTkgMTYuMiA0LjggMTJsLTEuNCAxLjRMOSAxOSAyMSA3bC0xLjQtMS40eiIvPjwvc3ZnPmA7CiAgICBjb25zdCBTVkdfUkVTVE9SRSA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTEwIDExaDZ2N2gydi04YTEgMSAwIDAgMC0xLTFoLTdWNmwtNSA0bDUgNHoiLz48L3N2Zz5gOwoKICAgIC8vIG1vdW50IGljb25zCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ZnUGx1c0J0bicpLmlubmVySFRNTCA9IFNWR19QTFVTOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N2Z1RyYXNoVmlld2VyJykuaW5uZXJIVE1MID0gU1ZHX1RSQVNIOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N2Z0Nsb3NlJykuaW5uZXJIVE1MID0gU1ZHX1BMVVM7CgoKICAgIC8qID09PT09IEhFTFBFUlMgPT09PT0gKi8KICAgIGZ1bmN0aW9uIHVpZCgpewogICAgICBpZiAod2luZG93LmNyeXB0byAmJiBjcnlwdG8ucmFuZG9tVVVJRCkgcmV0dXJuIGNyeXB0by5yYW5kb21VVUlEKCk7CiAgICAgIHJldHVybiAnaWRfJyArIERhdGUubm93KCkudG9TdHJpbmcoMzYpICsgJ18nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMik7CiAgICB9CgogICAgZnVuY3Rpb24gcGFkMihuKXsgcmV0dXJuIFN0cmluZyhuKS5wYWRTdGFydCgyLCcwJyk7IH0KICAgIGZ1bmN0aW9uIGZvcm1hdERhdGUoZCl7CiAgICAgIC8vIGRkLm1tLnl5eXkKICAgICAgY29uc3QgZGF5ID0gcGFkMihkLmdldERhdGUoKSk7CiAgICAgIGNvbnN0IG1vbiA9IHBhZDIoZC5nZXRNb250aCgpKzEpOwogICAgICBjb25zdCB5ciA9IGQuZ2V0RnVsbFllYXIoKTsKICAgICAgcmV0dXJuIGAke2RheX0uJHttb259LiR7eXJ9YDsKICAgIH0KCiAgICBmdW5jdGlvbiBmb3JtYXREYXRlVGltZShkKXsKICAgICAgLy8gZGQubW0ueXl5eSBISDpNTSAo0LHQtdC3INGB0LXQutGD0L3QtCkKICAgICAgY29uc3QgZGF5ID0gcGFkMihkLmdldERhdGUoKSk7CiAgICAgIGNvbnN0IG1vbiA9IHBhZDIoZC5nZXRNb250aCgpKzEpOwogICAgICBjb25zdCB5ciA9IGQuZ2V0RnVsbFllYXIoKTsKICAgICAgY29uc3QgaGggPSBwYWQyKGQuZ2V0SG91cnMoKSk7CiAgICAgIGNvbnN0IG1tID0gcGFkMihkLmdldE1pbnV0ZXMoKSk7CiAgICAgIHJldHVybiBgJHtkYXl9LiR7bW9ufS4ke3lyfSAke2hofToke21tfWA7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGNyZWF0ZUtpdCgpewogICAgICByZXR1cm4gewogICAgICAgIGlkOiB1aWQoKSwKICAgICAgICB0aXRsZTogJ9Cd0L7QstGL0Lkg0LrQvtC90YLQtdC90YInLAogICAgICAgIHBob3RvczogW10sCiAgICAgICAgdXNlZDogZmFsc2UsCiAgICAgICAgdXNlZERhdGU6IG51bGwsCiAgICAgICAgY3JlYXRlZEF0OiBudWxsCiAgICAgIH07CiAgICB9CgoKICAgIC8qID09PT09IFNUQVRFID09PT09ICovCiAgICBjb25zdCBraXRzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2l0cycpOwogICAgY29uc3QgYXJjaGl2ZUtpdHNFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcmNoaXZlS2l0cycpOwogICAgY29uc3QgYWRkS2l0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZEtpdEJ0bicpOwogICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpOwoKICAgIC8vIFZpZXdlcgogICAgY29uc3Qgdmlld2VyQmFja2Ryb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld2VyQmFja2Ryb3AnKTsKICAgIGNvbnN0IHZpZXdlclRodW1icyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3ZXJUaHVtYnMnKTsKICAgIGNvbnN0IHZpZXdlckltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3ZXJJbWcnKTsKY29uc3Qgc3RhZ2VTdGFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFnZVN0YWNrJyk7CiAgICBjb25zdCB2aWV3ZXJDbG9zZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3ZXJDbG9zZScpOwpjb25zdCB2aWV3ZXJDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdlckNvdW50ZXInKTsKICAgIGNvbnN0IHZpZXdlckRlbGV0ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3ZXJEZWxldGVCdG4nKTsKICAgIGNvbnN0IHJhaWxVcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYWlsVXAnKTsKICAgIGNvbnN0IHJhaWxEb3duID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhaWxEb3duJyk7CgogICAgbGV0IGtpdHMgPSBbY3JlYXRlS2l0KCldOwogICAgbGV0IGFyY2hpdmVkS2l0cyA9IFtdOwoKICAgIC8vIG1pc3Npbmcgc3RhdGUgdmFycwogICAgbGV0IGFjdGl2ZUVkaXRLaXRJZCA9IG51bGw7CiAgICBsZXQgdmlld2VyS2l0SWQgPSBudWxsOwogICAgbGV0IHZpZXdlckluZGV4ID0gMDsKICAgIGxldCB2aWV3ZXJDYW5EZWxldGUgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBnZXRLaXRCeUlkKGtpdElkKXsKICAgICAgcmV0dXJuIGtpdHMuZmluZChrPT5rLmlkPT09a2l0SWQpIHx8IGFyY2hpdmVkS2l0cy5maW5kKGs9PmsuaWQ9PT1raXRJZCkgfHwgbnVsbDsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0tpdEluTWFpbihraXRJZCl7CiAgICAgIHJldHVybiBraXRzLnNvbWUoaz0+ay5pZD09PWtpdElkKTsKICAgIH0KCgogICAgZnVuY3Rpb24gc2V0T25seU9uZUVkaXQoa2l0SWQpewogICAgICBhY3RpdmVFZGl0S2l0SWQgPSBraXRJZDsKICAgICAgcmVuZGVyKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZXhpdEVkaXQoKXsKICAgICAgYWN0aXZlRWRpdEtpdElkID0gbnVsbDsKICAgICAgcmVuZGVyKCk7CiAgICB9CgogICAgZnVuY3Rpb24gaXNFZGl0KGtpdElkKXsgcmV0dXJuIGFjdGl2ZUVkaXRLaXRJZCA9PT0ga2l0SWQ7IH0KCiAgICBmdW5jdGlvbiBlc2NhcGVIdG1sKHN0cil7CiAgICAgIHJldHVybiBTdHJpbmcoc3RyKQogICAgICAgIC5yZXBsYWNlQWxsKCcmJywnJmFtcDsnKQogICAgICAgIC5yZXBsYWNlQWxsKCc8JywnJmx0OycpCiAgICAgICAgLnJlcGxhY2VBbGwoJz4nLCcmZ3Q7JykKICAgICAgICAucmVwbGFjZUFsbCgnIicsJyZxdW90OycpCiAgICAgICAgLnJlcGxhY2VBbGwoIiciLCcmIzAzOTsnKTsKICAgIH0KCiAgICAKICAgIC8vIC0tLSBaSVAgZG93bmxvYWQgKG5vIGV4dGVybmFsIGxpYnMpLiBTdG9yZWQgbWV0aG9kIChubyBjb21wcmVzc2lvbikgLS0tCiAgICBmdW5jdGlvbiBzYW5pdGl6ZUZpbGVOYW1lKG5hbWUpewogICAgICByZXR1cm4gKG5hbWUgfHwgJ2NvbnRlbnQnKQogICAgICAgIC50b1N0cmluZygpCiAgICAgICAgLnRyaW0oKQogICAgICAgIC5yZXBsYWNlKC9bXC9cXDoqPyI8PnxdKy9nLCAnXycpCiAgICAgICAgLnJlcGxhY2UoL1xzKy9nLCAnICcpCiAgICAgICAgLnNsaWNlKDAsIDgwKSB8fCAnY29udGVudCc7CiAgICB9CgogICAgZnVuY3Rpb24gZGF0YVVybFRvQmxvYih1cmwpewogICAgICAvLyBmZXRjaCB3b3JrcyBmb3IgZGF0YTogVVJMcyBhbmQgYmxvYjogVVJMcwogICAgICByZXR1cm4gZmV0Y2godXJsKS50aGVuKHIgPT4gci5ibG9iKCkpOwogICAgfQoKICAgIC8vIENSQzMyIGZvciBaSVAKICAgIGNvbnN0IF9jcmNUYWJsZSA9ICgoKSA9PiB7CiAgICAgIGNvbnN0IHRhYmxlID0gbmV3IFVpbnQzMkFycmF5KDI1Nik7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyBpKyspewogICAgICAgIGxldCBjID0gaTsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IDg7IGsrKyl7CiAgICAgICAgICBjID0gKGMgJiAxKSA/ICgweEVEQjg4MzIwIF4gKGMgPj4+IDEpKSA6IChjID4+PiAxKTsKICAgICAgICB9CiAgICAgICAgdGFibGVbaV0gPSBjID4+PiAwOwogICAgICB9CiAgICAgIHJldHVybiB0YWJsZTsKICAgIH0pKCk7CgogICAgZnVuY3Rpb24gY3JjMzIoYnVmKXsKICAgICAgbGV0IGMgPSAweEZGRkZGRkZGOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1Zi5sZW5ndGg7IGkrKyl7CiAgICAgICAgYyA9IF9jcmNUYWJsZVsoYyBeIGJ1ZltpXSkgJiAweEZGXSBeIChjID4+PiA4KTsKICAgICAgfQogICAgICByZXR1cm4gKGMgXiAweEZGRkZGRkZGKSA+Pj4gMDsKICAgIH0KCiAgICBmdW5jdGlvbiB1MTYobil7IHJldHVybiBuZXcgVWludDhBcnJheShbbiAmIDI1NSwgKG4gPj4+IDgpICYgMjU1XSk7IH0KICAgIGZ1bmN0aW9uIHUzMihuKXsgcmV0dXJuIG5ldyBVaW50OEFycmF5KFtuICYgMjU1LCAobiA+Pj4gOCkgJiAyNTUsIChuID4+PiAxNikgJiAyNTUsIChuID4+PiAyNCkgJiAyNTVdKTsgfQoKICAgIGZ1bmN0aW9uIGNvbmNhdFVpbnQ4KGFycmF5cyl7CiAgICAgIGNvbnN0IHRvdGFsID0gYXJyYXlzLnJlZHVjZSgocyxhKT0+cythLmxlbmd0aCwwKTsKICAgICAgY29uc3Qgb3V0ID0gbmV3IFVpbnQ4QXJyYXkodG90YWwpOwogICAgICBsZXQgb2ZmID0gMDsKICAgICAgZm9yIChjb25zdCBhIG9mIGFycmF5cyl7IG91dC5zZXQoYSwgb2ZmKTsgb2ZmICs9IGEubGVuZ3RoOyB9CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CgogICAgZnVuY3Rpb24gZG9zRGF0ZVRpbWUoZGF0ZSl7CiAgICAgIGNvbnN0IGQgPSBkYXRlIGluc3RhbmNlb2YgRGF0ZSA/IGRhdGUgOiBuZXcgRGF0ZSgpOwogICAgICBjb25zdCB0aW1lID0KICAgICAgICAoKGQuZ2V0SG91cnMoKSAmIDB4MUYpIDw8IDExKSB8CiAgICAgICAgKChkLmdldE1pbnV0ZXMoKSAmIDB4M0YpIDw8IDUpIHwKICAgICAgICAoKE1hdGguZmxvb3IoZC5nZXRTZWNvbmRzKCkvMikpICYgMHgxRik7CiAgICAgIGNvbnN0IGRheSA9IGQuZ2V0RGF0ZSgpOwogICAgICBjb25zdCBtb250aCA9IGQuZ2V0TW9udGgoKSArIDE7CiAgICAgIGNvbnN0IHllYXIgPSBkLmdldEZ1bGxZZWFyKCkgLSAxOTgwOwogICAgICBjb25zdCBkb3NEYXRlID0KICAgICAgICAoKHllYXIgJiAweDdGKSA8PCA5KSB8CiAgICAgICAgKChtb250aCAmIDB4MEYpIDw8IDUpIHwKICAgICAgICAoZGF5ICYgMHgxRik7CiAgICAgIHJldHVybiB7IHRpbWUsIGRhdGU6IGRvc0RhdGUgfTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBtYWtlWmlwKGZpbGVzKXsKICAgICAgLy8gZmlsZXM6IFt7bmFtZSwgYmxvYn1dCiAgICAgIGNvbnN0IGxvY2FsUGFydHMgPSBbXTsKICAgICAgY29uc3QgY2VudHJhbFBhcnRzID0gW107CiAgICAgIGxldCBvZmZzZXQgPSAwOwoKICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsKICAgICAgY29uc3QgZHQgPSBkb3NEYXRlVGltZShub3cpOwoKICAgICAgZm9yIChjb25zdCBmIG9mIGZpbGVzKXsKICAgICAgICBjb25zdCBuYW1lQnl0ZXMgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoZi5uYW1lKTsKICAgICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoYXdhaXQgZi5ibG9iLmFycmF5QnVmZmVyKCkpOwogICAgICAgIGNvbnN0IGNyYyA9IGNyYzMyKGRhdGEpOwogICAgICAgIGNvbnN0IGNvbXBTaXplID0gZGF0YS5sZW5ndGg7CiAgICAgICAgY29uc3QgdW5jb21wU2l6ZSA9IGRhdGEubGVuZ3RoOwoKICAgICAgICAvLyBMb2NhbCBmaWxlIGhlYWRlcgogICAgICAgIGNvbnN0IGxvY2FsSGVhZGVyID0gY29uY2F0VWludDgoWwogICAgICAgICAgdTMyKDB4MDQwMzRiNTApLCAgICAgICAgLy8gc2lnbmF0dXJlCiAgICAgICAgICB1MTYoMjApLCAgICAgICAgICAgICAgICAvLyB2ZXJzaW9uIG5lZWRlZAogICAgICAgICAgdTE2KDApLCAgICAgICAgICAgICAgICAgLy8gZmxhZ3MKICAgICAgICAgIHUxNigwKSwgICAgICAgICAgICAgICAgIC8vIGNvbXByZXNzaW9uIDAgPSBzdG9yZWQKICAgICAgICAgIHUxNihkdC50aW1lKSwgICAgICAgICAgIC8vIG1vZCB0aW1lCiAgICAgICAgICB1MTYoZHQuZGF0ZSksICAgICAgICAgICAvLyBtb2QgZGF0ZQogICAgICAgICAgdTMyKGNyYyksICAgICAgICAgICAgICAgLy8gY3JjMzIKICAgICAgICAgIHUzMihjb21wU2l6ZSksICAgICAgICAgIC8vIGNvbXByZXNzZWQgc2l6ZQogICAgICAgICAgdTMyKHVuY29tcFNpemUpLCAgICAgICAgLy8gdW5jb21wcmVzc2VkIHNpemUKICAgICAgICAgIHUxNihuYW1lQnl0ZXMubGVuZ3RoKSwgIC8vIGZpbGUgbmFtZSBsZW5ndGgKICAgICAgICAgIHUxNigwKSwgICAgICAgICAgICAgICAgIC8vIGV4dHJhIGxlbmd0aAogICAgICAgICAgbmFtZUJ5dGVzCiAgICAgICAgXSk7CgogICAgICAgIGxvY2FsUGFydHMucHVzaChsb2NhbEhlYWRlciwgZGF0YSk7CgogICAgICAgIC8vIENlbnRyYWwgZGlyZWN0b3J5IGhlYWRlcgogICAgICAgIGNvbnN0IGNlbnRyYWxIZWFkZXIgPSBjb25jYXRVaW50OChbCiAgICAgICAgICB1MzIoMHgwMjAxNGI1MCksICAgICAgICAvLyBzaWduYXR1cmUKICAgICAgICAgIHUxNigyMCksICAgICAgICAgICAgICAgIC8vIHZlcnNpb24gbWFkZSBieQogICAgICAgICAgdTE2KDIwKSwgICAgICAgICAgICAgICAgLy8gdmVyc2lvbiBuZWVkZWQKICAgICAgICAgIHUxNigwKSwgICAgICAgICAgICAgICAgIC8vIGZsYWdzCiAgICAgICAgICB1MTYoMCksICAgICAgICAgICAgICAgICAvLyBjb21wcmVzc2lvbgogICAgICAgICAgdTE2KGR0LnRpbWUpLAogICAgICAgICAgdTE2KGR0LmRhdGUpLAogICAgICAgICAgdTMyKGNyYyksCiAgICAgICAgICB1MzIoY29tcFNpemUpLAogICAgICAgICAgdTMyKHVuY29tcFNpemUpLAogICAgICAgICAgdTE2KG5hbWVCeXRlcy5sZW5ndGgpLAogICAgICAgICAgdTE2KDApLCAgICAgICAgICAgICAgICAgLy8gZXh0cmEKICAgICAgICAgIHUxNigwKSwgICAgICAgICAgICAgICAgIC8vIGNvbW1lbnQKICAgICAgICAgIHUxNigwKSwgICAgICAgICAgICAgICAgIC8vIGRpc2sgbnVtYmVyCiAgICAgICAgICB1MTYoMCksICAgICAgICAgICAgICAgICAvLyBpbnRlcm5hbCBhdHRycwogICAgICAgICAgdTMyKDApLCAgICAgICAgICAgICAgICAgLy8gZXh0ZXJuYWwgYXR0cnMKICAgICAgICAgIHUzMihvZmZzZXQpLCAgICAgICAgICAgIC8vIGxvY2FsIGhlYWRlciBvZmZzZXQKICAgICAgICAgIG5hbWVCeXRlcwogICAgICAgIF0pOwoKICAgICAgICBjZW50cmFsUGFydHMucHVzaChjZW50cmFsSGVhZGVyKTsKCiAgICAgICAgb2Zmc2V0ICs9IGxvY2FsSGVhZGVyLmxlbmd0aCArIGRhdGEubGVuZ3RoOwogICAgICB9CgogICAgICBjb25zdCBjZW50cmFsRGlyID0gY29uY2F0VWludDgoY2VudHJhbFBhcnRzKTsKICAgICAgY29uc3QgY2VudHJhbE9mZnNldCA9IG9mZnNldDsKICAgICAgb2Zmc2V0ICs9IGNlbnRyYWxEaXIubGVuZ3RoOwoKICAgICAgLy8gRW5kIG9mIGNlbnRyYWwgZGlyZWN0b3J5CiAgICAgIGNvbnN0IGVuZCA9IGNvbmNhdFVpbnQ4KFsKICAgICAgICB1MzIoMHgwNjA1NGI1MCksCiAgICAgICAgdTE2KDApLCAgICAgICAgICAgICAgICAgLy8gZGlzawogICAgICAgIHUxNigwKSwgICAgICAgICAgICAgICAgIC8vIHN0YXJ0IGRpc2sKICAgICAgICB1MTYoZmlsZXMubGVuZ3RoKSwgICAgICAvLyBlbnRyaWVzIG9uIGRpc2sKICAgICAgICB1MTYoZmlsZXMubGVuZ3RoKSwgICAgICAvLyB0b3RhbCBlbnRyaWVzCiAgICAgICAgdTMyKGNlbnRyYWxEaXIubGVuZ3RoKSwgLy8gY2VudHJhbCBkaXIgc2l6ZQogICAgICAgIHUzMihjZW50cmFsT2Zmc2V0KSwgICAgIC8vIGNlbnRyYWwgZGlyIG9mZnNldAogICAgICAgIHUxNigwKSAgICAgICAgICAgICAgICAgIC8vIGNvbW1lbnQgbGVuZ3RoCiAgICAgIF0pOwoKICAgICAgY29uc3QgemlwQnl0ZXMgPSBjb25jYXRVaW50OChbLi4ubG9jYWxQYXJ0cywgY2VudHJhbERpciwgZW5kXSk7CiAgICAgIHJldHVybiBuZXcgQmxvYihbemlwQnl0ZXNdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi96aXAnIH0pOwogICAgfQoKICAgIGFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkS2l0WmlwKGtpdElkKXsKICAgICAgY29uc3Qga2l0ID0gZ2V0S2l0QnlJZChraXRJZCk7CiAgICAgIGlmICgha2l0KSByZXR1cm47CgogICAgICBjb25zdCBwaG90b3MgPSAoa2l0LnBob3RvcyB8fCBbXSkuc2xpY2UoKTsKICAgICAgaWYgKCFwaG90b3MubGVuZ3RoKXsKICAgICAgICBhbGVydCgn0J3QtdGCINGE0L7RgtC+0LPRgNCw0YTQuNC5INC00LvRjyDRgdC60LDRh9C40LLQsNC90LjRjy4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIEJ1aWxkIGZpbGUgbGlzdAogICAgICBjb25zdCBmaWxlcyA9IFtdOwogICAgICBsZXQgaSA9IDE7CiAgICAgIGZvciAoY29uc3QgcCBvZiBwaG90b3MpewogICAgICAgIHRyeXsKICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBkYXRhVXJsVG9CbG9iKHAuc3JjKTsKICAgICAgICAgIGNvbnN0IGV4dCA9IChibG9iLnR5cGUgfHwgJycpLmluY2x1ZGVzKCdwbmcnKSA/ICdwbmcnCiAgICAgICAgICAgICAgICAgICA6IChibG9iLnR5cGUgfHwgJycpLmluY2x1ZGVzKCd3ZWJwJykgPyAnd2VicCcKICAgICAgICAgICAgICAgICAgIDogKGJsb2IudHlwZSB8fCAnJykuaW5jbHVkZXMoJ2dpZicpID8gJ2dpZicKICAgICAgICAgICAgICAgICAgIDogJ2pwZyc7CiAgICAgICAgICBjb25zdCBudW0gPSBTdHJpbmcoaSsrKS5wYWRTdGFydCgyLCcwJyk7CiAgICAgICAgICBmaWxlcy5wdXNoKHsgbmFtZTogYHBob3RvXyR7bnVtfS4ke2V4dH1gLCBibG9iIH0pOwogICAgICAgIH1jYXRjaChlcnIpe30KICAgICAgfQoKICAgICAgaWYgKCFmaWxlcy5sZW5ndGgpewogICAgICAgIGFsZXJ0KCfQndC1INGD0LTQsNC70L7RgdGMINC/0L7QtNCz0L7RgtC+0LLQuNGC0Ywg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0LTQu9GPINGB0LrQsNGH0LjQstCw0L3QuNGPLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgemlwQmxvYiA9IGF3YWl0IG1ha2VaaXAoZmlsZXMpOwogICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICBjb25zdCB0aXRsZSA9IHNhbml0aXplRmlsZU5hbWUoa2l0LnRpdGxlIHx8ICdjb250ZW50Jyk7CiAgICAgIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoemlwQmxvYik7CiAgICAgIGEuZG93bmxvYWQgPSBgJHt0aXRsZX0uemlwYDsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgYS5jbGljaygpOwogICAgICBzZXRUaW1lb3V0KCgpPT57CiAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChhLmhyZWYpOwogICAgICAgIGEucmVtb3ZlKCk7CiAgICAgIH0sIDEwMDApOwogICAgfQoKCmZ1bmN0aW9uIHJlbmRlcigpewogICAgICBmdW5jdGlvbiByZW5kZXJMaXN0KGxpc3QsIGhvc3RFbCwgbW9kZSl7CiAgICAgICAgY29uc3QgaXNBcmNoaXZlID0gbW9kZSA9PT0gJ2FyY2hpdmUnOwogICAgICAgIGhvc3RFbC5pbm5lckhUTUwgPSBsaXN0Lm1hcChraXQgPT4gewogICAgICAgICAgY29uc3QgZWRpdCA9ICghaXNBcmNoaXZlKSAmJiBpc0VkaXQoa2l0LmlkKTsKICAgICAgICAgIGNvbnN0IHVzZWRDbGFzcyA9IGtpdC51c2VkID8gJ2lzLXVzZWQnIDogJyc7CiAgICAgICAgICBjb25zdCBlZGl0Q2xhc3MgPSBlZGl0ID8gJ2lzLWVkaXQnIDogJyc7CgogICAgICAgICAgY29uc3QgdGl0bGVBdHRyID0gZWRpdCA/ICdjb250ZW50ZWRpdGFibGU9InRydWUiJyA6ICcnOwogICAgICAgICAgY29uc3QgdGl0bGVEYXRhID0ga2l0LnRpdGxlIHx8ICfQndC+0LLRi9C5INC60L7QvdGC0LXQvdGCJzsKCiAgICAgICAgICBjb25zdCB0b3RhbCA9IGtpdC5waG90b3MubGVuZ3RoOwogICAgICAgICAgY29uc3QgdXBsb2FkZWQgPSBraXQuY3JlYXRlZEF0ID8ga2l0LmNyZWF0ZWRBdCA6ICfigJQnOwoKICAgICAgICAgIC8vIEluIGFyY2hpdmU6IG5vIGFkZC1waG90b3MgdGlsZQogICAgICAgICAgY29uc3QgcHJldmlld05vQWRkID0gaXNBcmNoaXZlID8gdHJ1ZSA6ICEha2l0LnVzZWQ7CgogICAgICAgICAgY29uc3QgcGhvdG9UaWxlID0gKHBob3RvLCBnbG9iYWxJbmRleCkgPT4gewogICAgICAgICAgICBpZiAoIXBob3RvKSByZXR1cm4gYDxkaXYgY2xhc3M9InRpbGUgaXMtZW1wdHkiPjwvZGl2PmA7CiAgICAgICAgICAgIHJldHVybiBgCiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGlsZSBpcy1waG90byIgZGF0YS1hY3Rpb249Im9wZW4iIGRhdGEta2l0LWlkPSIke2tpdC5pZH0iIGRhdGEtaW5kZXg9IiR7Z2xvYmFsSW5kZXh9Ij4KICAgICAgICAgICAgICAgIDxpbWcgc3JjPSIke3Bob3RvLnNyY30iIGFsdD0i0KTQvtGC0L4iPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgfTsKCiAgICAgICAgICBsZXQgcmVtYWluaW5nID0gMDsKICAgICAgICAgIGxldCBtYWluUGhvdG9zID0gW107CiAgICAgICAgICBsZXQgY29sbGFnZVBob3RvcyA9IFtdOwogICAgICAgICAgbGV0IG1haW5JZHhCYXNlID0gMDsKICAgICAgICAgIGxldCBjb2xsYWdlSWR4QmFzZSA9IDA7CiAgICAgICAgICBsZXQgZmlyc3RDZWxsSHRtbCA9ICcnOwoKICAgICAgICAgIGlmIChwcmV2aWV3Tm9BZGQpewogICAgICAgICAgICAvLyBbMF0gZmlyc3QgY2VsbCBwaG90by9lbXB0eTsgWzEuLjRdIG1haW47IFs1Li44XSBjb2xsYWdlICg5IHZpc2libGUpCiAgICAgICAgICAgIGZpcnN0Q2VsbEh0bWwgPSBwaG90b1RpbGUoa2l0LnBob3Rvc1swXSB8fCBudWxsLCAwKTsKICAgICAgICAgICAgbWFpblBob3RvcyA9IGtpdC5waG90b3Muc2xpY2UoMSwgNSk7CiAgICAgICAgICAgIGNvbGxhZ2VQaG90b3MgPSBraXQucGhvdG9zLnNsaWNlKDUsIDkpOwogICAgICAgICAgICByZW1haW5pbmcgPSBNYXRoLm1heCgwLCBraXQucGhvdG9zLmxlbmd0aCAtIDkpOwogICAgICAgICAgICBtYWluSWR4QmFzZSA9IDE7CiAgICAgICAgICAgIGNvbGxhZ2VJZHhCYXNlID0gNTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIERlZmF1bHQgbWFpbiBsaXN0OiBmaXJzdCBjZWxsIGlzIGFkZCBwaG90b3MKICAgICAgICAgICAgZmlyc3RDZWxsSHRtbCA9IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRpbGUgaXMtYWRkIiBkYXRhLWFjdGlvbj0iYWRkLXBob3RvcyIgZGF0YS1raXQtaWQ9IiR7a2l0LmlkfSIgdGl0bGU9ItCU0L7QsdCw0LLQuNGC0Ywg0YTQvtGC0L4iIGFyaWEtbGFiZWw9ItCU0L7QsdCw0LLQuNGC0Ywg0YTQvtGC0L4iPgogICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiI+JHtTVkdfSU1BR0VfQUREfTwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgICBtYWluUGhvdG9zID0ga2l0LnBob3Rvcy5zbGljZSgwLCA0KTsKICAgICAgICAgICAgY29sbGFnZVBob3RvcyA9IGtpdC5waG90b3Muc2xpY2UoNCwgOCk7CiAgICAgICAgICAgIHJlbWFpbmluZyA9IE1hdGgubWF4KDAsIGtpdC5waG90b3MubGVuZ3RoIC0gOCk7CiAgICAgICAgICAgIG1haW5JZHhCYXNlID0gMDsKICAgICAgICAgICAgY29sbGFnZUlkeEJhc2UgPSA0OwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGNvbGxhZ2VDZWxsID0gKHBob3RvLCBnbG9iYWxJbmRleCwgaXNMYXN0Q2VsbCkgPT4gewogICAgICAgICAgICBpZiAoIXBob3RvKSByZXR1cm4gYDxkaXYgY2xhc3M9ImNvbGxhZ2UtY2VsbCBpcy1lbXB0eSI+PC9kaXY+YDsKICAgICAgICAgICAgY29uc3QgbW9yZSA9IChpc0xhc3RDZWxsICYmIHJlbWFpbmluZz4wKSA/IGA8ZGl2IGNsYXNzPSJtb3JlLW92ZXJsYXkiPtCV0YnQtSAke3JlbWFpbmluZ308L2Rpdj5gIDogJyc7CiAgICAgICAgICAgIHJldHVybiBgCiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sbGFnZS1jZWxsIGlzLXBob3RvIiBkYXRhLWFjdGlvbj0ib3BlbiIgZGF0YS1raXQtaWQ9IiR7a2l0LmlkfSIgZGF0YS1pbmRleD0iJHtnbG9iYWxJbmRleH0iPgogICAgICAgICAgICAgICAgPGltZyBzcmM9IiR7cGhvdG8uc3JjfSIgYWx0PSLQpNC+0YLQviI+CiAgICAgICAgICAgICAgICAke21vcmV9CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgICB9OwoKICAgICAgICAgIGNvbnN0IFtBLEIsQyxEXSA9IFttYWluUGhvdG9zWzBdfHxudWxsLCBtYWluUGhvdG9zWzFdfHxudWxsLCBtYWluUGhvdG9zWzJdfHxudWxsLCBtYWluUGhvdG9zWzNdfHxudWxsXTsKCiAgICAgICAgICBjb25zdCBjZWxscyA9IFtdOwogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspewogICAgICAgICAgICBjZWxscy5wdXNoKGNvbGxhZ2VDZWxsKGNvbGxhZ2VQaG90b3NbaV0gfHwgbnVsbCwgY29sbGFnZUlkeEJhc2UgKyBpLCBpID09PSAzKSk7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IGFjdGlvbnNIdG1sID0gJyc7CiAgICAgICAgICBpZiAoaXNBcmNoaXZlKXsKICAgICAgICAgICAgYWN0aW9uc0h0bWwgPSBgCiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbi1idG4gaWNvbi1idG4tLWRhcmsiIGRhdGEtYWN0aW9uPSJhcmNoaXZlLWRvd25sb2FkIiBkYXRhLWtpdC1pZD0iJHtraXQuaWR9IiB0aXRsZT0i0KHQutCw0YfQsNGC0YwiIGFyaWEtbGFiZWw9ItCh0LrQsNGH0LDRgtGMIj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIj4ke1NWR19ET1dOTE9BRH08L3NwYW4+CiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbi1idG4gaWNvbi1idG4tLWRhcmsiIGRhdGEtYWN0aW9uPSJhcmNoaXZlLXJlc3RvcmUiIGRhdGEta2l0LWlkPSIke2tpdC5pZH0iIHRpdGxlPSLQktC10YDQvdGD0YLRjCIgYXJpYS1sYWJlbD0i0JLQtdGA0L3Rg9GC0Ywg0LjQtyDQsNGA0YXQuNCy0LAiPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iPiR7U1ZHX1JFU1RPUkV9PC9zcGFuPgogICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYW5nZXIiIGRhdGEtYWN0aW9uPSJhcmNoaXZlLWRlbGV0ZSIgZGF0YS1raXQtaWQ9IiR7a2l0LmlkfSIgdGl0bGU9ItCj0LTQsNC70LjRgtGMIiBhcmlhLWxhYmVsPSLQo9C00LDQu9C40YLRjCDQvdCw0LLRgdC10LPQtNCwIj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIj4ke1NWR19UUkFTSH08L3NwYW4+CiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIGA7CiAgICAgICAgICB9IGVsc2UgaWYgKGVkaXQpewogICAgICAgICAgICBhY3Rpb25zSHRtbCA9IGAKICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uLWJ0biBpY29uLWJ0bi0tZGFuZ2VyIiBkYXRhLWFjdGlvbj0iZGVsZXRlLWtpdCIgZGF0YS1raXQtaWQ9IiR7a2l0LmlkfSIgdGl0bGU9ItCSINCw0YDRhdC40LIiIGFyaWEtbGFiZWw9ItCf0LXRgNC10LzQtdGB0YLQuNGC0Ywg0LIg0LDRgNGF0LjQsiI+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiI+JHtTVkdfVFJBU0h9PC9zcGFuPgogICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICBgOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWN0aW9uc0h0bWwgPSBgCiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbi1idG4gaWNvbi1idG4tLWRhcmsiIGRhdGEtYWN0aW9uPSJkb3dubG9hZCIgZGF0YS1raXQtaWQ9IiR7a2l0LmlkfSIgdGl0bGU9ItCh0LrQsNGH0LDRgtGMIiBhcmlhLWxhYmVsPSLQodC60LDRh9Cw0YLRjCI+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiI+JHtTVkdfRE9XTkxPQUR9PC9zcGFuPgogICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYXJrIiBkYXRhLWFjdGlvbj0iZWRpdCIgZGF0YS1raXQtaWQ9IiR7a2l0LmlkfSIgdGl0bGU9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIiBhcmlhLWxhYmVsPSLQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCI+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiI+JHtTVkdfRURJVH08L3NwYW4+CiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIGA7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgdXNlZFRleHQgPSBraXQudXNlZAogICAgICAgICAgICA/IGDQmNGB0L/QvtC70YzQt9C+0LLQsNC90L46ICR7a2l0LnVzZWREYXRlIHx8IGtpdC5jcmVhdGVkQXQgfHwgZm9ybWF0RGF0ZShuZXcgRGF0ZSgpKX1gCiAgICAgICAgICAgIDogJ9CY0YHQv9C+0LvRjNC30L7QstCw0L3Qvic7CgogICAgICAgICAgY29uc3QgdXNlZENoZWNrSHRtbCA9IGlzQXJjaGl2ZQogICAgICAgICAgICA/IGA8ZGl2IGNsYXNzPSJraXQtY2hlY2siPiR7U1ZHX0NIRUNLfTwvZGl2PmAKICAgICAgICAgICAgOiBgPGRpdiBjbGFzcz0ia2l0LWNoZWNrIiBkYXRhLWFjdGlvbj0idG9nZ2xlLXVzZWQiIGRhdGEta2l0LWlkPSIke2tpdC5pZH0iPiR7U1ZHX0NIRUNLfTwvZGl2PmA7CgogICAgICAgICAgY29uc3QgZHJhZ0hhbmRsZUh0bWwgPSBpc0FyY2hpdmUKICAgICAgICAgICAgPyAnJwogICAgICAgICAgICA6IGA8ZGl2IGNsYXNzPSJraXQtZHJhZy1oYW5kbGUiIGRhdGEta2l0LWlkPSIke2tpdC5pZH0iIHRpdGxlPSLQn9C10YDQtdGC0LDRidC40YLRjCI+PC9kaXY+YDsKCiAgICAgICAgICByZXR1cm4gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJraXQtY2FyZCAke3VzZWRDbGFzc30gJHtlZGl0Q2xhc3N9IiBkYXRhLWtpdC1pZD0iJHtraXQuaWR9Ij4KICAgICAgICAgICAgICAke2RyYWdIYW5kbGVIdG1sfQogICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImtpdC10b3AiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ia2l0LXRpdGxlIiAke3RpdGxlQXR0cn0gZGF0YS1hY3Rpb249InRpdGxlIiBkYXRhLWtpdC1pZD0iJHtraXQuaWR9Ij4ke2VzY2FwZUh0bWwodGl0bGVEYXRhKX08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImtpdC1hY3Rpb25zIj4ke2FjdGlvbnNIdG1sfTwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJraXQtZGl2aWRlciI+PC9kaXY+CgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImtpdC11c2VkLXJvdyI+CiAgICAgICAgICAgICAgICAke3VzZWRDaGVja0h0bWx9CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJraXQtdXNlZC10ZXh0Ij4ke3VzZWRUZXh0fTwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJraXQtZ3JpZCI+CiAgICAgICAgICAgICAgICAke2ZpcnN0Q2VsbEh0bWx9CiAgICAgICAgICAgICAgICAke3Bob3RvVGlsZShBLCBtYWluSWR4QmFzZSswKX0KICAgICAgICAgICAgICAgICR7cGhvdG9UaWxlKEIsIG1haW5JZHhCYXNlKzEpfQogICAgICAgICAgICAgICAgJHtwaG90b1RpbGUoQywgbWFpbklkeEJhc2UrMil9CiAgICAgICAgICAgICAgICAke3Bob3RvVGlsZShELCBtYWluSWR4QmFzZSszKX0KCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0aWxlIGlzLWNvbGxhZ2UiPgogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2xsYWdlLWdyaWQiPiR7Y2VsbHMuam9pbignJyl9PC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ia2l0LWZvb3RlciI+CiAgICAgICAgICAgICAgICA8ZGl2PtCS0YHQtdCz0L4g0YTQvtGC0L46ICR7dG90YWx9PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2PtCX0LDQs9GA0YPQttC10L3QvjogJHt1cGxvYWRlZH08L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICBgOwogICAgICAgIH0pLmpvaW4oJycpOwoKICAgICAgICBpZiAoaXNBcmNoaXZlICYmIGxpc3QubGVuZ3RoID09PSAwKXsKICAgICAgICAgIGhvc3RFbC5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0iY29sb3I6IHZhcigtLXRleHQtdGVydGlhcnkpOyBmb250LXNpemU6MTRweDsgcGFkZGluZzogNnB4IDJweDsiPtCSINCw0YDRhdC40LLQtSDQv9C+0LrQsCDQvdC40YfQtdCz0L4g0L3QtdGCPC9kaXY+YDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJlbmRlckxpc3Qoa2l0cywga2l0c0VsLCAnbWFpbicpOwogICAgICByZW5kZXJMaXN0KGFyY2hpdmVkS2l0cywgYXJjaGl2ZUtpdHNFbCwgJ2FyY2hpdmUnKTsKICAgIH0KCgogICAgLyogPT09PT0gRVZFTlRTID09PT09ICovCgogICAgYWRkS2l0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIGtpdHMucHVzaChjcmVhdGVLaXQoKSk7CiAgICAgIHJlbmRlcigpOwogICAgfSk7CgogICAgLy8gRGVsZWdhdGVkIGNsaWNrIGluc2lkZSBraXRzCiAgICBraXRzRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PnsKICAgICAgY29uc3QgYWN0aW9uRWwgPSBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS1hY3Rpb25dJyk7CiAgICAgIGlmICghYWN0aW9uRWwpIHJldHVybjsKICAgICAgY29uc3QgYWN0aW9uID0gYWN0aW9uRWwuZGF0YXNldC5hY3Rpb247CiAgICAgIGNvbnN0IGtpdElkID0gYWN0aW9uRWwuZGF0YXNldC5raXRJZDsKCiAgICAgIGlmIChhY3Rpb24gPT09ICdlZGl0Jyl7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBzZXRPbmx5T25lRWRpdChraXRJZCk7CiAgICAgICAgc2V0VGltZW91dCgoKT0+ewogICAgICAgICAgY29uc3QgdGl0bGVFbCA9IGtpdHNFbC5xdWVyeVNlbGVjdG9yKGAua2l0LWNhcmRbZGF0YS1raXQtaWQ9IiR7a2l0SWR9Il0gLmtpdC10aXRsZWApOwogICAgICAgICAgaWYgKHRpdGxlRWwpewogICAgICAgICAgICB0aXRsZUVsLmZvY3VzKCk7CiAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsKICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHRpdGxlRWwpOwogICAgICAgICAgICByYW5nZS5jb2xsYXBzZShmYWxzZSk7CiAgICAgICAgICAgIGNvbnN0IHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKICAgICAgICAgICAgc2VsLnJlbW92ZUFsbFJhbmdlcygpOwogICAgICAgICAgICBzZWwuYWRkUmFuZ2UocmFuZ2UpOwogICAgICAgICAgfQogICAgICAgIH0sMCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYWN0aW9uID09PSAnZGVsZXRlLWtpdCcpewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgaWYgKCFjb25maXJtKCfQn9C10YDQtdC80LXRgdGC0LjRgtGMINGN0YLQvtGCINC60L7QvdGC0LXQvdGCINCyINCw0YDRhdC40LI/JykpIHJldHVybjsKICAgICAgICBjb25zdCBpZHggPSBraXRzLmZpbmRJbmRleChrID0+IGsuaWQgPT09IGtpdElkKTsKICAgICAgICBpZiAoaWR4ICE9PSAtMSl7CiAgICAgICAgICBjb25zdCBba2l0XSA9IGtpdHMuc3BsaWNlKGlkeCwgMSk7CiAgICAgICAgICBraXQuYXJjaGl2ZWRBdCA9IGZvcm1hdERhdGUobmV3IERhdGUoKSk7CiAgICAgICAgICBhcmNoaXZlZEtpdHMudW5zaGlmdChraXQpOwogICAgICAgIH0KICAgICAgICBpZiAoa2l0cy5sZW5ndGggPT09IDApIGtpdHMgPSBbY3JlYXRlS2l0KCldOwogICAgICAgIGlmIChhY3RpdmVFZGl0S2l0SWQgPT09IGtpdElkKSBhY3RpdmVFZGl0S2l0SWQgPSBudWxsOwogICAgICAgIHJlbmRlcigpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGFjdGlvbiA9PT0gJ2Rvd25sb2FkJyl7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBkb3dubG9hZEtpdFppcChraXRJZCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYWN0aW9uID09PSAndG9nZ2xlLXVzZWQnKXsKICAgICAgICAvLyBUb2dnbGUgInVzZWQiIG9ubHkgaW4gZWRpdCBtb2RlIGZvciB0aGlzIGtpdAogICAgICAgIGlmIChhY3RpdmVFZGl0S2l0SWQgIT09IGtpdElkKSByZXR1cm47CiAgICAgICAgY29uc3Qga2l0ID0ga2l0cy5maW5kKGs9PmsuaWQ9PT1raXRJZCk7CiAgICAgICAgaWYgKCFraXQpIHJldHVybjsKICAgICAgICBraXQudXNlZCA9ICFraXQudXNlZDsKICAgICAgICBpZiAoa2l0LnVzZWQgJiYgIWtpdC51c2VkRGF0ZSl7CiAgICAgICAgICBraXQudXNlZERhdGUgPSBmb3JtYXREYXRlKG5ldyBEYXRlKCkpOwogICAgICAgIH0KICAgICAgICByZW5kZXIoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChhY3Rpb24gPT09ICdhZGQtcGhvdG9zJyl7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBmaWxlSW5wdXQuZGF0YXNldC5raXRJZCA9IGtpdElkOwogICAgICAgIGZpbGVJbnB1dC5jbGljaygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGFjdGlvbiA9PT0gJ29wZW4nKXsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoYWN0aW9uRWwuZGF0YXNldC5pbmRleCwxMCk7CiAgICAgICAgb3BlblZpZXdlcihraXRJZCwgaW5kZXgpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSk7CgoKICAgIC8vIERlbGVnYXRlZCBjbGljayBpbnNpZGUgYXJjaGl2ZQogICAgYXJjaGl2ZUtpdHNFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+ewogICAgICBjb25zdCBhY3Rpb25FbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLWFjdGlvbl0nKTsKICAgICAgaWYgKCFhY3Rpb25FbCkgcmV0dXJuOwogICAgICBjb25zdCBhY3Rpb24gPSBhY3Rpb25FbC5kYXRhc2V0LmFjdGlvbjsKICAgICAgY29uc3Qga2l0SWQgPSBhY3Rpb25FbC5kYXRhc2V0LmtpdElkOwoKICAgICAgaWYgKGFjdGlvbiA9PT0gJ2FyY2hpdmUtZG93bmxvYWQnKXsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGRvd25sb2FkS2l0WmlwKGtpdElkKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChhY3Rpb24gPT09ICdhcmNoaXZlLXJlc3RvcmUnKXsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGNvbnN0IGlkeCA9IGFyY2hpdmVkS2l0cy5maW5kSW5kZXgoayA9PiBrLmlkID09PSBraXRJZCk7CiAgICAgICAgaWYgKGlkeCAhPT0gLTEpewogICAgICAgICAgY29uc3QgW2tpdF0gPSBhcmNoaXZlZEtpdHMuc3BsaWNlKGlkeCwgMSk7CiAgICAgICAgICBraXRzLnVuc2hpZnQoa2l0KTsKICAgICAgICB9CiAgICAgICAgcmVuZGVyKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYWN0aW9uID09PSAnYXJjaGl2ZS1kZWxldGUnKXsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGlmICghY29uZmlybSgn0KPQtNCw0LvQuNGC0Ywg0Y3RgtC+0YIg0LrQvtC90YLQtdC90YIg0L3QsNCy0YHQtdCz0LTQsD8g0K3RgtC+INC00LXQudGB0YLQstC40LUg0L3QtdC70YzQt9GPINC+0YLQvNC10L3QuNGC0YwuJykpIHJldHVybjsKICAgICAgICBhcmNoaXZlZEtpdHMgPSBhcmNoaXZlZEtpdHMuZmlsdGVyKGsgPT4gay5pZCAhPT0ga2l0SWQpOwogICAgICAgIHJlbmRlcigpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGFjdGlvbiA9PT0gJ29wZW4nKXsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoYWN0aW9uRWwuZGF0YXNldC5pbmRleCwxMCk7CiAgICAgICAgb3BlblZpZXdlcihraXRJZCwgaW5kZXgpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSk7CgogICAgLyogPT09PT0gRFJBRyAmIERST1AgVE8gQUREIFBIT1RPUyA9PT09PSAqLwogICAgZnVuY3Rpb24gZ2V0QWRkVGlsZUZyb21FdmVudFRhcmdldCh0YXJnZXQpewogICAgICBjb25zdCB0aWxlID0gdGFyZ2V0Py5jbG9zZXN0Py4oJy50aWxlLmlzLWFkZFtkYXRhLWFjdGlvbj0iYWRkLXBob3RvcyJdJyk7CiAgICAgIHJldHVybiB0aWxlIHx8IG51bGw7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QWRkVGlsZURyYWdTdGF0ZSh0aWxlLCBvbil7CiAgICAgIGlmICghdGlsZSkgcmV0dXJuOwogICAgICB0aWxlLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWRyYWdvdmVyJywgISFvbik7CiAgICB9CgogICAga2l0c0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgKGUpPT57CiAgICAgIGNvbnN0IHRpbGUgPSBnZXRBZGRUaWxlRnJvbUV2ZW50VGFyZ2V0KGUudGFyZ2V0KTsKICAgICAgaWYgKCF0aWxlKSByZXR1cm47CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgc2V0QWRkVGlsZURyYWdTdGF0ZSh0aWxlLCB0cnVlKTsKICAgIH0pOwoKICAgIGtpdHNFbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCAoZSk9PnsKICAgICAgY29uc3QgdGlsZSA9IGdldEFkZFRpbGVGcm9tRXZlbnRUYXJnZXQoZS50YXJnZXQpOwogICAgICBpZiAoIXRpbGUpIHJldHVybjsKICAgICAgaWYgKHRpbGUuY29udGFpbnMoZS5yZWxhdGVkVGFyZ2V0KSkgcmV0dXJuOwogICAgICBzZXRBZGRUaWxlRHJhZ1N0YXRlKHRpbGUsIGZhbHNlKTsKICAgIH0pOwoKICAgIGtpdHNFbC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgYXN5bmMgKGUpPT57CiAgICAgIGNvbnN0IHRpbGUgPSBnZXRBZGRUaWxlRnJvbUV2ZW50VGFyZ2V0KGUudGFyZ2V0KTsKICAgICAgaWYgKCF0aWxlKSByZXR1cm47CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgc2V0QWRkVGlsZURyYWdTdGF0ZSh0aWxlLCBmYWxzZSk7CiAgICAgIGNvbnN0IGtpdElkID0gdGlsZS5kYXRhc2V0LmtpdElkOwogICAgICBjb25zdCBmaWxlcyA9IEFycmF5LmZyb20oZS5kYXRhVHJhbnNmZXI/LmZpbGVzIHx8IFtdKTsKICAgICAgaWYgKCFraXRJZCB8fCAhZmlsZXMubGVuZ3RoKSByZXR1cm47CiAgICAgIGF3YWl0IGFkZEZpbGVzVG9LaXQoa2l0SWQsIGZpbGVzKTsKICAgIH0pOwoKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCAoKT0+ewogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGlsZS5pcy1hZGQuaXMtZHJhZ292ZXInKS5mb3JFYWNoKGVsPT5lbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnb3ZlcicpKTsKICAgIH0pOwoKCiAgICAvLyBUaXRsZSBlZGl0aW5nOiByZW1lbWJlciBsYXN0IGZpdHRpbmcgdmFsdWUKICAgIGtpdHNFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgKGUpPT57CiAgICAgIGNvbnN0IHRpdGxlRWwgPSBlLnRhcmdldC5jbG9zZXN0KCcua2l0LXRpdGxlW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdJyk7CiAgICAgIGlmICghdGl0bGVFbCkgcmV0dXJuOwogICAgICB0aXRsZUVsLmRhdGFzZXQucHJldlRpdGxlID0gdGl0bGVFbC50ZXh0Q29udGVudCB8fCAnJzsKICAgIH0pOwoKICAgIC8vIFRpdGxlIGVkaXRpbmc6IHN5bmMgb24gaW5wdXQsIHN0b3AgdHlwaW5nIHdoZW4gZWxsaXBzaXMgcmVhY2hlZAogICAga2l0c0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpPT57CiAgICAgIGNvbnN0IHRpdGxlRWwgPSBlLnRhcmdldC5jbG9zZXN0KCcua2l0LXRpdGxlW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdJyk7CiAgICAgIGlmICghdGl0bGVFbCkgcmV0dXJuOwoKICAgICAgLy8gTm9ybWFsaXplIGxpbmUgYnJlYWtzIHRvIHNwYWNlcwogICAgICBjb25zdCBub3JtYWxpemVkID0gKHRpdGxlRWwudGV4dENvbnRlbnQgfHwgJycpLnJlcGxhY2UoL1tcclxuXSsvZywgJyAnKTsKICAgICAgaWYgKG5vcm1hbGl6ZWQgIT09IHRpdGxlRWwudGV4dENvbnRlbnQpIHRpdGxlRWwudGV4dENvbnRlbnQgPSBub3JtYWxpemVkOwoKICAgICAgLy8gSWYgb3ZlcmZsb3cgLT4gcmV2ZXJ0IHRvIGxhc3QgZml0dGluZyB2YWx1ZSAoZWZmZWN0aXZlbHkgYmxvY2tzIGZ1cnRoZXIgdHlwaW5nKQogICAgICBjb25zdCBwcmV2ID0gdGl0bGVFbC5kYXRhc2V0LnByZXZUaXRsZSA/PyAnJzsKICAgICAgaWYgKHRpdGxlRWwuc2Nyb2xsV2lkdGggPiB0aXRsZUVsLmNsaWVudFdpZHRoICsgMSl7CiAgICAgICAgdGl0bGVFbC50ZXh0Q29udGVudCA9IHByZXY7CgogICAgICAgIC8vIGNhcmV0IHRvIGVuZAogICAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsKICAgICAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHModGl0bGVFbCk7CiAgICAgICAgcmFuZ2UuY29sbGFwc2UoZmFsc2UpOwogICAgICAgIGNvbnN0IHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKICAgICAgICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7CiAgICAgICAgc2VsLmFkZFJhbmdlKHJhbmdlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRpdGxlRWwuZGF0YXNldC5wcmV2VGl0bGUgPSB0aXRsZUVsLnRleHRDb250ZW50OwoKICAgICAgY29uc3Qga2l0SWQgPSB0aXRsZUVsLmRhdGFzZXQua2l0SWQ7CiAgICAgIGNvbnN0IGtpdCA9IGtpdHMuZmluZChrPT5rLmlkPT09a2l0SWQpOwogICAgICBpZiAoIWtpdCkgcmV0dXJuOwogICAgICBraXQudGl0bGUgPSB0aXRsZUVsLnRleHRDb250ZW50LnRyaW0oKSB8fCAn0J3QvtCy0YvQuSDQutC+0L3RgtC10L3Rgic7CiAgICB9KTsKCgogICAgCiAgICAvLyBUaXRsZSBlZGl0aW5nOiBwcmV2ZW50IG5ldyBsaW5lczsgRW50ZXIgZmluaXNoZXMgZWRpdGluZwogICAga2l0c0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSk9PnsKICAgICAgY29uc3QgdGl0bGVFbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5raXQtdGl0bGVbY29udGVudGVkaXRhYmxlPSJ0cnVlIl0nKTsKICAgICAgaWYgKCF0aXRsZUVsKSByZXR1cm47CgogICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAvLyBmaW5hbGl6ZSB0aXRsZSB2YWx1ZQogICAgICAgIHRpdGxlRWwuYmx1cigpOwogICAgICAgIGV4aXRFZGl0KCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9KTsKCiAgICAvLyBQYXN0ZSBhcyBwbGFpbiB0ZXh0IChubyBsaW5lIGJyZWFrcykgaW50byB0aXRsZQogICAga2l0c0VsLmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgKGUpPT57CiAgICAgIGNvbnN0IHRpdGxlRWwgPSBlLnRhcmdldC5jbG9zZXN0KCcua2l0LXRpdGxlW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdJyk7CiAgICAgIGlmICghdGl0bGVFbCkgcmV0dXJuOwoKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBjb25zdCB0ZXh0ID0gKGUuY2xpcGJvYXJkRGF0YSB8fCB3aW5kb3cuY2xpcGJvYXJkRGF0YSkuZ2V0RGF0YSgndGV4dCcpIHx8ICcnOwogICAgICBjb25zdCBjbGVhbiA9IHRleHQucmVwbGFjZSgvW1xyXG5dKy9nLCAnICcpLnRyaW0oKTsKICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2luc2VydFRleHQnLCBmYWxzZSwgY2xlYW4pOwogICAgfSk7CgovLyBDbGljayBvdXRzaWRlOiBleGl0IGVkaXQKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57CiAgICAgIGNvbnN0IGNsaWNrZWRJbnNpZGVLaXQgPSAhIWUudGFyZ2V0LmNsb3Nlc3QoJy5raXQtY2FyZCcpOwogICAgICBjb25zdCBjbGlja2VkSW5zaWRlVmlld2VyID0gISFlLnRhcmdldC5jbG9zZXN0KCcudmlld2VyJyk7CiAgICAgIGlmICghY2xpY2tlZEluc2lkZUtpdCAmJiAhY2xpY2tlZEluc2lkZVZpZXdlciAmJiBhY3RpdmVFZGl0S2l0SWQpewogICAgICAgIHNldFRpbWVvdXQoKCk9PmV4aXRFZGl0KCksMCk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIEV4aXQgZWRpdCBpbW1lZGlhdGVseSBpZiBjbGljayBhbm90aGVyIGtpdCBhcmVhCiAgICBraXRzRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpPT57CiAgICAgIGNvbnN0IGtpdENhcmQgPSBlLnRhcmdldC5jbG9zZXN0KCcua2l0LWNhcmQnKTsKICAgICAgaWYgKCFraXRDYXJkKSByZXR1cm47CiAgICAgIGNvbnN0IGtpdElkID0ga2l0Q2FyZC5kYXRhc2V0LmtpdElkOwogICAgICBpZiAoYWN0aXZlRWRpdEtpdElkICYmIGFjdGl2ZUVkaXRLaXRJZCAhPT0ga2l0SWQpewogICAgICAgIGV4aXRFZGl0KCk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIEFkZCBpbWFnZSBmaWxlcyB0byBraXQgKHVzZWQgYnkgZmlsZSBpbnB1dCBhbmQgZHJhZyZkcm9wKQogICAgYXN5bmMgZnVuY3Rpb24gYWRkRmlsZXNUb0tpdChraXRJZCwgZmlsZXMpewogICAgICBjb25zdCBraXQgPSBraXRzLmZpbmQoaz0+ay5pZD09PWtpdElkKTsKICAgICAgaWYgKCFraXQpIHJldHVybjsKICAgICAgY29uc3QgaW1nRmlsZXMgPSAoZmlsZXN8fFtdKS5maWx0ZXIoZj0+ZiAmJiBmLnR5cGUgJiYgZi50eXBlLnN0YXJ0c1dpdGgoJ2ltYWdlLycpKTsKICAgICAgaWYgKCFpbWdGaWxlcy5sZW5ndGgpIHJldHVybjsKCiAgICAgIGNvbnN0IHRvRGF0YVVybCA9IChmaWxlKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+ewogICAgICAgIGNvbnN0IHIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgIHIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyLnJlc3VsdCk7CiAgICAgICAgci5vbmVycm9yID0gcmVqZWN0OwogICAgICAgIHIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgfSk7CgogICAgICBmb3IgKGNvbnN0IGYgb2YgaW1nRmlsZXMpewogICAgICAgIHRyeXsKICAgICAgICAgIGNvbnN0IHNyYyA9IGF3YWl0IHRvRGF0YVVybChmKTsKICAgICAgICAgIGtpdC5waG90b3MucHVzaCh7IGlkOiBTdHJpbmcoRGF0ZS5ub3coKSkgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zbGljZSgyKSwgc3JjIH0pOwogICAgICAgIH1jYXRjaChlcnIpe30KICAgICAgfQogICAgICBraXQuY3JlYXRlZEF0ID0gZm9ybWF0RGF0ZVRpbWUobmV3IERhdGUoKSk7CiAgICAgIHJlbmRlcigpOwogICAgfQoKICAgIC8vIEZpbGUgaW5wdXQgbG9hZAogICAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGFzeW5jIChlKT0+ewogICAgICBjb25zdCBmaWxlcyA9IEFycmF5LmZyb20oZS50YXJnZXQuZmlsZXMgfHwgW10pOwogICAgICBjb25zdCBraXRJZCA9IGZpbGVJbnB1dC5kYXRhc2V0LmtpdElkOwogICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJzsKICAgICAgaWYgKCFmaWxlcy5sZW5ndGggfHwgIWtpdElkKSByZXR1cm47CiAgICAgIGF3YWl0IGFkZEZpbGVzVG9LaXQoa2l0SWQsIGZpbGVzKTsKICAgIH0pOwoKLyogPT09PT0gVklFV0VSID09PT09ICovCiAgICBsZXQgd2hlZWxMb2NrID0gZmFsc2U7CiAgICBmdW5jdGlvbiBvblN0YWdlV2hlZWwoZSl7CiAgICAgIGlmICghdmlld2VyQmFja2Ryb3AuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJykpIHJldHVybjsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZiAod2hlZWxMb2NrKSByZXR1cm47CiAgICAgIHdoZWVsTG9jayA9IHRydWU7CiAgICAgIGNvbnN0IGRpciA9IGUuZGVsdGFZID4gMCA/IDEgOiAtMTsKICAgICAgc3RlcFZpZXdlcihkaXIpOwogICAgICBzZXRUaW1lb3V0KCgpPT57IHdoZWVsTG9jayA9IGZhbHNlOyB9LCA0NTApOwogICAgfQoKICAgIAogICAgZnVuY3Rpb24gbGF5b3V0Vmlld2VyTWFpbkluc2V0cygpewogICAgICAvLyBFbnN1cmUgdGhlIG1haW4gcGhvdG8gZnJhbWUga2VlcHMgMjBweCBnYXAgZnJvbSBjb3VudGVyIChsZWZ0KSBhbmQgY2xvc2UgYnV0dG9uIChyaWdodCkgb24gYW55IHNjcmVlbi4KICAgICAgdHJ5ewogICAgICAgIGNvbnN0IHN0YWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZXdlci1zdGFnZScpOwogICAgICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhZ2VNYWluJyk7CiAgICAgICAgY29uc3QgY291bnRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3ZXJDb3VudGVyJyk7CiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld2VyQ2xvc2UnKTsKICAgICAgICBpZighc3RhZ2UgfHwgIW1haW4pIHJldHVybjsKCiAgICAgICAgY29uc3QgcyA9IHN0YWdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGxldCBsZWZ0SW5zZXQgPSAyMDsgICAvLyBtaW5pbWFsIGluc2V0IGZyb20gc3RhZ2UgZWRnZSBpZiBjb3VudGVyIGlzIG1pc3NpbmcKICAgICAgICBsZXQgcmlnaHRJbnNldCA9IDIwOyAgLy8gbWluaW1hbCBpbnNldCBmcm9tIHN0YWdlIGVkZ2UgaWYgY2xvc2UgaXMgbWlzc2luZwoKICAgICAgICBpZihjb3VudGVyKXsKICAgICAgICAgIGNvbnN0IGMgPSBjb3VudGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgLy8gcGhvdG8gbGVmdCBzaG91bGQgYmUgY291bnRlcidzIHJpZ2h0ICsgMjAKICAgICAgICAgIGxlZnRJbnNldCA9IE1hdGgubWF4KGxlZnRJbnNldCwgKGMucmlnaHQgLSBzLmxlZnQpICsgMjApOwogICAgICAgIH0KCiAgICAgICAgaWYoY2xvc2VCdG4pewogICAgICAgICAgY29uc3QgYiA9IGNsb3NlQnRuLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgLy8gcGhvdG8gcmlnaHQgc2hvdWxkIGJlIGNsb3NlJ3MgbGVmdCAtIDIwICA9PiByaWdodEluc2V0ID0gc3RhZ2VSaWdodCAtIChjbG9zZUxlZnQgLSAyMCkKICAgICAgICAgIHJpZ2h0SW5zZXQgPSBNYXRoLm1heChyaWdodEluc2V0LCAocy5yaWdodCAtIGIubGVmdCkgKyAyMCk7CiAgICAgICAgfQoKICAgICAgICBtYWluLnN0eWxlLnNldFByb3BlcnR5KCctLW1haW4tbGVmdCcsIGxlZnRJbnNldCArICdweCcpOwogICAgICAgIG1haW4uc3R5bGUuc2V0UHJvcGVydHkoJy0tbWFpbi1yaWdodCcsIHJpZ2h0SW5zZXQgKyAncHgnKTsKICAgICAgfWNhdGNoKGUpe30KICAgIH0KCmZ1bmN0aW9uIG9wZW5WaWV3ZXIoa2l0SWQsIGluZGV4KXsKICAgICAgY29uc3Qga2l0ID0gZ2V0S2l0QnlJZChraXRJZCk7CiAgICAgIGlmICgha2l0IHx8ICFraXQucGhvdG9zLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgdmlld2VyS2l0SWQgPSBraXRJZDsKICAgICAgdmlld2VySW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihpbmRleCwga2l0LnBob3Rvcy5sZW5ndGgtMSkpOwogICAgICB2aWV3ZXJDYW5EZWxldGUgPSBpc0VkaXQoa2l0SWQpICYmIGlzS2l0SW5NYWluKGtpdElkKTsgLy8g0YTQuNC60YHQuNGA0YPQtdC8INGA0LXQttC40Lwg0LIg0LzQvtC80LXQvdGCINC+0YLQutGA0YvRgtC40Y8KCiAgICAgIHJlbmRlclZpZXdlcigpOwogICAgICB2aWV3ZXJCYWNrZHJvcC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7CiAgICAgIGxheW91dFZpZXdlck1haW5JbnNldHMoKTsKICAgICAgLy8gY291bnRlciB0ZXh0L21ldHJpY3MgY2FuIGNoYW5nZSBhZnRlciByZW5kZXI7IHJlY2FsYyBvbiBuZXh0IGZyYW1lcwogICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCk9PmxheW91dFZpZXdlck1haW5JbnNldHMoKSk7CiAgICAgIHNldFRpbWVvdXQoKCk9PmxheW91dFZpZXdlck1haW5JbnNldHMoKSwgNTApOwogICAgICAvLyBtYWtlIEVzYyBoYW5kbGluZyBtb3JlIHJlbGlhYmxlCiAgICAgIHRyeXsgdmlld2VyQmFja2Ryb3AuZm9jdXMoKTsgfWNhdGNoKGUpe30KICAgICAgdmlld2VyQmFja2Ryb3Auc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsJ2ZhbHNlJyk7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJzsKICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCd2aWV3ZXItb3BlbicpOwogICAgICBzeW5jUmFpbEJ1dHRvbnMoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZVZpZXdlcigpewogICAgICB2aWV3ZXJCYWNrZHJvcC5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7CiAgICAgIHZpZXdlckJhY2tkcm9wLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCd0cnVlJyk7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnJzsKICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCd2aWV3ZXItb3BlbicpOwogICAgICB2aWV3ZXJLaXRJZCA9IG51bGw7CiAgICAgIHZpZXdlckluZGV4ID0gMDsKICAgICAgdmlld2VyQ2FuRGVsZXRlID0gZmFsc2U7CiAgICAgIHZpZXdlclRodW1icy5pbm5lckhUTUwgPSAnJzsKICAgICAgdHJ5eyBkZWxldGUgdmlld2VyVGh1bWJzLmRhdGFzZXQua2l0SWQ7IH1jYXRjaChlKXt9CiAgICAgIGlmICh0eXBlb2YgdGh1bWJzU2Nyb2xsVGltZXIgIT09ICd1bmRlZmluZWQnICYmIHRodW1ic1Njcm9sbFRpbWVyKXsgY2xlYXJUaW1lb3V0KHRodW1ic1Njcm9sbFRpbWVyKTsgdGh1bWJzU2Nyb2xsVGltZXIgPSBudWxsOyB9CiAgICAgIHZpZXdlckltZy5zcmMgPSAnJzsKICAgIH0KCiAgICBsZXQgdGh1bWJzU2Nyb2xsVGltZXIgPSBudWxsOwoKZnVuY3Rpb24gYnVpbGRWaWV3ZXJUaHVtYnMocGhvdG9zKXsKICB2aWV3ZXJUaHVtYnMuaW5uZXJIVE1MID0gcGhvdG9zLm1hcCgocCwgaSk9PmAKICAgIDxkaXYgY2xhc3M9InRodW1iIiBkYXRhLWluZGV4PSIke2l9Ij4KICAgICAgPGltZyBzcmM9IiR7cC5zcmN9IiBhbHQ9ItCc0LjQvdC40LDRgtGO0YDQsCI+CiAgICA8L2Rpdj4KICBgKS5qb2luKCcnKTsKICB2aWV3ZXJUaHVtYnMuZGF0YXNldC5raXRJZCA9IHZpZXdlcktpdElkIHx8ICcnOwp9CgpmdW5jdGlvbiBzZXRBY3RpdmVUaHVtYihpZHgpewogIGNvbnN0IHByZXYgPSB2aWV3ZXJUaHVtYnMucXVlcnlTZWxlY3RvcignLnRodW1iLmFjdGl2ZScpOwogIGlmIChwcmV2KSBwcmV2LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwoKICBjb25zdCBuZXh0ID0gdmlld2VyVGh1bWJzLnF1ZXJ5U2VsZWN0b3IoYC50aHVtYltkYXRhLWluZGV4PSIke2lkeH0iXWApOwogIGlmIChuZXh0KSBuZXh0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwoKICBjbGVhclRpbWVvdXQodGh1bWJzU2Nyb2xsVGltZXIpOwogIHRodW1ic1Njcm9sbFRpbWVyID0gc2V0VGltZW91dCgoKT0+ewogICAgY29uc3QgYWN0aXZlID0gdmlld2VyVGh1bWJzLnF1ZXJ5U2VsZWN0b3IoJy50aHVtYi5hY3RpdmUnKTsKICAgIGlmIChhY3RpdmUpIGFjdGl2ZS5zY3JvbGxJbnRvVmlldyh7YmxvY2s6J25lYXJlc3QnLCBiZWhhdmlvcjonc21vb3RoJ30pOwogICAgc3luY1JhaWxCdXR0b25zKCk7CiAgfSwgMTQwKTsKfQoKZnVuY3Rpb24gcmVuZGVyVmlld2VyKCl7CiAgY29uc3Qga2l0ID0gZ2V0S2l0QnlJZCh2aWV3ZXJLaXRJZCk7CiAgaWYgKCFraXQpIHJldHVybjsKICBjb25zdCBwaG90b3MgPSBraXQucGhvdG9zOwogIGlmICghcGhvdG9zLmxlbmd0aCl7IGNsb3NlVmlld2VyKCk7IHJldHVybjsgfQoKICB2aWV3ZXJJbmRleCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHZpZXdlckluZGV4LCBwaG90b3MubGVuZ3RoLTEpKTsKICB2aWV3ZXJJbWcuc3JjID0gcGhvdG9zW3ZpZXdlckluZGV4XS5zcmM7CiAgdmlld2VyQ291bnRlci50ZXh0Q29udGVudCA9IGAke3ZpZXdlckluZGV4KzF9LyR7cGhvdG9zLmxlbmd0aH1gOwogIGxheW91dFZpZXdlck1haW5JbnNldHMoKTsKICB2aWV3ZXJEZWxldGVCdG4uc3R5bGUuZGlzcGxheSA9IHZpZXdlckNhbkRlbGV0ZSA/ICdmbGV4JyA6ICdub25lJzsKCiAgLy8gQnVpbGQgdGh1bWJzIG9ubHkgd2hlbiBvcGVuaW5nIHZpZXdlciAvIHN3aXRjaGluZyBraXQgLyBwaG90byBjb3VudCBjaGFuZ2VkCiAgaWYgKHZpZXdlclRodW1icy5kYXRhc2V0LmtpdElkICE9PSBTdHJpbmcodmlld2VyS2l0SWQpIHx8IHZpZXdlclRodW1icy5jaGlsZHJlbi5sZW5ndGggIT09IHBob3Rvcy5sZW5ndGgpewogICAgYnVpbGRWaWV3ZXJUaHVtYnMocGhvdG9zKTsKICB9CgogIHNldEFjdGl2ZVRodW1iKHZpZXdlckluZGV4KTsKfQoKZnVuY3Rpb24gc3RlcFZpZXdlcihkZWx0YSl7CiAgICAgIGNvbnN0IGtpdCA9IGdldEtpdEJ5SWQodmlld2VyS2l0SWQpOwogICAgICBpZiAoIWtpdCkgcmV0dXJuOwoKICAgICAgY29uc3QgbGVuID0ga2l0LnBob3Rvcy5sZW5ndGg7CiAgICAgIGlmIChsZW4gPD0gMSkgcmV0dXJuOwoKICAgICAgdmlld2VySW5kZXggPSAodmlld2VySW5kZXggKyBkZWx0YSArIGxlbikgJSBsZW47CiAgICAgIHJlbmRlclZpZXdlcigpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bmNSYWlsQnV0dG9ucygpewogICAgICBjb25zdCBlbCA9IHZpZXdlclRodW1iczsKICAgICAgLy8gc21hbGwgdG9sZXJhbmNlCiAgICAgIGNvbnN0IGF0VG9wID0gZWwuc2Nyb2xsVG9wIDw9IDI7CiAgICAgIGNvbnN0IGF0Qm90dG9tID0gKGVsLnNjcm9sbFRvcCArIGVsLmNsaWVudEhlaWdodCkgPj0gKGVsLnNjcm9sbEhlaWdodCAtIDIpOwogICAgICByYWlsVXAuZGlzYWJsZWQgPSBhdFRvcDsKICAgICAgcmFpbERvd24uZGlzYWJsZWQgPSBhdEJvdHRvbTsKICAgIH0KCiAgICB2aWV3ZXJUaHVtYnMuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc3luY1JhaWxCdXR0b25zKTsKCiAgICByYWlsVXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PnsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgdmlld2VyVGh1bWJzLnNjcm9sbEJ5KHt0b3A6IC0yMjAsIGJlaGF2aW9yOiAnc21vb3RoJ30pOwogICAgfSk7CiAgICByYWlsRG93bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+ewogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB2aWV3ZXJUaHVtYnMuc2Nyb2xsQnkoe3RvcDogMjIwLCBiZWhhdmlvcjogJ3Ntb290aCd9KTsKICAgIH0pOwoKICAgIHZpZXdlckNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57IGUuc3RvcFByb3BhZ2F0aW9uKCk7IGNsb3NlVmlld2VyKCk7IH0pOwoKICAgIHZpZXdlckJhY2tkcm9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57CiAgICAgIC8vINC60LvQuNC6INC/0L4g0YHQtdGA0L7QvNGDINGE0L7QvdGDINC30LDQutGA0YvQstCw0LXRggogICAgICBpZiAoZS50YXJnZXQgPT09IHZpZXdlckJhY2tkcm9wKSBjbG9zZVZpZXdlcigpOwogICAgfSk7CmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSk9PnsKICAgICAgaWYgKCF2aWV3ZXJCYWNrZHJvcC5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKSkgcmV0dXJuOwogICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKXsgZS5wcmV2ZW50RGVmYXVsdCgpOyBjbG9zZVZpZXdlcigpOyB9CiAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93TGVmdCcpeyBlLnByZXZlbnREZWZhdWx0KCk7IHN0ZXBWaWV3ZXIoLTEpOyB9CiAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93UmlnaHQnKXsgZS5wcmV2ZW50RGVmYXVsdCgpOyBzdGVwVmlld2VyKDEpOyB9CiAgICAKICAgICAgaWYgKGUua2V5ID09PSAnQXJyb3dVcCcpeyBlLnByZXZlbnREZWZhdWx0KCk7IHN0ZXBWaWV3ZXIoLTEpOyB9CiAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpeyBlLnByZXZlbnREZWZhdWx0KCk7IHN0ZXBWaWV3ZXIoMSk7IH0KfSk7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpPT57CiAgICAgIGlmICghdmlld2VyQmFja2Ryb3AuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJykpIHJldHVybjsKICAgICAgbGF5b3V0Vmlld2VyTWFpbkluc2V0cygpOwogICAgICAvLyBjb3VudGVyIHRleHQvbWV0cmljcyBjYW4gY2hhbmdlIGFmdGVyIHJlbmRlcjsgcmVjYWxjIG9uIG5leHQgZnJhbWVzCiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKT0+bGF5b3V0Vmlld2VyTWFpbkluc2V0cygpKTsKICAgICAgc2V0VGltZW91dCgoKT0+bGF5b3V0Vmlld2VyTWFpbkluc2V0cygpLCA1MCk7CiAgICB9KTsKCgogICAgc3RhZ2VTdGFjay5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIG9uU3RhZ2VXaGVlbCwge3Bhc3NpdmU6ZmFsc2V9KTsKCiAgICB2aWV3ZXJUaHVtYnMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PnsKICAgICAgY29uc3QgdGh1bWIgPSBlLnRhcmdldC5jbG9zZXN0KCcudGh1bWInKTsKICAgICAgaWYgKCF0aHVtYikgcmV0dXJuOwogICAgICBjb25zdCBpZHggPSBwYXJzZUludCh0aHVtYi5kYXRhc2V0LmluZGV4LDEwKTsKICAgICAgdmlld2VySW5kZXggPSBpZHg7CiAgICAgIHJlbmRlclZpZXdlcigpOwogICAgfSk7CgogICAgLy8gRGVsZXRlIGN1cnJlbnQgcGhvdG8gKHZpZXdlciBvbmx5LCBvbmx5IGlmIG9wZW5lZCBmcm9tIGVkaXQtbW9kZSkKICAgIHZpZXdlckRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+ewogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBpZiAoIXZpZXdlckNhbkRlbGV0ZSkgcmV0dXJuOwoKICAgICAgY29uc3Qga2l0ID0gZ2V0S2l0QnlJZCh2aWV3ZXJLaXRJZCk7CiAgICAgIGlmICgha2l0KSByZXR1cm47CgogICAgICAKCiAgICAgIGlmICghY29uZmlybSgn0KPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4/INCt0YLQviDQtNC10LnRgdGC0LLQuNC1INC90LXQu9GM0LfRjyDQvtGC0LzQtdC90LjRgtGMLicpKSByZXR1cm47CgogICAgICBraXQucGhvdG9zLnNwbGljZSh2aWV3ZXJJbmRleCwxKTsKICAgICAgaWYgKGtpdC5waG90b3MubGVuZ3RoID09PSAwKXsKICAgICAgICBraXQuY3JlYXRlZEF0ID0gbnVsbDsKICAgICAgICBjbG9zZVZpZXdlcigpOwogICAgICB9ZWxzZXsKICAgICAgICB2aWV3ZXJJbmRleCA9IE1hdGgubWluKHZpZXdlckluZGV4LCBraXQucGhvdG9zLmxlbmd0aC0xKTsKICAgICAgICBraXQuY3JlYXRlZEF0ID0gZm9ybWF0RGF0ZVRpbWUobmV3IERhdGUoKSk7CiAgICAgICAgcmVuZGVyVmlld2VyKCk7CiAgICAgIH0KICAgICAgcmVuZGVyKCk7IC8vIHVwZGF0ZSBjb3VudHMvZ3JpZAogICAgfSk7CgoKICAgIC8qID09PT09IEVESVQgTU9ERSBFWElUIFVYID09PT09ICovCiAgICAvLyBFeGl0IGVkaXQgb24gRXNjCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpPT57CiAgICAgIGlmIChlLmtleSAhPT0gJ0VzY2FwZScpIHJldHVybjsKICAgICAgaWYgKCFhY3RpdmVFZGl0S2l0SWQpIHJldHVybjsKICAgICAgLy8gZG9uJ3QgaW50ZXJmZXJlIHdpdGggdmlld2VyIGNvbnRyb2xzIGlmIG5lZWRlZAogICAgICBleGl0RWRpdCgpOwogICAgfSk7CgogICAgLy8gRXhpdCBlZGl0IHdoZW4gY2xpY2tpbmcgb3V0c2lkZSBhbGxvd2VkIGFyZWFzIG9mIHRoZSBhY3RpdmUgY2FyZAogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCAoZSk9PnsKICAgICAgaWYgKCFhY3RpdmVFZGl0S2l0SWQpIHJldHVybjsKCiAgICAgIC8vIEFsbG93IGNsaWNraW5nIGFjdGlvbiBidXR0b25zIGluc2lkZSB0aGUgYWN0aXZlIGNhcmQgKGVkaXQvZGVsZXRlL2Rvd25sb2FkIGV0Yy4pCiAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KGAua2l0LWNhcmRbZGF0YS1raXQtaWQ9IiR7YWN0aXZlRWRpdEtpdElkfSJdIC5raXQtYWN0aW9uc2ApKSByZXR1cm47CgogICAgICAvLyBJZiB2aWV3ZXIgaXMgb3BlbiwgaWdub3JlIG91dHNpZGUgY2xpY2tzICh2aWV3ZXIgb3ZlcmxheSBoYW5kbGVzIGl0c2VsZikKICAgICAgY29uc3Qgdmlld2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdlckJhY2tkcm9wJyk7CiAgICAgIGlmICh2aWV3ZXIgJiYgdmlld2VyLmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpKSByZXR1cm47CgogICAgICBjb25zdCBjYXJkID0ga2l0c0VsLnF1ZXJ5U2VsZWN0b3IoYC5raXQtY2FyZFtkYXRhLWtpdC1pZD0iJHthY3RpdmVFZGl0S2l0SWR9Il1gKTsKICAgICAgaWYgKCFjYXJkKSByZXR1cm47CgogICAgICBjb25zdCBhbGxvd2VkID0gZS50YXJnZXQuY2xvc2VzdCgKICAgICAgICBgLmtpdC1jYXJkW2RhdGEta2l0LWlkPSIke2FjdGl2ZUVkaXRLaXRJZH0iXSAua2l0LWdyaWQsCiAgICAgICAgIC5raXQtY2FyZFtkYXRhLWtpdC1pZD0iJHthY3RpdmVFZGl0S2l0SWR9Il0gLmtpdC10aXRsZSwKICAgICAgICAgLmtpdC1jYXJkW2RhdGEta2l0LWlkPSIke2FjdGl2ZUVkaXRLaXRJZH0iXSAua2l0LWNoZWNrLAogICAgICAgICAua2l0LWNhcmRbZGF0YS1raXQtaWQ9IiR7YWN0aXZlRWRpdEtpdElkfSJdIC5raXQtZHJhZy1oYW5kbGVgCiAgICAgICk7CgogICAgICBpZiAoIWFsbG93ZWQpewogICAgICAgIGV4aXRFZGl0KCk7CiAgICAgIH0KICAgIH0sIHRydWUpOwoKCgoKICAgIC8qID09PT09IERyYWcgcmVvcmRlciAoc3RhYmxlIGlQaG9uZS1saWtlKSA9PT09PSAqLwogICAgKGZ1bmN0aW9uIHNldHVwRHJhZ1Jlb3JkZXIoKXsKICAgICAgLyoqCiAgICAgICAqIENlbnRlci1iYXNlZCBzdGFibGUgZ3JpZCByZW9yZGVyaW5nIChTcHJpbmdCb2FyZC1pc2gg4oCcY2VudGVycyBkZWNpZGXigJ0pLgogICAgICAgKgogICAgICAgKiBHb2FsczoKICAgICAgICogLSBUYXJnZXQgcG9zaXRpb24gaXMgZGVyaXZlZCBmcm9tIHRoZSBkcmFnZ2VkIENBUkQgKGl0cyBjZW50ZXIpLCBub3QgdGhlIGN1cnNvci4KICAgICAgICogLSBPdGhlciBjYXJkcyDigJxkZWNpZGXigJ0gc2hpZnRzIGJ5IGNvbXBhcmluZyBjZW50ZXJzIChyb3ctbWFqb3Igb3JkZXIpLgogICAgICAgKiAtIFNpbmdsZSBwbGFjZWhvbGRlciAo4oCcaG9sZeKAnSkgcmVwcmVzZW50cyB0aGUgaW5zZXJ0aW9uIHNsb3QuCiAgICAgICAqIC0gQW50aS1qaXR0ZXI6IHJBRiBiYXRjaGluZyArIGNvb2xkb3duICsgaHlzdGVyZXNpcyArIHNtYWxsIGRlYWQtem9uZSBhcm91bmQgY2VudGVycy4KICAgICAgICoKICAgICAgICogTW9kZWw6CiAgICAgICAqIDEpIExpZnQgZHJhZ2dlZCBjYXJkIGludG8gb3ZlcmxheSAocG9zaXRpb246Zml4ZWQgaW4gPGJvZHk+KQogICAgICAgKiAyKSBMZWF2ZSBwbGFjZWhvbGRlciBpbiBncmlkIGF0IG9yaWdpbmFsIHBvc2l0aW9uCiAgICAgICAqIDMpIFdoaWxlIGRyYWdnaW5nLCBjb21wdXRlIGRyYWdnZWQgY2VudGVyOyBjb21wdXRlIGNsb3Nlc3QgY2FyZCBjZW50ZXI7IGRlY2lkZQogICAgICAgKiAgICB3aGV0aGVyIGhvbGUgc2hvdWxkIGJlIGJlZm9yZSBvciBhZnRlciB0aGF0IGNhcmQgKGJ5IGNlbnRlcnMpLCB0aGVuIG1vdmUgcGxhY2Vob2xkZXIuCiAgICAgICAqIDQpIE9uIGRyb3AsIGluc2VydCBjYXJkIGF0IHBsYWNlaG9sZGVyLgogICAgICAgKi8KICAgICAgY29uc3QgZ3JpZCA9IGtpdHNFbDsgLy8gI2tpdHMKICAgICAgaWYgKCFncmlkKSByZXR1cm47CgogICAgICAvLyAtLS0tIFR1bmluZyBrbm9icyAtLS0tCiAgICAgIGNvbnN0IEFVVE9TQ1JPTExfTUFSR0lOID0gNjA7IC8vIHB4IGZyb20gdmlld3BvcnQgZWRnZQogICAgICBjb25zdCBBVVRPU0NST0xMX01BWCA9IDIyOyAgICAvLyBweCBwZXIgZnJhbWUKCiAgICAgIC8vIE1vdmUgcG9saWN5IChhbnRpLWppdHRlcik6IGFsbG93IG1vdmVzLCBidXQgbmV2ZXIgImNoYXR0ZXIiCiAgICAgIGNvbnN0IE1PVkVfQ09PTERPV05fTVMgPSA5MDsgIC8vIG1pbiB0aW1lIGJldHdlZW4gaG9sZSBtb3ZlcwogICAgICBjb25zdCBNT1ZFX0hZU1RfUFggPSAxMjsgICAgICAvLyBtaW4gY2VudGVyIHRyYXZlbCBiZXR3ZWVuIG1vdmVzCgogICAgICAvLyBNaWxkIHNtb290aGluZyBvZiB0aGUgZHJhZ2dlZCBjYXJkIChhZGRzIGEgc21hbGwgZGVsYXkgc28gdGhlIGZpbmdlci9jdXJzb3IgZG9lc24ndCAidGVsZXBvcnQiIHRoZSBjYXJkKQogICAgICBjb25zdCBEUkFHX0VBU0UgPSAwLjM1OyAgICAgICAvLyAwLi4xIChoaWdoZXIgPSBzbmFwcGllcikKCiAgICAgIC8vIFBsYW5uaW5nICsgY29tbWl0IHBvbGljeSAocHJlLXBsYW4gdGFyZ2V0LCBjb21taXQgb25seSB3aGVuIG92ZXJsYXAgaXMgc3Ryb25nKQogICAgICBjb25zdCBQTEFOX1RSSUdHRVIgPSAwLjIwOyAgICAgICAvLyBzdGFydCAicGxhbm5pbmciIG9uY2Ugb3ZlcmxhcCBpcyBub3RpY2VhYmxlCiAgICAgIGNvbnN0IFBMQU5fU1RBQkxFX01TID0gOTA7ICAgICAgIC8vIGNhbmRpZGF0ZSBtdXN0IGJlIHN0YWJsZSB0aGlzIGxvbmcgdG8gYmVjb21lIHRoZSBwbGFuCiAgICAgIGNvbnN0IFBMQU5fU1dJVENIX0hZU1QgPSAwLjEyOyAgIC8vIHN3aXRjaCBwbGFuIG9ubHkgaWYgbmV3IGlzIGJldHRlciBieSB0aGlzIG1hcmdpbgogICAgICBjb25zdCBQTEFOX0RST1AgPSAwLjA4OyAgICAgICAgICAvLyBkcm9wIHBsYW4gaWYgb3ZlcmxhcCBmYWxscyBiZWxvdyB0aGlzCgogICAgICBjb25zdCBDT01NSVRfVFJJR0dFUiA9IDAuODA7ICAgICAvLyA4MCUgb3ZlcmxhcCA9PiBtb3ZlIHBsYWNlaG9sZGVyICh5b3VyICJkZWNpc2lvbiBwb2ludCIpCiAgICAgIGNvbnN0IENPTU1JVF9TVEFCTEVfTVMgPSA4MDsgICAgIC8vIGtlZXAgPj0gODAlIG92ZXJsYXAgZm9yIHRoaXMgbG9uZyBiZWZvcmUgbW92aW5nCiAgICAgIGNvbnN0IExPQ0tfQUZURVJfTU9WRV9NUyA9IDE2MDsgIC8vIGFmdGVyIGEgbW92ZSwgZnJlZXplIHJlLXBsYW5uaW5nIGJyaWVmbHkgKHByZXZlbnRzIHBpbmctcG9uZykKCiAgICAgIC8vIENhbmRpZGF0ZSBzdGlja2luZXNzOiBrZWVwIHByZXZpb3VzIGJlc3QgdW5sZXNzIHRoZSBuZXcgb25lIGlzIGNsZWFybHkgYmV0dGVyCiAgICAgIGNvbnN0IE9WRVJMQVBfSFlTVCA9IDAuMTA7CgogICAgICAvLyBTbWFsbCBsb29rLWFoZWFkIHVzaW5nIGNhcmQgdmVsb2NpdHkgKHN0aWxsICJmcm9tIHRoZSBjYXJkIiwgbm90IGZyb20gY3Vyc29yKQogICAgICBjb25zdCBQUkVESUNUX01TID0gOTA7ICAgICAgICAvLyBtcyBhaGVhZAoKICAgICAgY29uc3QgUk9XX0JBTkRfRlJBQyA9IDAuNDg7ICAgIC8vIHNhbWUgcm93IGlmIHxkeXwgPCBtZWRpYW5IICogZnJhYwogICAgICBjb25zdCBDRU5URVJfREVBRF9GUkFDID0gMC4wODsgLy8gZGVhZC16b25lIGFyb3VuZCB0YXJnZXQgY2VudGVyIChmcmFjdGlvbiBvZiB3L2gpCgogICAgICBsZXQgZHJhZyA9IG51bGw7CiAgICAgIGxldCByYWZJZCA9IDA7CgogICAgICBmdW5jdGlvbiBweChuKXsgcmV0dXJuIE1hdGgucm91bmQobikgKyAncHgnOyB9CgogICAgICBmdW5jdGlvbiB2aWV3cG9ydEF1dG9TY3JvbGwoY2xpZW50WCwgY2xpZW50WSl7CiAgICAgICAgY29uc3QgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICAgICAgY29uc3QgdncgPSB3aW5kb3cuaW5uZXJXaWR0aDsKICAgICAgICBsZXQgdnkgPSAwLCB2eCA9IDA7CgogICAgICAgIGlmIChjbGllbnRZIDwgQVVUT1NDUk9MTF9NQVJHSU4pewogICAgICAgICAgdnkgPSAtQVVUT1NDUk9MTF9NQVggKiAoMSAtIGNsaWVudFkgLyBBVVRPU0NST0xMX01BUkdJTik7CiAgICAgICAgfSBlbHNlIGlmIChjbGllbnRZID4gdmggLSBBVVRPU0NST0xMX01BUkdJTil7CiAgICAgICAgICB2eSA9IEFVVE9TQ1JPTExfTUFYICogKDEgLSAodmggLSBjbGllbnRZKSAvIEFVVE9TQ1JPTExfTUFSR0lOKTsKICAgICAgICB9CgogICAgICAgIGlmIChjbGllbnRYIDwgQVVUT1NDUk9MTF9NQVJHSU4pewogICAgICAgICAgdnggPSAtQVVUT1NDUk9MTF9NQVggKiAoMSAtIGNsaWVudFggLyBBVVRPU0NST0xMX01BUkdJTik7CiAgICAgICAgfSBlbHNlIGlmIChjbGllbnRYID4gdncgLSBBVVRPU0NST0xMX01BUkdJTil7CiAgICAgICAgICB2eCA9IEFVVE9TQ1JPTExfTUFYICogKDEgLSAodncgLSBjbGllbnRYKSAvIEFVVE9TQ1JPTExfTUFSR0lOKTsKICAgICAgICB9CgogICAgICAgIGlmICh2eCB8fCB2eSkgd2luZG93LnNjcm9sbEJ5KHZ4LCB2eSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG1ha2VQbGFjZWhvbGRlcihmcm9tQ2FyZCl7CiAgICAgICAgY29uc3QgcGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBwaC5jbGFzc05hbWUgPSAna2l0LXBsYWNlaG9sZGVyJzsKICAgICAgICBjb25zdCByID0gZnJvbUNhcmQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgcGguc3R5bGUuaGVpZ2h0ID0gcHgoci5oZWlnaHQpOwogICAgICAgIHBoLnN0eWxlLm1pbkhlaWdodCA9IHB4KHIuaGVpZ2h0KTsKICAgICAgICBwaC5zdHlsZS53aWR0aCA9ICcxMDAlJzsKICAgICAgICBwaC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOwogICAgICAgIHJldHVybiBwaDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbmV4dENhcmRBZnRlcihub2RlKXsKICAgICAgICBsZXQgbiA9IG5vZGUgPyBub2RlLm5leHRFbGVtZW50U2libGluZyA6IG51bGw7CiAgICAgICAgd2hpbGUgKG4gJiYgIW4uY2xhc3NMaXN0LmNvbnRhaW5zKCdraXQtY2FyZCcpKSBuID0gbi5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICAgICAgcmV0dXJuIG47CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGlzUGxhY2Vob2xkZXJBdEVuZCgpewogICAgICAgIGNvbnN0IHJlZiA9IG5leHRDYXJkQWZ0ZXIoZHJhZz8ucGxhY2Vob2xkZXIpOwogICAgICAgIHJldHVybiAhcmVmOwogICAgICB9CgogICAgICBmdW5jdGlvbiBmbGlwQW5pbWF0ZUFmdGVyRE9NQ2hhbmdlKGRvQ2hhbmdlKXsKICAgICAgICBjb25zdCBmaXJzdCA9IG5ldyBNYXAoKTsKICAgICAgICBncmlkLnF1ZXJ5U2VsZWN0b3JBbGwoJy5raXQtY2FyZCwgLmtpdC1wbGFjZWhvbGRlcicpLmZvckVhY2gobiA9PiBmaXJzdC5zZXQobiwgbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSkpOwoKICAgICAgICBkb0NoYW5nZSgpOwoKICAgICAgICBjb25zdCBsYXN0ID0gbmV3IE1hcCgpOwogICAgICAgIGdyaWQucXVlcnlTZWxlY3RvckFsbCgnLmtpdC1jYXJkLCAua2l0LXBsYWNlaG9sZGVyJykuZm9yRWFjaChuID0+IGxhc3Quc2V0KG4sIG4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpKTsKCiAgICAgICAgbGFzdC5mb3JFYWNoKChsciwgbm9kZSk9PnsKICAgICAgICAgIGNvbnN0IGZyID0gZmlyc3QuZ2V0KG5vZGUpOwogICAgICAgICAgaWYgKCFmcikgcmV0dXJuOwogICAgICAgICAgY29uc3QgZHggPSBmci5sZWZ0IC0gbHIubGVmdDsKICAgICAgICAgIGNvbnN0IGR5ID0gZnIudG9wIC0gbHIudG9wOwogICAgICAgICAgaWYgKGR4IHx8IGR5KXsKICAgICAgICAgICAgbm9kZS5hbmltYXRlKFsKICAgICAgICAgICAgICB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2R4fXB4LCAke2R5fXB4KWAgfSwKICAgICAgICAgICAgICB7IHRyYW5zZm9ybTogJ3RyYW5zbGF0ZSgwLDApJyB9CiAgICAgICAgICAgIF0sIHsgZHVyYXRpb246IDIyMCwgZWFzaW5nOiAnY3ViaWMtYmV6aWVyKC4yLC44NSwuMiwxKScgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGdldERyYWdUb3BMZWZ0KCl7CiAgICAgICAgLy8gS2VlcCBvdmVybGF5IGNhcmQgdW5kZXIgcG9pbnRlciB3aXRoIGZpeGVkIGdyYWIgb2Zmc2V0LCBidXQgc21vb3RoIGEgYml0IHRvIHJlZHVjZSBqaXR0ZXIuCiAgICAgICAgY29uc3QgdGFyZ2V0VG9wID0gZHJhZy5sYXN0Q2xpZW50WSAtIGRyYWcuZ3JhYkR5OwogICAgICAgIGNvbnN0IHRhcmdldExlZnQgPSBkcmFnLmxhc3RDbGllbnRYIC0gZHJhZy5ncmFiRHg7CgogICAgICAgIGlmIChkcmFnLl9zbW9vdGhUb3AgPT0gbnVsbCl7CiAgICAgICAgICBkcmFnLl9zbW9vdGhUb3AgPSB0YXJnZXRUb3A7CiAgICAgICAgICBkcmFnLl9zbW9vdGhMZWZ0ID0gdGFyZ2V0TGVmdDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZHJhZy5fc21vb3RoVG9wICs9ICh0YXJnZXRUb3AgLSBkcmFnLl9zbW9vdGhUb3ApICogRFJBR19FQVNFOwogICAgICAgICAgZHJhZy5fc21vb3RoTGVmdCArPSAodGFyZ2V0TGVmdCAtIGRyYWcuX3Ntb290aExlZnQpICogRFJBR19FQVNFOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsgdG9wOiBkcmFnLl9zbW9vdGhUb3AsIGxlZnQ6IGRyYWcuX3Ntb290aExlZnQgfTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gY2xhbXAobiwgYSwgYil7IHJldHVybiBNYXRoLm1heChhLCBNYXRoLm1pbihiLCBuKSk7IH0KCiAgICAgIGZ1bmN0aW9uIHJlY3RGcm9tQ2VudGVyKGN4LCBjeSwgdywgaCl7CiAgICAgICAgY29uc3QgbGVmdCA9IGN4IC0gdy8yOwogICAgICAgIGNvbnN0IHRvcCA9IGN5IC0gaC8yOwogICAgICAgIHJldHVybiB7IGxlZnQsIHRvcCwgcmlnaHQ6IGxlZnQgKyB3LCBib3R0b206IHRvcCArIGgsIHdpZHRoOiB3LCBoZWlnaHQ6IGggfTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gaW50ZXJzZWN0aW9uQXJlYShhLCBiKXsKICAgICAgICBjb25zdCBpeCA9IE1hdGgubWF4KDAsIE1hdGgubWluKGEucmlnaHQsIGIucmlnaHQpIC0gTWF0aC5tYXgoYS5sZWZ0LCBiLmxlZnQpKTsKICAgICAgICBjb25zdCBpeSA9IE1hdGgubWF4KDAsIE1hdGgubWluKGEuYm90dG9tLCBiLmJvdHRvbSkgLSBNYXRoLm1heChhLnRvcCwgYi50b3ApKTsKICAgICAgICByZXR1cm4gaXggKiBpeTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gb3ZlcmxhcFNjb3JlKGRyYWdSZWN0LCB0YXJnZXRSZWN0KXsKICAgICAgICBjb25zdCBhcmVhID0gaW50ZXJzZWN0aW9uQXJlYShkcmFnUmVjdCwgdGFyZ2V0UmVjdCk7CiAgICAgICAgaWYgKCFhcmVhKSByZXR1cm4gMDsKICAgICAgICBjb25zdCBhMSA9IGRyYWdSZWN0LndpZHRoICogZHJhZ1JlY3QuaGVpZ2h0OwogICAgICAgIGNvbnN0IGEyID0gdGFyZ2V0UmVjdC53aWR0aCAqIHRhcmdldFJlY3QuaGVpZ2h0OwogICAgICAgIHJldHVybiBhcmVhIC8gTWF0aC5taW4oYTEsIGEyKTsgLy8gMC4uMQogICAgICB9CgogICAgICBmdW5jdGlvbiBjb21wdXRlUm93TWFqb3JPcmRlcigpewogICAgICAgIGNvbnN0IGNhcmRzID0gWy4uLmdyaWQucXVlcnlTZWxlY3RvckFsbCgnLmtpdC1jYXJkJyldOwogICAgICAgIGNvbnN0IGl0ZW1zID0gW107CiAgICAgICAgZm9yIChjb25zdCBlbCBvZiBjYXJkcyl7CiAgICAgICAgICBjb25zdCByID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgICAgZWwsCiAgICAgICAgICAgIHJlY3Q6IHIsCiAgICAgICAgICAgIGN4OiByLmxlZnQgKyByLndpZHRoLzIsCiAgICAgICAgICAgIGN5OiByLnRvcCArIHIuaGVpZ2h0LzIsCiAgICAgICAgICAgIHc6IHIud2lkdGgsCiAgICAgICAgICAgIGg6IHIuaGVpZ2h0CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFpdGVtcy5sZW5ndGgpIHJldHVybiB7IG9yZGVyOiBbXSwgcm93QmFuZDogMCB9OwoKICAgICAgICBjb25zdCBocyA9IGl0ZW1zLm1hcChpPT5pLmgpLnNvcnQoKGEsYik9PmEtYik7CiAgICAgICAgY29uc3QgbWVkSCA9IGhzW01hdGguZmxvb3IoaHMubGVuZ3RoLzIpXSB8fCAwOwogICAgICAgIGNvbnN0IHJvd0JhbmQgPSBNYXRoLm1heCgxMiwgbWVkSCAqIFJPV19CQU5EX0ZSQUMpOwoKICAgICAgICAvLyBncm91cCBpbnRvIHJvd3MgYnkgY2VudGVyWQogICAgICAgIGl0ZW1zLnNvcnQoKGEsYik9PmEuY3kgLSBiLmN5KTsKICAgICAgICBjb25zdCByb3dzID0gW107CiAgICAgICAgZm9yIChjb25zdCBpdCBvZiBpdGVtcyl7CiAgICAgICAgICBjb25zdCByb3cgPSByb3dzW3Jvd3MubGVuZ3RoLTFdOwogICAgICAgICAgaWYgKCFyb3cpewogICAgICAgICAgICByb3dzLnB1c2goeyBjeTogaXQuY3ksIGl0ZW1zOiBbaXRdIH0pOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChNYXRoLmFicyhpdC5jeSAtIHJvdy5jeSkgPD0gcm93QmFuZCl7CiAgICAgICAgICAgIHJvdy5pdGVtcy5wdXNoKGl0KTsKICAgICAgICAgICAgcm93LmN5ID0gcm93LmN5ICsgKGl0LmN5IC0gcm93LmN5KS9yb3cuaXRlbXMubGVuZ3RoOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcm93cy5wdXNoKHsgY3k6IGl0LmN5LCBpdGVtczogW2l0XSB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gc29ydCB3aXRoaW4gcm93cyBieSBjZW50ZXJYIGFuZCBmbGF0dGVuCiAgICAgICAgY29uc3Qgb3JkZXIgPSBbXTsKICAgICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKXsKICAgICAgICAgIHJvdy5pdGVtcy5zb3J0KChhLGIpPT5hLmN4IC0gYi5jeCk7CiAgICAgICAgICBmb3IgKGNvbnN0IGl0IG9mIHJvdy5pdGVtcykgb3JkZXIucHVzaChpdCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB7IG9yZGVyLCByb3dCYW5kIH07CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNvbXB1dGVJbnNlcnRSZWZJbk9yZGVyKG9yZGVyLCByb3dCYW5kLCBjaG9zZW5JLCBkcmFnQ3gsIGRyYWdDeSl7CiAgICAgICAgY29uc3QgY2hvc2VuID0gb3JkZXJbY2hvc2VuSV07CiAgICAgICAgY29uc3Qgc2FtZVJvdyA9IE1hdGguYWJzKGRyYWdDeSAtIGNob3Nlbi5jeSkgPD0gcm93QmFuZC8yOwoKICAgICAgICBpZiAoc2FtZVJvdyl7CiAgICAgICAgICBjb25zdCBkZWFkWCA9IE1hdGgubWF4KDYsIGNob3Nlbi53ICogQ0VOVEVSX0RFQURfRlJBQyk7CiAgICAgICAgICBpZiAoZHJhZ0N4IDwgY2hvc2VuLmN4IC0gZGVhZFgpIHJldHVybiBjaG9zZW4uZWw7IC8vIGJlZm9yZQogICAgICAgICAgaWYgKGRyYWdDeCA+IGNob3Nlbi5jeCArIGRlYWRYKSByZXR1cm4gKGNob3NlbkkgKyAxIDwgb3JkZXIubGVuZ3RoKSA/IG9yZGVyW2Nob3NlbkkgKyAxXS5lbCA6IG51bGw7IC8vIGFmdGVyCiAgICAgICAgICByZXR1cm4gbmV4dENhcmRBZnRlcihkcmFnLnBsYWNlaG9sZGVyKTsgLy8gZGVhZC16b25lCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGRlYWRZID0gTWF0aC5tYXgoNiwgY2hvc2VuLmggKiBDRU5URVJfREVBRF9GUkFDKTsKICAgICAgICAgIGlmIChkcmFnQ3kgPCBjaG9zZW4uY3kgLSBkZWFkWSkgcmV0dXJuIGNob3Nlbi5lbDsKICAgICAgICAgIGlmIChkcmFnQ3kgPiBjaG9zZW4uY3kgKyBkZWFkWSkgcmV0dXJuIChjaG9zZW5JICsgMSA8IG9yZGVyLmxlbmd0aCkgPyBvcmRlcltjaG9zZW5JICsgMV0uZWwgOiBudWxsOwogICAgICAgICAgcmV0dXJuIG5leHRDYXJkQWZ0ZXIoZHJhZy5wbGFjZWhvbGRlcik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBjb21wdXRlQ2FuZGlkYXRlKGRyYWdDeCwgZHJhZ0N5LCBkcmFnUmVjdCl7CiAgICAgICAgY29uc3QgeyBvcmRlciwgcm93QmFuZCB9ID0gY29tcHV0ZVJvd01ham9yT3JkZXIoKTsKICAgICAgICBpZiAoIW9yZGVyLmxlbmd0aCkgcmV0dXJuIHsgcmVmOiBudWxsLCB0YXJnZXRFbDogbnVsbCwgdGFyZ2V0U2NvcmU6IDAgfTsKCiAgICAgICAgY29uc3QgZHIgPSBkcmFnUmVjdDsKCiAgICAgICAgLy8gMSkgQmVzdCBvdmVybGFwICh3aG8gaXMgbW9zdCBjb3ZlcmVkIGJ5IHRoZSBkcmFnZ2VkIGNhcmQpCiAgICAgICAgbGV0IGJlc3RJID0gLTE7CiAgICAgICAgbGV0IGJlc3RTY29yZSA9IDA7CiAgICAgICAgZm9yIChsZXQgaT0wO2k8b3JkZXIubGVuZ3RoO2krKyl7CiAgICAgICAgICBjb25zdCBpdCA9IG9yZGVyW2ldOwogICAgICAgICAgY29uc3QgcyA9IG92ZXJsYXBTY29yZShkciwgaXQucmVjdCk7CiAgICAgICAgICBpZiAocyA+IGJlc3RTY29yZSl7CiAgICAgICAgICAgIGJlc3RTY29yZSA9IHM7CiAgICAgICAgICAgIGJlc3RJID0gaTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIDIpIENob29zZSB3aXRoIHN0aWNraW5lc3MgKHByZXZlbnRzIHJhcGlkIGZsaXBzIHdoaWxlIGhvdmVyaW5nKQogICAgICAgIGxldCBjaG9zZW5JID0gLTE7CiAgICAgICAgbGV0IGNob3NlblNjb3JlID0gMDsKCiAgICAgICAgaWYgKGJlc3RJICE9PSAtMSAmJiBiZXN0U2NvcmUgPiAwKXsKICAgICAgICAgIGNob3NlbkkgPSBiZXN0STsKICAgICAgICAgIGNob3NlblNjb3JlID0gYmVzdFNjb3JlOwoKICAgICAgICAgIGlmIChkcmFnLmxhc3RUYXJnZXRFbCl7CiAgICAgICAgICAgIGNvbnN0IHByZXZJID0gb3JkZXIuZmluZEluZGV4KGl0ID0+IGl0LmVsID09PSBkcmFnLmxhc3RUYXJnZXRFbCk7CiAgICAgICAgICAgIGlmIChwcmV2SSAhPT0gLTEpewogICAgICAgICAgICAgIGNvbnN0IHByZXZTY29yZSA9IG92ZXJsYXBTY29yZShkciwgb3JkZXJbcHJldkldLnJlY3QpOwogICAgICAgICAgICAgIGlmIChwcmV2U2NvcmUgPj0gY2hvc2VuU2NvcmUgLSBPVkVSTEFQX0hZU1QpewogICAgICAgICAgICAgICAgY2hvc2VuSSA9IHByZXZJOwogICAgICAgICAgICAgICAgY2hvc2VuU2NvcmUgPSBwcmV2U2NvcmU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIEZhbGxiYWNrOiBjbG9zZXN0IGNlbnRlciAoYmV0d2VlbiBjYXJkcyAvIGluIGdhcHMpCiAgICAgICAgICBsZXQgY2kgPSAwOwogICAgICAgICAgbGV0IGJlc3REID0gSW5maW5pdHk7CiAgICAgICAgICBmb3IgKGxldCBpPTA7aTxvcmRlci5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgY29uc3QgaXQgPSBvcmRlcltpXTsKICAgICAgICAgICAgY29uc3QgZHggPSBkcmFnQ3ggLSBpdC5jeDsKICAgICAgICAgICAgY29uc3QgZHkgPSBkcmFnQ3kgLSBpdC5jeTsKICAgICAgICAgICAgY29uc3QgZCA9IGR4KmR4ICsgZHkqZHk7CiAgICAgICAgICAgIGlmIChkIDwgYmVzdEQpeyBiZXN0RCA9IGQ7IGNpID0gaTsgfQogICAgICAgICAgfQogICAgICAgICAgY2hvc2VuSSA9IGNpOwogICAgICAgICAgY2hvc2VuU2NvcmUgPSAwOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgY2hvc2VuID0gb3JkZXJbY2hvc2VuSV07CiAgICAgICAgZHJhZy5sYXN0VGFyZ2V0RWwgPSBjaG9zZW4uZWw7CgogICAgICAgIGNvbnN0IHJlZiA9IGNvbXB1dGVJbnNlcnRSZWZJbk9yZGVyKG9yZGVyLCByb3dCYW5kLCBjaG9zZW5JLCBkcmFnQ3gsIGRyYWdDeSk7CiAgICAgICAgcmV0dXJuIHsgcmVmLCB0YXJnZXRFbDogY2hvc2VuLmVsLCB0YXJnZXRTY29yZTogY2hvc2VuU2NvcmUgfTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gY29tcHV0ZUluc2VydFJlZkZvclRhcmdldCh0YXJnZXRFbCwgZHJhZ0N4LCBkcmFnQ3kpewogICAgICAgIGNvbnN0IHsgb3JkZXIsIHJvd0JhbmQgfSA9IGNvbXB1dGVSb3dNYWpvck9yZGVyKCk7CiAgICAgICAgaWYgKCFvcmRlci5sZW5ndGgpIHJldHVybiBudWxsOwoKICAgICAgICBjb25zdCBpID0gb3JkZXIuZmluZEluZGV4KGl0ID0+IGl0LmVsID09PSB0YXJnZXRFbCk7CiAgICAgICAgaWYgKGkgPT09IC0xKXsKICAgICAgICAgIHJldHVybiBuZXh0Q2FyZEFmdGVyKGRyYWcucGxhY2Vob2xkZXIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29tcHV0ZUluc2VydFJlZkluT3JkZXIob3JkZXIsIHJvd0JhbmQsIGksIGRyYWdDeCwgZHJhZ0N5KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdXBkYXRlUGxhbkZyb21DYW5kaWRhdGUoY2FuZCwgZHJhZ1JlY3QsIG5vdyl7CiAgICAgICAgY29uc3QgZWwgPSBjYW5kLnRhcmdldEVsOwogICAgICAgIGNvbnN0IHNjb3JlID0gY2FuZC50YXJnZXRTY29yZTsKCiAgICAgICAgLy8gTm90IGVub3VnaCBvdmVybGFwID0+IGNhbmRpZGF0ZSByZXNldHM7IHBsYW4gbWF5IGRyb3AgaWYgd2UgbW92ZWQgYXdheS4KICAgICAgICBpZiAoIWVsIHx8IHNjb3JlIDwgUExBTl9UUklHR0VSKXsKICAgICAgICAgIGRyYWcucGxhbkNhbmRFbCA9IG51bGw7CiAgICAgICAgICBkcmFnLnBsYW5DYW5kU3RhcnQgPSAwOwogICAgICAgICAgZHJhZy5wbGFuQ2FuZFNjb3JlID0gMDsKCiAgICAgICAgICBpZiAoZHJhZy5wbGFuRWwpewogICAgICAgICAgICBjb25zdCBjdXIgPSBvdmVybGFwU2NvcmUoZHJhZ1JlY3QsIGRyYWcucGxhbkVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTsKICAgICAgICAgICAgaWYgKGN1ciA8IFBMQU5fRFJPUCl7CiAgICAgICAgICAgICAgZHJhZy5wbGFuRWwgPSBudWxsOwogICAgICAgICAgICAgIGRyYWcucGxhblNldEF0ID0gMDsKICAgICAgICAgICAgICBkcmFnLnBsYW5TY29yZSA9IDA7CiAgICAgICAgICAgICAgZHJhZy5jb21taXRTaW5jZSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIFNhbWUgcGxhbiB0YXJnZXQ6IGp1c3QgcmVmcmVzaCBzY29yZS4KICAgICAgICBpZiAoZHJhZy5wbGFuRWwgPT09IGVsKXsKICAgICAgICAgIGRyYWcucGxhblNjb3JlID0gc2NvcmU7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBUcmFjayBhIHN0YWJsZSBjYW5kaWRhdGUgYmVmb3JlIHN3aXRjaGluZyBwbGFuLgogICAgICAgIGlmIChkcmFnLnBsYW5DYW5kRWwgIT09IGVsKXsKICAgICAgICAgIGRyYWcucGxhbkNhbmRFbCA9IGVsOwogICAgICAgICAgZHJhZy5wbGFuQ2FuZFN0YXJ0ID0gbm93OwogICAgICAgICAgZHJhZy5wbGFuQ2FuZFNjb3JlID0gc2NvcmU7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobm93IC0gKGRyYWcucGxhbkNhbmRTdGFydCB8fCBub3cpIDwgUExBTl9TVEFCTEVfTVMpIHJldHVybjsKCiAgICAgICAgY29uc3QgY3VyID0gZHJhZy5wbGFuRWwgPyBvdmVybGFwU2NvcmUoZHJhZ1JlY3QsIGRyYWcucGxhbkVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSA6IDA7CiAgICAgICAgaWYgKCFkcmFnLnBsYW5FbCB8fCBzY29yZSA+IGN1ciArIFBMQU5fU1dJVENIX0hZU1QpewogICAgICAgICAgZHJhZy5wbGFuRWwgPSBlbDsKICAgICAgICAgIGRyYWcucGxhblNldEF0ID0gbm93OwogICAgICAgICAgZHJhZy5wbGFuU2NvcmUgPSBzY29yZTsKICAgICAgICAgIGRyYWcuY29tbWl0U2luY2UgPSAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gbWF5YmVNb3ZlSG9sZShwcmVkQ3gsIHByZWRDeSwgcHJlZFJlY3QsIGN1ckN4LCBjdXJDeSwgY3VyUmVjdCl7CiAgICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCk7CgogICAgICAgIC8vIENhbmRpZGF0ZSBzZWxlY3Rpb24gdXNlcyB0aGUgKnByZWRpY3RlZCogcmVjdCAoaGVscHMgInBsYW4gYWhlYWQiKQogICAgICAgIGNvbnN0IGNhbmQgPSBjb21wdXRlQ2FuZGlkYXRlKHByZWRDeCwgcHJlZEN5LCBwcmVkUmVjdCk7CgogICAgICAgIC8vIFVwZGF0ZSBwbGFubmVkIHRhcmdldCAodW5sZXNzIHdlJ3JlIGluIGEgc2hvcnQgcG9zdC1tb3ZlIGxvY2spCiAgICAgICAgaWYgKG5vdyA+PSAoZHJhZy5sb2NrVW50aWwgPz8gMCkpewogICAgICAgICAgdXBkYXRlUGxhbkZyb21DYW5kaWRhdGUoY2FuZCwgcHJlZFJlY3QsIG5vdyk7CiAgICAgICAgfQoKICAgICAgICAvLyBGb3IgY29tbWl0dGluZyB0aGUgbW92ZSwgdXNlIHRoZSAqY3VycmVudCB2aXN1YWwqIHJlY3QuCiAgICAgICAgLy8gUGljayB0aGUgZWxlbWVudCB3aXRoIHRoZSBzdHJvbmdlc3QgQ1VSUkVOVCBvdmVybGFwLgogICAgICAgIC8vIChQbGFubmluZyBjYW4gYmUgcHJlZGljdGl2ZTsgY29tbWl0dGluZyBzaG91bGQgZm9sbG93IHdoYXQgdGhlIHVzZXIgYWN0dWFsbHkgc2Vlcy4pCiAgICAgICAgY29uc3QgeyBvcmRlcjogY29tbWl0T3JkZXIgfSA9IGNvbXB1dGVSb3dNYWpvck9yZGVyKCk7CiAgICAgICAgbGV0IGNvbW1pdFRhcmdldCA9IG51bGw7CiAgICAgICAgbGV0IGJlc3RPdiA9IDA7CgogICAgICAgIGZvciAoY29uc3QgaXQgb2YgY29tbWl0T3JkZXIpewogICAgICAgICAgY29uc3Qgb3YgPSBvdmVybGFwU2NvcmUoY3VyUmVjdCwgaXQucmVjdCk7CiAgICAgICAgICBpZiAob3YgPiBiZXN0T3YpewogICAgICAgICAgICBiZXN0T3YgPSBvdjsKICAgICAgICAgICAgY29tbWl0VGFyZ2V0ID0gaXQuZWw7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBLZWVwIHRoZSBwcmV2aW91cyBjb21taXQgdGFyZ2V0IHVubGVzcyB0aGUgbmV3IG9uZSBpcyBjbGVhcmx5IGJldHRlciAoYW50aS1mbGlwKS4KICAgICAgICBpZiAoZHJhZy5jb21taXRUYXJnZXRFbCAmJiBjb21taXRUYXJnZXQgJiYgZHJhZy5jb21taXRUYXJnZXRFbCAhPT0gY29tbWl0VGFyZ2V0KXsKICAgICAgICAgIGNvbnN0IHByZXYgPSBjb21taXRPcmRlci5maW5kKGl0ID0+IGl0LmVsID09PSBkcmFnLmNvbW1pdFRhcmdldEVsKTsKICAgICAgICAgIGlmIChwcmV2KXsKICAgICAgICAgICAgY29uc3QgcHJldk92ID0gb3ZlcmxhcFNjb3JlKGN1clJlY3QsIHByZXYucmVjdCk7CiAgICAgICAgICAgIGlmIChwcmV2T3YgPj0gYmVzdE92IC0gT1ZFUkxBUF9IWVNUKXsKICAgICAgICAgICAgICBjb21taXRUYXJnZXQgPSBkcmFnLmNvbW1pdFRhcmdldEVsOwogICAgICAgICAgICAgIGJlc3RPdiA9IHByZXZPdjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFjb21taXRUYXJnZXQpIHJldHVybjsKCgogICAgICAgIC8vIFN0YWJsZSBjb21taXQgdGltZXIgaXMgcGVyLXRhcmdldAogICAgICAgIGlmIChkcmFnLmNvbW1pdFRhcmdldEVsICE9PSBjb21taXRUYXJnZXQpewogICAgICAgICAgZHJhZy5jb21taXRUYXJnZXRFbCA9IGNvbW1pdFRhcmdldDsKICAgICAgICAgIGRyYWcuY29tbWl0U2luY2UgPSAwOwogICAgICAgIH0KCiAgICAgICAgLy8gT25seSBjb21taXQgYSBtb3ZlIHdoZW4gb3ZlcmxhcCBpcyBzdHJvbmcgKD49IDgwJSkgQU5EIHN0YWJsZSBmb3IgYSBzaG9ydCB0aW1lLgogICAgICAgIGlmIChiZXN0T3YgPj0gQ09NTUlUX1RSSUdHRVIpewogICAgICAgICAgaWYgKCFkcmFnLmNvbW1pdFNpbmNlKSBkcmFnLmNvbW1pdFNpbmNlID0gbm93OwogICAgICAgICAgaWYgKG5vdyAtIGRyYWcuY29tbWl0U2luY2UgPCBDT01NSVRfU1RBQkxFX01TKSByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRyYWcuY29tbWl0U2luY2UgPSAwOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gIlRha2UgdGhlIHRhcmdldCdzIHNsb3QiOgogICAgICAgIC8vIC0gaWYgdGFyZ2V0IGlzIEFGVEVSIHRoZSBob2xlID0+IG1vdmUgaG9sZSBBRlRFUiB0YXJnZXQgKGRyYWdnZWQgY2FyZCBsYW5kcyBpbnRvIHRhcmdldCdzIGluZGV4KQogICAgICAgIC8vIC0gaWYgdGFyZ2V0IGlzIEJFRk9SRSB0aGUgaG9sZSA9PiBtb3ZlIGhvbGUgQkVGT1JFIHRhcmdldAogICAgICAgIGNvbnN0IGhvbGVQb3MgPSBkcmFnLnBsYWNlaG9sZGVyOwogICAgICAgIGNvbnN0IHRhcmdldEFmdGVySG9sZSA9ICEhKGhvbGVQb3MuY29tcGFyZURvY3VtZW50UG9zaXRpb24oY29tbWl0VGFyZ2V0KSAmIE5vZGUuRE9DVU1FTlRfUE9TSVRJT05fRk9MTE9XSU5HKTsKICAgICAgICBjb25zdCBjb21taXRSZWYgPSB0YXJnZXRBZnRlckhvbGUgPyBuZXh0Q2FyZEFmdGVyKGNvbW1pdFRhcmdldCkgOiBjb21taXRUYXJnZXQKCgogICAgICAgIGNvbnN0IGN1cnJlbnRSZWYgPSBuZXh0Q2FyZEFmdGVyKGRyYWcucGxhY2Vob2xkZXIpOwogICAgICAgIGlmIChjb21taXRSZWYgPT09IGN1cnJlbnRSZWYpIHJldHVybjsKCiAgICAgICAgLy8gRXh0cmEgYW50aS1jaGF0dGVyIGd1YXJkcyAodXNlIGN1cnJlbnQgY2VudGVyKQogICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmh5cG90KGN1ckN4IC0gKGRyYWcubGFzdE1vdmVDeCA/PyBjdXJDeCksIGN1ckN5IC0gKGRyYWcubGFzdE1vdmVDeSA/PyBjdXJDeSkpOwogICAgICAgIGlmIChub3cgLSBkcmFnLmxhc3RNb3ZlQXQgPCBNT1ZFX0NPT0xET1dOX01TKSByZXR1cm47CiAgICAgICAgaWYgKGRpc3QgPCBNT1ZFX0hZU1RfUFgpIHJldHVybjsKCiAgICAgICAgZmxpcEFuaW1hdGVBZnRlckRPTUNoYW5nZSgoKT0+ewogICAgICAgICAgZ3JpZC5pbnNlcnRCZWZvcmUoZHJhZy5wbGFjZWhvbGRlciwgY29tbWl0UmVmKTsKICAgICAgICB9KTsKCiAgICAgICAgZHJhZy5sYXN0TW92ZUF0ID0gbm93OwogICAgICAgIGRyYWcubGFzdE1vdmVDeCA9IGN1ckN4OwogICAgICAgIGRyYWcubGFzdE1vdmVDeSA9IGN1ckN5OwoKICAgICAgICAvLyBicmllZiBsb2NrIHByZXZlbnRzIGltbWVkaWF0ZSAidW5kbyIgd2hlbiBsYXlvdXQgc2hpZnRzCiAgICAgICAgZHJhZy5sb2NrVW50aWwgPSBub3cgKyBMT0NLX0FGVEVSX01PVkVfTVM7CiAgICAgICAgZHJhZy5jb21taXRTaW5jZSA9IDA7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG9uUG9pbnRlck1vdmUoZSl7CiAgICAgICAgaWYgKCFkcmFnIHx8IGUucG9pbnRlcklkICE9PSBkcmFnLnBvaW50ZXJJZCkgcmV0dXJuOwogICAgICAgIGRyYWcubGFzdENsaWVudFggPSBlLmNsaWVudFg7CiAgICAgICAgZHJhZy5sYXN0Q2xpZW50WSA9IGUuY2xpZW50WTsKICAgICAgICBpZiAoIXJhZklkKSByYWZJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYmVnaW5EcmFnKGhhbmRsZUVsLCBlKXsKICAgICAgICBjb25zdCBjYXJkID0gaGFuZGxlRWwuY2xvc2VzdCgnLmtpdC1jYXJkJyk7CiAgICAgICAgaWYgKCFjYXJkKSByZXR1cm47CiAgICAgICAgY29uc3Qga2l0SWQgPSBjYXJkLmRhdGFzZXQua2l0SWQ7CiAgICAgICAgaWYgKCFraXRJZCkgcmV0dXJuOwoKICAgICAgICAvLyBJZ25vcmUgaWYgZHJhZyBzdGFydGVkIG9uIGludGVyYWN0aXZlIGFjdGlvbnMKICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLmtpdC1hY3Rpb25zJykpIHJldHVybjsKCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CgogICAgICAgIGNvbnN0IHJlY3QgPSBjYXJkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGNvbnN0IHN0YXJ0Q3ggPSByZWN0LmxlZnQgKyByZWN0LndpZHRoLzI7CiAgICAgICAgY29uc3Qgc3RhcnRDeSA9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQvMjsKCiAgICAgICAgZHJhZyA9IHsKICAgICAgICAgIHBvaW50ZXJJZDogZS5wb2ludGVySWQsCiAgICAgICAgICBjYXJkLAogICAgICAgICAga2l0SWQsCiAgICAgICAgICBncmFiRHg6IGUuY2xpZW50WCAtIHJlY3QubGVmdCwKICAgICAgICAgIGdyYWJEeTogZS5jbGllbnRZIC0gcmVjdC50b3AsCiAgICAgICAgICB3OiByZWN0LndpZHRoLAogICAgICAgICAgaDogcmVjdC5oZWlnaHQsCiAgICAgICAgICBsYXN0Q2xpZW50WDogZS5jbGllbnRYLAogICAgICAgICAgbGFzdENsaWVudFk6IGUuY2xpZW50WSwKICAgICAgICAgIGFjdGl2ZTogdHJ1ZSwKICAgICAgICAgIHBsYWNlaG9sZGVyOiBtYWtlUGxhY2Vob2xkZXIoY2FyZCksCiAgICAgICAgICBsYXN0TW92ZUF0OiAwLAogICAgICAgICAgbGFzdE1vdmVDeDogc3RhcnRDeCwKICAgICAgICAgIGxhc3RNb3ZlQ3k6IHN0YXJ0Q3ksCiAgICAgICAgICAvLyBwbGFubmluZyAvIGNvbW1pdCBzdGF0ZSAoYW50aS1qaXR0ZXIpCiAgICAgICAgICBwbGFuRWw6IG51bGwsCiAgICAgICAgICBwbGFuU2V0QXQ6IDAsCiAgICAgICAgICBwbGFuU2NvcmU6IDAsCiAgICAgICAgICBwbGFuQ2FuZEVsOiBudWxsLAogICAgICAgICAgcGxhbkNhbmRTdGFydDogMCwKICAgICAgICAgIHBsYW5DYW5kU2NvcmU6IDAsCiAgICAgICAgICBjb21taXRTaW5jZTogMCwKICAgICAgICAgIGxvY2tVbnRpbDogMCwKCiAgICAgICAgICBjb21taXRUYXJnZXRFbDogbnVsbCwKCiAgICAgICAgICAvLyBzbW9vdGhlZCBwb3NpdGlvbiBmb3Igb3ZlcmxheSBjYXJkCiAgICAgICAgICBfc21vb3RoVG9wOiByZWN0LnRvcCwKICAgICAgICAgIF9zbW9vdGhMZWZ0OiByZWN0LmxlZnQsCgogICAgICAgICAgX3ByZXZVc2VyU2VsZWN0OiBkb2N1bWVudC5ib2R5LnN0eWxlLnVzZXJTZWxlY3QKICAgICAgICB9OwoKICAgICAgICAvLyBJbnNlcnQgcGxhY2Vob2xkZXIgd2hlcmUgdGhlIGNhcmQgd2FzCiAgICAgICAgZ3JpZC5pbnNlcnRCZWZvcmUoZHJhZy5wbGFjZWhvbGRlciwgY2FyZCk7CgogICAgICAgIC8vIExpZnQgY2FyZCBpbnRvIG92ZXJsYXkKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNhcmQpOwogICAgICAgIGNhcmQuY2xhc3NMaXN0LmFkZCgnaXMtZHJhZ2dpbmcnKTsKICAgICAgICBjYXJkLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJzsKICAgICAgICBjYXJkLnN0eWxlLnRvcCA9IHB4KHJlY3QudG9wKTsKICAgICAgICBjYXJkLnN0eWxlLmxlZnQgPSBweChyZWN0LmxlZnQpOwogICAgICAgIGNhcmQuc3R5bGUud2lkdGggPSBweChyZWN0LndpZHRoKTsKICAgICAgICBjYXJkLnN0eWxlLmhlaWdodCA9IHB4KHJlY3QuaGVpZ2h0KTsKICAgICAgICBjYXJkLnN0eWxlLnpJbmRleCA9ICc5OTk5JzsKICAgICAgICBjYXJkLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7CiAgICAgICAgY2FyZC5zdHlsZS5tYXJnaW4gPSAnMCc7CiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOwogICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUudXNlclNlbGVjdCA9ICdub25lJzsKCiAgICAgICAgLy8gTW92ZSBsb29wCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBvblBvaW50ZXJNb3ZlLCB0cnVlKTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCBlbmREcmFnLCB0cnVlKTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyY2FuY2VsJywgZW5kRHJhZywgdHJ1ZSk7CgogICAgICAgIGlmICghcmFmSWQpIHJhZklkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjbGVhbnVwRHJhZygpewogICAgICAgIGlmICghZHJhZykgcmV0dXJuOwoKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIG9uUG9pbnRlck1vdmUsIHRydWUpOwogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGVuZERyYWcsIHRydWUpOwogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJjYW5jZWwnLCBlbmREcmFnLCB0cnVlKTsKCiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnJzsKICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnVzZXJTZWxlY3QgPSBkcmFnLl9wcmV2VXNlclNlbGVjdCA/PyAnJzsKCiAgICAgICAgZHJhZy5jYXJkLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnaW5nJyk7CiAgICAgICAgZHJhZy5jYXJkLnN0eWxlLnBvc2l0aW9uID0gJyc7CiAgICAgICAgZHJhZy5jYXJkLnN0eWxlLnRvcCA9ICcnOwogICAgICAgIGRyYWcuY2FyZC5zdHlsZS5sZWZ0ID0gJyc7CiAgICAgICAgZHJhZy5jYXJkLnN0eWxlLndpZHRoID0gJyc7CiAgICAgICAgZHJhZy5jYXJkLnN0eWxlLmhlaWdodCA9ICcnOwogICAgICAgIGRyYWcuY2FyZC5zdHlsZS56SW5kZXggPSAnJzsKICAgICAgICBkcmFnLmNhcmQuc3R5bGUucG9pbnRlckV2ZW50cyA9ICcnOwogICAgICAgIGRyYWcuY2FyZC5zdHlsZS5tYXJnaW4gPSAnJzsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZW5kRHJhZyhlKXsKICAgICAgICBpZiAoIWRyYWcgfHwgKGUgJiYgZS5wb2ludGVySWQgIT09IGRyYWcucG9pbnRlcklkKSkgcmV0dXJuOwoKICAgICAgICBkcmFnLmFjdGl2ZSA9IGZhbHNlOwoKICAgICAgICAvLyBQdXQgY2FyZCBiYWNrIGludG8gZmxvdyBhdCBwbGFjZWhvbGRlciBwb3NpdGlvbgogICAgICAgIGlmIChkcmFnLnBsYWNlaG9sZGVyICYmIGRyYWcucGxhY2Vob2xkZXIucGFyZW50Tm9kZSl7CiAgICAgICAgICBncmlkLmluc2VydEJlZm9yZShkcmFnLmNhcmQsIGRyYWcucGxhY2Vob2xkZXIpOwogICAgICAgICAgZHJhZy5wbGFjZWhvbGRlci5yZW1vdmUoKTsKICAgICAgICB9CgogICAgICAgIGNsZWFudXBEcmFnKCk7CgogICAgICAgIC8vIFN5bmMgbW9kZWwgb3JkZXIKICAgICAgICB0cnl7CiAgICAgICAgICBjb25zdCBpZHMgPSBbLi4uZ3JpZC5xdWVyeVNlbGVjdG9yQWxsKCcua2l0LWNhcmQnKV0ubWFwKGVsID0+IGVsLmRhdGFzZXQua2l0SWQpOwogICAgICAgICAgY29uc3QgYnlJZCA9IG5ldyBNYXAoa2l0cy5tYXAoayA9PiBbU3RyaW5nKGsuaWQpLCBrXSkpOwogICAgICAgICAga2l0cyA9IGlkcy5tYXAoaWQgPT4gYnlJZC5nZXQoU3RyaW5nKGlkKSkpLmZpbHRlcihCb29sZWFuKTsKICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgIH1jYXRjaChfKXt9CgogICAgICAgIGRyYWcgPSBudWxsOwogICAgICB9CgogICAgICBmdW5jdGlvbiB0aWNrKCl7CiAgICAgICAgcmFmSWQgPSAwOwogICAgICAgIGlmICghZHJhZyB8fCAhZHJhZy5hY3RpdmUpIHJldHVybjsKCiAgICAgICAgdmlld3BvcnRBdXRvU2Nyb2xsKGRyYWcubGFzdENsaWVudFgsIGRyYWcubGFzdENsaWVudFkpOwoKICAgICAgICBjb25zdCB7IHRvcCwgbGVmdCB9ID0gZ2V0RHJhZ1RvcExlZnQoKTsKICAgICAgICBkcmFnLmNhcmQuc3R5bGUudG9wID0gcHgodG9wKTsKICAgICAgICBkcmFnLmNhcmQuc3R5bGUubGVmdCA9IHB4KGxlZnQpOwoKICAgICAgICAvLyBkZWNpc2lvbiB1c2VzIHRoZSBDQVJEIGNlbnRlciwgbm90IHRoZSBjdXJzb3IKICAgICAgICBjb25zdCBkcmFnQ3ggPSBsZWZ0ICsgZHJhZy53LzI7CiAgICAgICAgY29uc3QgZHJhZ0N5ID0gdG9wICsgZHJhZy5oLzI7CgogICAgICAgIC8vIHZlbG9jaXR5LWJhc2VkIGxvb2stYWhlYWQgKHN0aWxsIGRlcml2ZWQgZnJvbSB0aGUgY2FyZCdzIG1vdGlvbikKICAgICAgICBjb25zdCBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgICBjb25zdCBkdCA9IE1hdGgubWF4KDgsIG5vdyAtIChkcmFnLl9wcmV2VCA/PyBub3cpKTsKICAgICAgICBjb25zdCB2eCA9IChkcmFnQ3ggLSAoZHJhZy5fcHJldkN4ID8/IGRyYWdDeCkpIC8gZHQ7IC8vIHB4IHBlciBtcwogICAgICAgIGNvbnN0IHZ5ID0gKGRyYWdDeSAtIChkcmFnLl9wcmV2Q3kgPz8gZHJhZ0N5KSkgLyBkdDsKCiAgICAgICAgLy8gY2xhbXAgdG8gYXZvaWQgd2lsZCBqdW1wcyBvbiBmaXJzdCBmcmFtZXMKICAgICAgICBjb25zdCBjdnggPSBjbGFtcCh2eCwgLTEuMiwgMS4yKTsKICAgICAgICBjb25zdCBjdnkgPSBjbGFtcCh2eSwgLTEuMiwgMS4yKTsKCiAgICAgICAgY29uc3QgcHJlZEN4ID0gZHJhZ0N4ICsgY3Z4ICogUFJFRElDVF9NUzsKICAgICAgICBjb25zdCBwcmVkQ3kgPSBkcmFnQ3kgKyBjdnkgKiBQUkVESUNUX01TOwoKICAgICAgICBkcmFnLl9wcmV2VCA9IG5vdzsKICAgICAgICBkcmFnLl9wcmV2Q3ggPSBkcmFnQ3g7CiAgICAgICAgZHJhZy5fcHJldkN5ID0gZHJhZ0N5OwoKICAgICAgICBjb25zdCBkZWNpc2lvblJlY3QgPSByZWN0RnJvbUNlbnRlcihwcmVkQ3gsIHByZWRDeSwgZHJhZy53LCBkcmFnLmgpOwoKICAgICAgICBjb25zdCBjdXJyZW50UmVjdCA9IHJlY3RGcm9tQ2VudGVyKGRyYWdDeCwgZHJhZ0N5LCBkcmFnLncsIGRyYWcuaCk7CgogICAgICAgIG1heWJlTW92ZUhvbGUocHJlZEN4LCBwcmVkQ3ksIGRlY2lzaW9uUmVjdCwgZHJhZ0N4LCBkcmFnQ3ksIGN1cnJlbnRSZWN0KTsKCiAgICAgICAgcmFmSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7CiAgICAgIH0KCiAgICAgIC8vIERlbGVnYXRlIHBvaW50ZXJkb3duIHRvIGhhbmRsZXMKICAgICAgZ3JpZC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIChlKT0+ewogICAgICAgIGNvbnN0IGhhbmRsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5raXQtZHJhZy1oYW5kbGUnKTsKICAgICAgICBpZiAoIWhhbmRsZSkgcmV0dXJuOwogICAgICAgIGJlZ2luRHJhZyhoYW5kbGUsIGUpOwogICAgICB9LCB0cnVlKTsKICAgIH0pKCk7OwoKCiAgICAvKiA9PT09PSBJbml0aWFsIHJlbmRlciA9PT09PSAqLwogICAgcmVuZGVyKCk7CiAgPC9zY3JpcHQ+CiAgPHNjcmlwdD4KICAgICAgICAKICAgICAgICAvLyDQkNCy0YLQvi3RiNC40YDQuNC90LAg0LTQu9GPINC/0L7Qu9GPICLQotC40L8g0YHRgdGL0LvQutC4IiAo0YDQsNGB0YLRj9Cz0LjQstCw0LXRgtGB0Y8g0L/QviDQstCy0LXQtNGR0L3QvdC+0LzRgyDRgtC10LrRgdGC0YMsCiAgICAgICAgLy8g0L3QviDQuNGB0YXQvtC00L3QvtC1INC/0YPRgdGC0L7QtSDRgdC+0YHRgtC+0Y/QvdC40LUg0L7RgdGC0LDRkdGC0YHRjyDRhNC40LrRgdC40YDQvtCy0LDQvdC90YvQvCkKICAgICAgICBjb25zdCBfX21lYXN1cmVDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgICAgICBjb25zdCBfX21lYXN1cmVDdHggPSBfX21lYXN1cmVDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlTGlua1R5cGVXaWR0aCh0eXBlSW5wdXQpIHsKICAgICAgICAgICAgaWYgKCF0eXBlSW5wdXQpIHJldHVybjsKCiAgICAgICAgICAgIGNvbnN0IHZhbCA9ICh0eXBlSW5wdXQudmFsdWUgfHwgJycpLnRyaW0oKTsKCiAgICAgICAgICAgIC8vINC40YHRhdC+0LTQvdC+0LUg0L/Rg9GB0YLQvtC1INGB0L7RgdGC0L7Rj9C90LjQtSDigJQg0LrQsNC6INGB0LXQudGH0LDRgQogICAgICAgICAgICBpZiAoIXZhbCkgewogICAgICAgICAgICAgICAgdHlwZUlucHV0LnN0eWxlLndpZHRoID0gJzEyMHB4JzsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g0JjQt9C80LXRgNGP0LXQvCDRgtC10LrRgdGCINGBINGC0LXQvCDQttC1INGI0YDQuNGE0YLQvtC8CiAgICAgICAgICAgIGNvbnN0IGNzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodHlwZUlucHV0KTsKICAgICAgICAgICAgX19tZWFzdXJlQ3R4LmZvbnQgPSBgJHtjcy5mb250V2VpZ2h0fSAke2NzLmZvbnRTaXplfSAke2NzLmZvbnRGYW1pbHl9YDsKCiAgICAgICAgICAgIGNvbnN0IHRleHRXID0gX19tZWFzdXJlQ3R4Lm1lYXN1cmVUZXh0KHZhbCkud2lkdGg7CiAgICAgICAgICAgIGNvbnN0IHBhZGRpbmdMZWZ0ID0gcGFyc2VGbG9hdChjcy5wYWRkaW5nTGVmdCkgfHwgMDsKICAgICAgICAgICAgY29uc3QgcGFkZGluZ1JpZ2h0ID0gcGFyc2VGbG9hdChjcy5wYWRkaW5nUmlnaHQpIHx8IDA7CiAgICAgICAgICAgIGNvbnN0IGJvcmRlckxlZnQgPSBwYXJzZUZsb2F0KGNzLmJvcmRlckxlZnRXaWR0aCkgfHwgMDsKICAgICAgICAgICAgY29uc3QgYm9yZGVyUmlnaHQgPSBwYXJzZUZsb2F0KGNzLmJvcmRlclJpZ2h0V2lkdGgpIHx8IDA7CgogICAgICAgICAgICAvLyArINC90LXQsdC+0LvRjNGI0LDRjyDRgdGC0YDQsNGF0L7QstC60LAKICAgICAgICAgICAgbGV0IGRlc2lyZWQgPSBNYXRoLmNlaWwodGV4dFcgKyBwYWRkaW5nTGVmdCArIHBhZGRpbmdSaWdodCArIGJvcmRlckxlZnQgKyBib3JkZXJSaWdodCArIDEyKTsKCiAgICAgICAgICAgIC8vINCe0LPRgNCw0L3QuNGH0LjQstCw0LXQvCDQv9C+INC00L7RgdGC0YPQv9C90L7QvNGDINC80LXRgdGC0YM6INGC0LjQvyDRgtGP0L3QtdGC0YHRjywg0YHQtNCy0LjQs9Cw0Y8gVVJMINCy0L/RgNCw0LLQviwKICAgICAgICAgICAgLy8g0L3QviDQvtGB0YLQsNCy0LvRj9C10Lwg0LzQuNC90LjQvNCw0LvRjNC90L7QtSDQvNC10YHRgtC+INC/0L7QtCBVUkwg0Lgg0LrQvdC+0L/QutC4CiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0eXBlSW5wdXQuY2xvc2VzdCgnLmxpbmstaXRlbScpOwogICAgICAgICAgICBjb25zdCBlZGl0Um93ID0gdHlwZUlucHV0LmNsb3Nlc3QoJy5saW5rLWVkaXQnKTsKICAgICAgICAgICAgY29uc3QgYWN0aW9ucyA9IGl0ZW0gPyBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy5saW5rLWFjdGlvbnMnKSA6IG51bGw7CgogICAgICAgICAgICBjb25zdCB1cmxNaW4gPSAxNDA7IC8vINC80LjQvdC40LzQsNC70YzQvdC+INC/0L7QtCBVUkwKICAgICAgICAgICAgbGV0IGF2YWlsYWJsZSA9IG51bGw7CgogICAgICAgICAgICBpZiAoaXRlbSAmJiBlZGl0Um93ICYmIGFjdGlvbnMpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1XID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDsKICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbnNXID0gYWN0aW9ucy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDsKCiAgICAgICAgICAgICAgICAvLyBnYXAg0LzQtdC20LTRgyAubGluay1lZGl0INC4IC5saW5rLWFjdGlvbnMg4oCUINC+0L0g0LfQsNC00LDQvSDRgyAubGluay1pdGVtCiAgICAgICAgICAgICAgICBjb25zdCBpdGVtQ1MgPSBnZXRDb21wdXRlZFN0eWxlKGl0ZW0pOwogICAgICAgICAgICAgICAgY29uc3QgcGFkTCA9IHBhcnNlRmxvYXQoaXRlbUNTLnBhZGRpbmdMZWZ0KSB8fCAwOwogICAgICAgICAgICAgICAgY29uc3QgcGFkUiA9IHBhcnNlRmxvYXQoaXRlbUNTLnBhZGRpbmdSaWdodCkgfHwgMDsKICAgICAgICAgICAgICAgIGNvbnN0IG91dGVyR2FwID0gcGFyc2VGbG9hdChpdGVtQ1MuZ2FwKSB8fCAwOwoKICAgICAgICAgICAgICAgIGF2YWlsYWJsZSA9IGl0ZW1XIC0gcGFkTCAtIHBhZFIgLSBhY3Rpb25zVyAtIG91dGVyR2FwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoYXZhaWxhYmxlKSB7CiAgICAgICAgICAgICAgICAvLyBnYXAg0LLQvdGD0YLRgNC4IGVkaXRSb3cg0LzQtdC20LTRgyDQv9C+0LvRj9C80LgKICAgICAgICAgICAgICAgIGNvbnN0IGdhcCA9IHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZShlZGl0Um93KS5nYXApIHx8IDA7CiAgICAgICAgICAgICAgICBjb25zdCBtYXhUeXBlID0gTWF0aC5tYXgoMTIwLCBhdmFpbGFibGUgLSB1cmxNaW4gLSBnYXApOwogICAgICAgICAgICAgICAgZGVzaXJlZCA9IE1hdGgubWluKGRlc2lyZWQsIG1heFR5cGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkZXNpcmVkID0gTWF0aC5tYXgoZGVzaXJlZCwgMTIwKTsKICAgICAgICAgICAgdHlwZUlucHV0LnN0eWxlLndpZHRoID0gZGVzaXJlZCArICdweCc7CiAgICAgICAgfQoKICAgICAgICAvLyDQsNCy0YLQvi3RgNC+0YHRgiB0ZXh0YXJlYSDQv9C+INCy0YvRgdC+0YLQtQogICAgICAgIGZ1bmN0aW9uIGF1dG9zaXplVGV4dGFyZWEoZWwpIHsKICAgICAgICAgICAgaWYgKCFlbCkgcmV0dXJuOwogICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7CiAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9IChlbC5zY3JvbGxIZWlnaHQpICsgJ3B4JzsKICAgICAgICB9CgogICAgICAgIC8vINCf0L7QtNGB0YLRgNCw0LjQstCw0LXQvCDRiNC40YDQuNC90YMg0L/RgNC4INC40LfQvNC10L3QtdC90LjQuCDRgNCw0LfQvNC10YDQsCDQvtC60L3QsAogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saW5rLWl0ZW0uZWRpdGluZyAubGluay10eXBlLWlucHV0JykuZm9yRWFjaChpbnAgPT4gdXBkYXRlTGlua1R5cGVXaWR0aChpbnApKTsKICAgICAgICB9KTsKCgogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUVtcHR5U3RhdGVzKCkgewogICAgICAgICAgICBjb25zdCBjb21tZW50c0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudHNMaXN0Jyk7CiAgICAgICAgICAgIGNvbnN0IGxpbmtzTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5rc0xpc3QnKTsKICAgICAgICAgICAgY29uc3QgY29tbWVudHNTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRzU2VjdGlvbicpOwogICAgICAgICAgICBjb25zdCBsaW5rc1NlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua3NTZWN0aW9uJyk7CgogICAgICAgICAgICBpZiAoY29tbWVudHNTZWN0aW9uICYmIGNvbW1lbnRzTGlzdCkgewogICAgICAgICAgICAgICAgY29uc3QgaGFzQ29tbWVudHMgPSBjb21tZW50c0xpc3QucXVlcnlTZWxlY3RvcignLmNvbW1lbnQtYmxvY2snKSAhPT0gbnVsbDsKICAgICAgICAgICAgICAgIGNvbW1lbnRzU2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1lbXB0eScsICFoYXNDb21tZW50cyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxpbmtzU2VjdGlvbiAmJiBsaW5rc0xpc3QpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGhhc0xpbmtzID0gbGlua3NMaXN0LnF1ZXJ5U2VsZWN0b3IoJy5saW5rLWl0ZW0nKSAhPT0gbnVsbDsKICAgICAgICAgICAgICAgIGxpbmtzU2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1lbXB0eScsICFoYXNMaW5rcyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgovLyDQpNGD0L3QutGG0LjRjyDQtNC70Y8g0YHQstC+0YDQsNGH0LjQstCw0L3QuNGPL9GA0LDQt9Cy0L7RgNCw0YfQuNCy0LDQvdC40Y8g0LHQu9C+0LrQvtCyCiAgICAgICAgZnVuY3Rpb24gc2V0dXBDb2xsYXBzZShoZWFkZXJJZCwgY29udGVudElkLCBpY29uSWQsIGRlZmF1bHRFeHBhbmRlZCA9IGZhbHNlKSB7CiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhlYWRlcklkKTsKICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbnRlbnRJZCk7CiAgICAgICAgICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpY29uSWQpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKCFoZWFkZXIgfHwgIWNvbnRlbnQgfHwgIWljb24pIHJldHVybjsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChkZWZhdWx0RXhwYW5kZWQpIHsKICAgICAgICAgICAgICAgIGNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7CiAgICAgICAgICAgICAgICBpY29uLmNsYXNzTGlzdC5hZGQoJ2V4cGFuZGVkJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb250ZW50LmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOwogICAgICAgICAgICAgICAgaWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdleHBhbmRlZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBoZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGNvbnRlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJyk7CiAgICAgICAgICAgICAgICBpY29uLmNsYXNzTGlzdC50b2dnbGUoJ2V4cGFuZGVkJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8g0KPQv9GA0LDQstC70LXQvdC40LUg0LrQvtC80LzQtdC90YLQsNGA0LjRj9C80Lgg0Lgg0YHRgdGL0LvQutCw0LzQuAogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgLy8g0JjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8g0YHQstC+0YDQsNGH0LjQstCw0L3QuNGPCiAgICAgICAgICAgIHNldHVwQ29sbGFwc2UoJ21haW5TcGVjc0hlYWRlcicsICdtYWluU3BlY3NDb250ZW50JywgJ21haW5TcGVjc0ljb24nLCBmYWxzZSk7CiAgICAgICAgICAgIHNldHVwQ29sbGFwc2UoJ2RvY3NIZWFkZXInLCAnZG9jc0NvbnRlbnQnLCAnZG9jc0ljb24nLCBmYWxzZSk7CiAgICAgICAgICAgIHNldHVwQ29sbGFwc2UoJ2ZpbmFuY2VIZWFkZXInLCAnZmluYW5jZUNvbnRlbnQnLCAnZmluYW5jZUljb24nLCBmYWxzZSk7CiAgICAgICAgICAgIHNldHVwQ29sbGFwc2UoJ2FkZGl0aW9uYWxIZWFkZXInLCAnYWRkaXRpb25hbENvbnRlbnQnLCAnYWRkaXRpb25hbEljb24nLCBmYWxzZSk7CgogICAgICAgICAgICAvLyDQmtC90L7Qv9C60LAg0L3QsNC30LDQtAogICAgICAgICAgICBjb25zdCBiYWNrQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhY2tCdXR0b24nKTsKICAgICAgICAgICAgaWYgKGJhY2tCdG4pIHsKICAgICAgICAgICAgICAgIGJhY2tCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBhbGVydCgn0JLQvtC30LLRgNCw0YIg0Log0YHQv9C40YHQutGDINCw0LLRgtC+0LzQvtCx0LjQu9C10LknKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgovLyDQk9C70L7QsdCw0LvRjNC90YvQuSDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQutC70LjQutC+0LIg0LTQu9GPINCy0YvRhdC+0LTQsCDQuNC3INGA0LXQttC40LzQsCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPCiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgLy8g0JXRgdC70Lgg0LrQu9C40Log0L3QtSDQv9C+INGA0LXQtNCw0LrRgtC40YDRg9C10LzQvtC80YMg0LHQu9C+0LrRgyDQuCDQvdC1INC/0L4g0LXQs9C+INC60L3QvtC/0LrQsNC8CiAgICAgICAgICAgICAgICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoJy5jb21tZW50LWJsb2NrLmVkaXRpbmcnKSAmJiAKICAgICAgICAgICAgICAgICAgICAhZS50YXJnZXQuY2xvc2VzdCgnLmxpbmstaXRlbS5lZGl0aW5nJykgJiYKICAgICAgICAgICAgICAgICAgICAhZS50YXJnZXQuY2xvc2VzdCgnLmVkaXQtYnV0dG9uJykgJiYKICAgICAgICAgICAgICAgICAgICAhZS50YXJnZXQuY2xvc2VzdCgnLmRlbGV0ZS1idXR0b24nKSkgewogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vINCS0YvRhdC+0LTQuNC8INC40Lcg0YDQtdC20LjQvNCwINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8g0LLRgdC10YUg0LHQu9C+0LrQvtCyCiAgICAgICAgICAgICAgICAgICAgZXhpdEFsbEVkaXRNb2RlcygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIC8vINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC60L7QsiDQtNC70Y8g0YHRg9GJ0LXRgdGC0LLRg9GO0YnQuNGFINGN0LvQtdC80LXQvdGC0L7QsgogICAgICAgICAgICBpbml0RXhpc3RpbmdJdGVtcygpOwogICAgICAgICAgICAvLyDQodC+0YHRgtC+0Y/QvdC40Y8g0L/Rg9GB0YLRi9GFINGB0L/QuNGB0LrQvtCyICjRgdC60YDRi9Cy0LDQtdC8INC/0YPRgdGC0YvQtSDQutC+0L3RgtC10LnQvdC10YDRiyDQuCDQvdC1INGD0LTQstCw0LjQstCw0LXQvCDQvtGC0YHRgtGD0L/RiykKICAgICAgICAgICAgdXBkYXRlRW1wdHlTdGF0ZXMoKTsKCiAgICAgICAgICAgIC8vINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDQtNC+0LHQsNCy0LvQtdC90LjRjyDQutC+0LzQvNC10L3RgtCw0YDQuNGPCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRDb21tZW50QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgYWRkTmV3Q29tbWVudCgpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIC8vINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDQtNC+0LHQsNCy0LvQtdC90LjRjyDRgdGB0YvQu9C60LgKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZExpbmtCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICBhZGROZXdMaW5rKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICAvLyDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDQvtCx0YDQsNCx0L7RgtGH0LjQutC+0LIg0LTQu9GPINGB0YPRidC10YHRgtCy0YPRjtGJ0LjRhSDRjdC70LXQvNC10L3RgtC+0LIKICAgICAgICBmdW5jdGlvbiBpbml0RXhpc3RpbmdJdGVtcygpIHsKICAgICAgICAgICAgLy8g0JrQvtC80LzQtdC90YLQsNGA0LjQuAogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29tbWVudC1ibG9jazpub3QoLmVkaXRpbmcpJykuZm9yRWFjaChibG9jayA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBlZGl0QnRuID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmVkaXQtYnV0dG9uJyk7CiAgICAgICAgICAgICAgICBpZiAoZWRpdEJ0bikgewogICAgICAgICAgICAgICAgICAgIGVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyQ29tbWVudEVkaXRNb2RlKGJsb2NrKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyDQodGB0YvQu9C60LgKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpbmstaXRlbTpub3QoLmVkaXRpbmcpJykuZm9yRWFjaChibG9jayA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBlZGl0QnRuID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmVkaXQtYnV0dG9uJyk7CiAgICAgICAgICAgICAgICBpZiAoZWRpdEJ0bikgewogICAgICAgICAgICAgICAgICAgIGVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyTGlua0VkaXRNb2RlKGJsb2NrKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvLyDQktGL0YXQvtC0INC40Lcg0LLRgdC10YUg0YDQtdC20LjQvNC+0LIg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjwogICAgICAgIGZ1bmN0aW9uIGV4aXRBbGxFZGl0TW9kZXMoKSB7CiAgICAgICAgICAgIC8vINCa0L7QvNC80LXQvdGC0LDRgNC40LgKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbW1lbnQtYmxvY2suZWRpdGluZycpLmZvckVhY2goYmxvY2sgPT4gewogICAgICAgICAgICAgICAgZXhpdENvbW1lbnRFZGl0TW9kZShibG9jaywgdHJ1ZSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8g0KHRgdGL0LvQutC4CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saW5rLWl0ZW0uZWRpdGluZycpLmZvckVhY2goYmxvY2sgPT4gewogICAgICAgICAgICAgICAgZXhpdExpbmtFZGl0TW9kZShibG9jaywgdHJ1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8g0KDQtdC20LjQvCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINC60L7QvNC80LXQvdGC0LDRgNC40Y8KICAgICAgICBmdW5jdGlvbiBlbnRlckNvbW1lbnRFZGl0TW9kZShibG9jaykgewogICAgICAgICAgICAvLyDQktGL0YXQvtC00LjQvCDQuNC3INC00YDRg9Cz0LjRhSDRgNC10LbQuNC80L7QsgogICAgICAgICAgICBleGl0QWxsRWRpdE1vZGVzKCk7CgogICAgICAgICAgICBjb25zdCB0ZXh0RWxlbWVudCA9IGJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50LXRleHQnKTsKICAgICAgICAgICAgY29uc3QgY3VycmVudFRleHQgPSB0ZXh0RWxlbWVudCA/ICh0ZXh0RWxlbWVudC50ZXh0Q29udGVudCB8fCAnJykgOiAnJzsKICAgICAgICAgICAgY29uc3QgaXNOZXcgPSBibG9jay5kYXRhc2V0LmlzTmV3Q29tbWVudCA9PT0gJzEnOwoKICAgICAgICAgICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INGC0LXQutGD0YnQuNC5INC60L7QvdGC0LXQvdGCCiAgICAgICAgICAgIGJsb2NrLmRhdGFzZXQub3JpZ2luYWxUZXh0ID0gY3VycmVudFRleHQ7CgogICAgICAgICAgICBibG9jay5jbGFzc0xpc3QuYWRkKCdlZGl0aW5nJyk7CiAgICAgICAgICAgIGJsb2NrLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz0iY29tbWVudC1pbnB1dCIgcGxhY2Vob2xkZXI9ItCS0LLQtdC00LjRgtC1INC60L7QvNC80LXQvdGC0LDRgNC40LkiIHJvd3M9IjEiPjwvdGV4dGFyZWE+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uLWJ0biBpY29uLWJ0bi0tZGFuZ2VyIGRlbGV0ZS1idXR0b24iIHRpdGxlPSLQo9C00LDQu9C40YLRjCI+CiAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSI+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNNSAyMGEyIDIgMCAwIDAgMiAyaDEwYTIgMiAwIDAgMCAyLTJWOGgyVjZoLTRWNGEyIDIgMCAwIDAtMi0ySDlhMiAyIDAgMCAwLTIgMnYySDN2Mmgyek05IDRoNnYySDl6TTggOGg5djEySDdWOHoiLz48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik05IDEwaDJ2OEg5em00IDBoMnY4aC0yeiIvPjwvc3ZnPjwvYnV0dG9uPgogICAgICAgICAgICBgOwoKICAgICAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBibG9jay5xdWVyeVNlbGVjdG9yKCcuY29tbWVudC1pbnB1dCcpOwoKICAgICAgICAgICAgLy8g0LfQsNC/0L7Qu9C90Y/QtdC8INC4INGA0LDRgdGC0Y/Qs9C40LLQsNC10Lwg0L/QviDRgtC10LrRgdGC0YMKICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSBjdXJyZW50VGV4dDsKICAgICAgICAgICAgYXV0b3NpemVUZXh0YXJlYSh0ZXh0YXJlYSk7CiAgICAgICAgICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gYXV0b3NpemVUZXh0YXJlYSh0ZXh0YXJlYSkpOwoKICAgICAgICAgICAgLy8g0LrRg9GA0YHQvtGAINCyINC60L7QvdC10YYg0Lgg0LHQtdC3INGB0LrRgNC+0LvQuy3RgdC80LXRidC10L3QuNGPCiAgICAgICAgICAgIHRyeSB7IHRleHRhcmVhLmZvY3VzKHsgcHJldmVudFNjcm9sbDogdHJ1ZSB9KTsgfSBjYXRjaCAoZSkgeyB0ZXh0YXJlYS5mb2N1cygpOyB9CiAgICAgICAgICAgIGNvbnN0IGVuZCA9IHRleHRhcmVhLnZhbHVlLmxlbmd0aDsKICAgICAgICAgICAgdGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UoZW5kLCBlbmQpOwogICAgICAgICAgICB0ZXh0YXJlYS52YWx1ZSA9IGN1cnJlbnRUZXh0OwogICAgICAgICAgICB0ZXh0YXJlYS5mb2N1cygpOwogICAgICAgICAgICB0ZXh0YXJlYS5zZXRTZWxlY3Rpb25SYW5nZSh0ZXh0YXJlYS52YWx1ZS5sZW5ndGgsIHRleHRhcmVhLnZhbHVlLmxlbmd0aCk7CgogICAgICAgICAgICAvLyBFbnRlci9Fc2NhcGUg0YPQv9GA0LDQstC70Y/RjtGCINC30LDQstC10YDRiNC10L3QuNC10Lwg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjwogICAgICAgICAgICAvLyAtIEVudGVyOiDRgdC+0YXRgNCw0L3QuNGC0Ywg0Lgg0LLRi9C50YLQuAogICAgICAgICAgICAvLyAtIFNoaWZ0K0VudGVyOiDQv9C10YDQtdC90L7RgSDRgdGC0YDQvtC60LgKICAgICAgICAgICAgLy8gLSBFc2NhcGU6INC+0YLQvNC10L3QsCDQuCDQstGL0YXQvtC0CiAgICAgICAgICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihldikgewogICAgICAgICAgICAgICAgaWYgKGV2LmtleSA9PT0gJ0VzY2FwZScpIHsKICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgIGV4aXRDb21tZW50RWRpdE1vZGUoYmxvY2ssIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZXYua2V5ID09PSAnRW50ZXInICYmICFldi5zaGlmdEtleSkgewogICAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7IC8vINC90LUg0LTQvtCx0LDQstC70Y/QtdC8INC/0LXRgNC10LLQvtC0INGB0YLRgNC+0LrQuAogICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgIGV4aXRDb21tZW50RWRpdE1vZGUoYmxvY2ssIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0YPQtNCw0LvQtdC90LjRjwogICAgICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBibG9jay5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLWJ1dHRvbicpOwogICAgICAgICAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgaWYgKCF3aW5kb3cuY29uZmlybSgn0KPQtNCw0LvQuNGC0Ywg0LrQvtC80LzQtdC90YLQsNGA0LjQuT8nKSkgcmV0dXJuOwogICAgICAgICAgICAgICAgYmxvY2sucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB1cGRhdGVFbXB0eVN0YXRlcygpOwogICAgICAgICAgICB9KTt9CgogICAgICAgIC8vINCS0YvRhdC+0LQg0LjQtyDRgNC10LbQuNC80LAg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjyDQutC+0LzQvNC10L3RgtCw0YDQuNGPCiAgICAgICAgZnVuY3Rpb24gZXhpdENvbW1lbnRFZGl0TW9kZShibG9jaywgc2F2ZSA9IHRydWUpIHsKICAgICAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBibG9jay5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYScpOwogICAgICAgICAgICBjb25zdCBpc05ldyA9IGJsb2NrLmRhdGFzZXQuaXNOZXdDb21tZW50ID09PSAnMSc7CgogICAgICAgICAgICBjb25zdCBvcmlnaW5hbFRleHQgPSBibG9jay5kYXRhc2V0Lm9yaWdpbmFsVGV4dCB8fCAnJzsKCiAgICAgICAgICAgIGlmIChzYXZlICYmIHRleHRhcmVhKSB7CiAgICAgICAgICAgICAgICBjb25zdCBuZXdUZXh0ID0gdGV4dGFyZWEudmFsdWUudHJpbSgpOwoKICAgICAgICAgICAgICAgIGlmIChuZXdUZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INC40LfQvNC10L3QtdC90LjRjwogICAgICAgICAgICAgICAgICAgIGJsb2NrLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29tbWVudC10ZXh0Ij4ke25ld1RleHR9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYXJrIGVkaXQtYnV0dG9uIiB0aXRsZT0i0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwiIGFyaWEtbGFiZWw9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIj48c3BhbiBjbGFzcz0iaWNvbiI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTYgMi4wMTJsMyAzTDE2LjcxMyA3LjNsLTMtM3pNNCAxNHYzaDNsOC4yOTktOC4yODdsLTMtM3ptMCA2aDE2djJINHoiIGZpbGw9ImN1cnJlbnRDb2xvciIvPjwvc3ZnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyDQn9GD0YHRgtC+0Lkg0YLQtdC60YHRgiDQt9Cw0L/RgNC10YnRkdC9OgogICAgICAgICAgICAgICAgICAgIC8vIC0g0LTQu9GPINC90L7QstC+0LPQviDQutC+0LzQvNC10L3RgtCw0YDQuNGPOiDRg9C00LDQu9GP0LXQvCDQsdC70L7QugogICAgICAgICAgICAgICAgICAgIC8vIC0g0LTQu9GPINGB0YPRidC10YHRgtCy0YPRjtGJ0LXQs9C+OiDQvtGC0LrQsNGC0YvQstCw0LXQvCDQutCw0Log0LHRi9C70L4KICAgICAgICAgICAgICAgICAgICBpZiAoaXNOZXcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUVtcHR5U3RhdGVzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYmxvY2suaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb21tZW50LXRleHQiPiR7b3JpZ2luYWxUZXh0fTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uLWJ0biBpY29uLWJ0bi0tZGFyayBlZGl0LWJ1dHRvbiIgdGl0bGU9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIiBhcmlhLWxhYmVsPSLQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCI+PHNwYW4gY2xhc3M9Imljb24iPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE2IDIuMDEybDMgM0wxNi43MTMgNy4zbC0zLTN6TTQgMTR2M2gzbDguMjk5LTguMjg3bC0zLTN6bTAgNmgxNnYySDR6IiBmaWxsPSJjdXJyZW50Q29sb3IiLz48L3N2Zz48L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vINCe0YLQvNC10L3QsCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPOgogICAgICAgICAgICAgICAgLy8gLSDQvdC+0LLRi9C5INC/0YPRgdGC0L7QuSDQsdC70L7QuiDQvdC1INGB0L7RhdGA0LDQvdGP0LXQvAogICAgICAgICAgICAgICAgLy8gLSDRgdGD0YnQtdGB0YLQstGD0Y7RidC40Lkg0L7RgtC60LDRgtGL0LLQsNC10LwKICAgICAgICAgICAgICAgIGlmIChpc05ldyAmJiAhb3JpZ2luYWxUZXh0LnRyaW0oKSkgewogICAgICAgICAgICAgICAgICAgIGJsb2NrLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZUVtcHR5U3RhdGVzKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYmxvY2suaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbW1lbnQtdGV4dCI+JHtvcmlnaW5hbFRleHR9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbi1idG4gaWNvbi1idG4tLWRhcmsgZWRpdC1idXR0b24iIHRpdGxlPSLQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCIgYXJpYS1sYWJlbD0i0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwiPjxzcGFuIGNsYXNzPSJpY29uIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xNiAyLjAxMmwzIDNMMTYuNzEzIDcuM2wtMy0zek00IDE0djNoM2w4LjI5OS04LjI4N2wtMy0zem0wIDZoMTZ2Mkg0eiIgZmlsbD0iY3VycmVudENvbG9yIi8+PC9zdmc+PC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnZWRpdGluZycpOwogICAgICAgICAgICBkZWxldGUgYmxvY2suZGF0YXNldC5vcmlnaW5hbFRleHQ7CiAgICAgICAgICAgIGRlbGV0ZSBibG9jay5kYXRhc2V0LmlzTmV3Q29tbWVudDsKCiAgICAgICAgICAgIGNvbnN0IG5ld0VkaXRCdG4gPSBibG9jay5xdWVyeVNlbGVjdG9yKCcuZWRpdC1idXR0b24nKTsKICAgICAgICAgICAgaWYgKG5ld0VkaXRCdG4pIHsKICAgICAgICAgICAgICAgIG5ld0VkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICBlbnRlckNvbW1lbnRFZGl0TW9kZShibG9jayk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g0KDQtdC20LjQvCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINGB0YHRi9C70LrQuAogICAgICAgIGZ1bmN0aW9uIGVudGVyTGlua0VkaXRNb2RlKGJsb2NrKSB7CiAgICAgICAgICAgIC8vINCS0YvRhdC+0LTQuNC8INC40Lcg0LTRgNGD0LPQuNGFINGA0LXQttC40LzQvtCyCiAgICAgICAgICAgIGV4aXRBbGxFZGl0TW9kZXMoKTsKCiAgICAgICAgICAgIGNvbnN0IHR5cGVFbGVtZW50ID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmxpbmstdHlwZScpOwogICAgICAgICAgICBjb25zdCB1cmxFbGVtZW50ID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmxpbmstdXJsJyk7CiAgICAgICAgICAgIGNvbnN0IGlzTmV3ID0gYmxvY2suZGF0YXNldC5pc05ld0xpbmsgPT09ICcxJzsKCiAgICAgICAgICAgIGNvbnN0IHJhd1R5cGUgPSB0eXBlRWxlbWVudCA/ICh0eXBlRWxlbWVudC50ZXh0Q29udGVudCB8fCAnJykudHJpbSgpIDogJyc7CiAgICAgICAgICAgIGNvbnN0IHJhd1VybCA9IHVybEVsZW1lbnQgPyAoKHVybEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdocmVmJykgfHwgdXJsRWxlbWVudC50ZXh0Q29udGVudCB8fCAnJykudHJpbSgpKSA6ICcnOwoKICAgICAgICAgICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INC+0YDQuNCz0LjQvdCw0LvRjNC90YvQtSDQt9C90LDRh9C10L3QuNGPICjQtNC70Y8g0L7RgtC60LDRgtCwKQogICAgICAgICAgICBibG9jay5kYXRhc2V0Lm9yaWdpbmFsVHlwZSA9IHJhd1R5cGU7CiAgICAgICAgICAgIGJsb2NrLmRhdGFzZXQub3JpZ2luYWxVcmwgID0gcmF3VXJsOwoKICAgICAgICAgICAgYmxvY2suY2xhc3NMaXN0LmFkZCgnZWRpdGluZycpOwogICAgICAgICAgICBibG9jay5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJsaW5rLWVkaXQiPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0ibGluay10eXBlLWlucHV0IiBwbGFjZWhvbGRlcj0i0KLQuNC/INGB0YHRi9C70LrQuCI+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InVybCIgY2xhc3M9ImxpbmstdXJsLWlucHV0IiBwbGFjZWhvbGRlcj0iaHR0cHM6Ly8uLi4iPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJsaW5rLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYW5nZXIgZGVsZXRlLWJ1dHRvbiIgdGl0bGU9ItCj0LTQsNC70LjRgtGMIiBhcmlhLWxhYmVsPSLQo9C00LDQu9C40YLRjCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgYXJpYS1oaWRkZW49InRydWUiIGZvY3VzYWJsZT0iZmFsc2UiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTUgMjBhMiAyIDAgMCAwIDIgMmgxMGEyIDIgMCAwIDAgMi0yVjhoMlY2aC00VjRhMiAyIDAgMCAwLTItMkg5YTIgMiAwIDAgMC0yIDJ2MkgzdjJoMnpNOSA0aDZ2Mkg5ek04IDhoOXYxMkg3Vjh6Ii8+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNOSAxMGgydjhIOXptNCAwaDJ2OGgtMnoiLz48L3N2Zz48L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBgOwoKICAgICAgICAgICAgY29uc3QgdHlwZUlucHV0ID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmxpbmstdHlwZS1pbnB1dCcpOwogICAgICAgICAgICBjb25zdCB1cmxJbnB1dCAgPSBibG9jay5xdWVyeVNlbGVjdG9yKCcubGluay11cmwtaW5wdXQnKTsKCiAgICAgICAgICAgIC8vINCU0LvRjyDRgdGD0YnQtdGB0YLQstGD0Y7RidC10Lkg0YHRgdGL0LvQutC4INC80L7QttC90L4g0L/QvtC00YHQutCw0LfQsNGC0Ywg0LTQtdGE0L7Qu9GCLCDQvdC+INC00LvRjyDQvdC+0LLQvtC5IOKAlCDRgtC+0LvRjNC60L4gcGxhY2Vob2xkZXIKICAgICAgICAgICAgaWYgKCFpc05ldykgewogICAgICAgICAgICAgICAgdHlwZUlucHV0LnZhbHVlID0gcmF3VHlwZSB8fCAn0KLQuNC/INGB0YHRi9C70LrQuCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0eXBlSW5wdXQudmFsdWUgPSByYXdUeXBlOwogICAgICAgICAgICAgICAgdHlwZUlucHV0LnBsYWNlaG9sZGVyID0gJ9Ci0LjQvyDRgdGB0YvQu9C60LgnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVybElucHV0LnZhbHVlICA9IHJhd1VybDsKCiAgICAgICAgICAgIC8vINCw0LLRgtC+LdGI0LjRgNC40L3QsCDRgtC40L/QsAogICAgICAgICAgICB1cGRhdGVMaW5rVHlwZVdpZHRoKHR5cGVJbnB1dCk7CgogICAgICAgICAgICAvLyBFbnRlci9Fc2NhcGUg0LfQsNCy0LXRgNGI0LDRjtGCINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40LUKICAgICAgICAgICAgY29uc3Qgb25LZXkgPSAoZXYpID0+IHsKICAgICAgICAgICAgICAgIGlmIChldi5rZXkgPT09ICdFc2NhcGUnKSB7CiAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICBleGl0TGlua0VkaXRNb2RlKGJsb2NrLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGV2LmtleSA9PT0gJ0VudGVyJykgewogICAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgZXhpdExpbmtFZGl0TW9kZShibG9jaywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICB0eXBlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uS2V5KTsKICAgICAgICAgICAgdXJsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uS2V5KTsKCiAgICAgICAgICAgIC8vINCf0LXRgNC10YDQsNGB0YfRkdGCINGI0LjRgNC40L3RiyDQv9GA0Lgg0LLQstC+0LTQtQogICAgICAgICAgICB0eXBlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB1cGRhdGVMaW5rVHlwZVdpZHRoKHR5cGVJbnB1dCkpOwogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gdXBkYXRlTGlua1R5cGVXaWR0aCh0eXBlSW5wdXQpKTsKCiAgICAgICAgICAgIC8vINCj0LTQsNC70LXQvdC40LUKICAgICAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmRlbGV0ZS1idXR0b24nKTsKICAgICAgICAgICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIGlmICghd2luZG93LmNvbmZpcm0oJ9Cj0LTQsNC70LjRgtGMINGB0YHRi9C70LrRgz8nKSkgcmV0dXJuOwogICAgICAgICAgICAgICAgYmxvY2sucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB1cGRhdGVFbXB0eVN0YXRlcygpOwogICAgICAgICAgICB9KTsvLyDQpNC+0LrRg9GBINCyIFVSTCwg0LXRgdC70Lgg0YLQuNC/INGD0LbQtSDQt9Cw0L/QvtC70L3QtdC9LCDQuNC90LDRh9C1INCyINGC0LjQvwogICAgICAgICAgICAodHlwZUlucHV0LnZhbHVlID8gdXJsSW5wdXQgOiB0eXBlSW5wdXQpLmZvY3VzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyDQktGL0YXQvtC0INC40Lcg0YDQtdC20LjQvNCwINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8g0YHRgdGL0LvQutC4CiAgICAgICAgZnVuY3Rpb24gZXhpdExpbmtFZGl0TW9kZShibG9jaywgc2F2ZSA9IHRydWUpIHsKICAgICAgICAgICAgY29uc3QgdHlwZUlucHV0ID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmxpbmstdHlwZS1pbnB1dCcpOwogICAgICAgICAgICBjb25zdCB1cmxJbnB1dCA9IGJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5saW5rLXVybC1pbnB1dCcpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHNhdmUgJiYgdHlwZUlucHV0ICYmIHVybElucHV0KSB7CiAgICAgICAgICAgICAgICBjb25zdCBuZXdUeXBlID0gdHlwZUlucHV0LnZhbHVlLnRyaW0oKTsKICAgICAgICAgICAgICAgIGNvbnN0IG5ld1VybCA9IHVybElucHV0LnZhbHVlLnRyaW0oKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdUeXBlICYmIG5ld1VybCkgewogICAgICAgICAgICAgICAgICAgIC8vINCh0L7RhdGA0LDQvdGP0LXQvCDQuNC30LzQtdC90LXQvdC40Y8KICAgICAgICAgICAgICAgICAgICBibG9jay5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpbmstaW5mbyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibGluay10eXBlIj4ke25ld1R5cGV9PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtuZXdVcmwgPyBgPGEgaHJlZj0iJHtuZXdVcmx9IiBjbGFzcz0ibGluay11cmwiIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vb3BlbmVyIG5vcmVmZXJyZXIiIHRpdGxlPSIke25ld1VybH0iPiR7bmV3VXJsfTwvYT5gIDogYDxzcGFuIGNsYXNzPSJsaW5rLXVybCBsaW5rLXVybC0tZW1wdHkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPjwvc3Bhbj5gfQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGluay1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYXJrIGVkaXQtYnV0dG9uIiB0aXRsZT0i0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwiIGFyaWEtbGFiZWw9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIj48c3BhbiBjbGFzcz0iaWNvbiI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTYgMi4wMTJsMyAzTDE2LjcxMyA3LjNsLTMtM3pNNCAxNHYzaDNsOC4yOTktOC4yODdsLTMtM3ptMCA2aDE2djJINHoiIGZpbGw9ImN1cnJlbnRDb2xvciIvPjwvc3ZnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8g0JXRgdC70Lgg0YfRgtC+LdGC0L4g0YPQtNCw0LvQuNC70Lgg0Lgg0L3QtSDQstCy0LXQu9C4INC30LDQvNC10L3RgzoKICAgICAgICAgICAgICAgICAgICAvLyAtINC00LvRjyDQvdC+0LLQvtC5INGB0YHRi9C70LrQuCDRg9C00LDQu9GP0LXQvCDQv9GD0YHRgtC+0Lkg0LHQu9C+0LoKICAgICAgICAgICAgICAgICAgICAvLyAtINC00LvRjyDRgdGD0YnQtdGB0YLQstGD0Y7RidC10Lkg0LLQvtC30LLRgNCw0YnQsNC10Lwg0LrQsNC6INCx0YvQu9C+CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNOZXcgPSBibG9jay5kYXRhc2V0LmlzTmV3TGluayA9PT0gJzEnOwogICAgICAgICAgICAgICAgICAgIGlmIChpc05ldykgewogICAgICAgICAgICAgICAgICAgICAgICBibG9jay5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRW1wdHlTdGF0ZXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxUeXBlID0gYmxvY2suZGF0YXNldC5vcmlnaW5hbFR5cGUgfHwgJ9Ci0LjQvyDRgdGB0YvQu9C60LgnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsVXJsID0gYmxvY2suZGF0YXNldC5vcmlnaW5hbFVybCB8fCAnJzsKICAgICAgICAgICAgICAgICAgICBibG9jay5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpbmstaW5mbyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibGluay10eXBlIj4ke29yaWdpbmFsVHlwZX08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke29yaWdpbmFsVXJsID8gYDxhIGhyZWY9IiR7b3JpZ2luYWxVcmx9IiBjbGFzcz0ibGluay11cmwiIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vb3BlbmVyIG5vcmVmZXJyZXIiIHRpdGxlPSIke29yaWdpbmFsVXJsfSI+JHtvcmlnaW5hbFVybH08L2E+YCA6IGA8c3BhbiBjbGFzcz0ibGluay11cmwgbGluay11cmwtLWVtcHR5IiBzdHlsZT0iZGlzcGxheTpub25lIj48L3NwYW4+YH0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpbmstYWN0aW9ucyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uLWJ0biBpY29uLWJ0bi0tZGFyayBlZGl0LWJ1dHRvbiIgdGl0bGU9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIiBhcmlhLWxhYmVsPSLQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCI+PHNwYW4gY2xhc3M9Imljb24iPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE2IDIuMDEybDMgM0wxNi43MTMgNy4zbC0zLTN6TTQgMTR2M2gzbDguMjk5LTguMjg3bC0zLTN6bTAgNmgxNnYySDR6IiBmaWxsPSJjdXJyZW50Q29sb3IiLz48L3N2Zz48L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyDQntGC0LzQtdC90LAg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjzoKICAgICAgICAgICAgICAgIC8vIC0g0LTQu9GPINC90L7QstC+0LPQviDQsdC70L7QutCwINCx0LXQtyDQt9Cw0L/QvtC70L3QtdC90LjRjzog0YPQtNCw0LvRj9C10LwKICAgICAgICAgICAgICAgIC8vIC0g0LTQu9GPINGB0YPRidC10YHRgtCy0YPRjtGJ0LXQs9C+OiDQvtGC0LrQsNGC0YvQstCw0LXQvCDQutCw0Log0LHRi9C70L4KICAgICAgICAgICAgICAgIGNvbnN0IGlzTmV3ID0gYmxvY2suZGF0YXNldC5pc05ld0xpbmsgPT09ICcxJzsKICAgICAgICAgICAgICAgIGlmIChpc05ldykgewogICAgICAgICAgICAgICAgICAgIC8vINCd0L7QstGL0Lkg0LHQu9C+0Log0L3QtdC70YzQt9GPICLQvtGC0LzQtdC90LjRgtGMIiDQuCDQvtGB0YLQsNCy0LjRgtGMINC90LAg0YHRgtGA0LDQvdC40YbQtSDigJQg0YPQtNCw0LvRj9C10LwuCiAgICAgICAgICAgICAgICAgICAgYmxvY2sucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlRW1wdHlTdGF0ZXMoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgovLyDQktC+0YHRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0L7RgNC40LPQuNC90LDQu9GM0L3Ri9C1INC30L3QsNGH0LXQvdC40Y8KICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsVHlwZSA9IGJsb2NrLmRhdGFzZXQub3JpZ2luYWxUeXBlIHx8ICfQotC40L8g0YHRgdGL0LvQutC4JzsKICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsVXJsID0gYmxvY2suZGF0YXNldC5vcmlnaW5hbFVybCB8fCAnJzsKICAgICAgICAgICAgICAgIGJsb2NrLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJsaW5rLWluZm8iPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibGluay10eXBlIj4ke29yaWdpbmFsVHlwZX08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICR7b3JpZ2luYWxVcmwgPyBgPGEgaHJlZj0iJHtvcmlnaW5hbFVybH0iIGNsYXNzPSJsaW5rLXVybCIgdGFyZ2V0PSJfYmxhbmsiIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciIgdGl0bGU9IiR7b3JpZ2luYWxVcmx9Ij4ke29yaWdpbmFsVXJsfTwvYT5gIDogYDxzcGFuIGNsYXNzPSJsaW5rLXVybCBsaW5rLXVybC0tZW1wdHkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPjwvc3Bhbj5gfQogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpbmstYWN0aW9ucyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYXJrIGVkaXQtYnV0dG9uIiB0aXRsZT0i0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwiIGFyaWEtbGFiZWw9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIj48c3BhbiBjbGFzcz0iaWNvbiI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTYgMi4wMTJsMyAzTDE2LjcxMyA3LjNsLTMtM3pNNCAxNHYzaDNsOC4yOTktOC4yODdsLTMtM3ptMCA2aDE2djJINHoiIGZpbGw9ImN1cnJlbnRDb2xvciIvPjwvc3ZnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2VkaXRpbmcnKTsKICAgICAgICAgICAgZGVsZXRlIGJsb2NrLmRhdGFzZXQub3JpZ2luYWxUeXBlOwogICAgICAgICAgICBkZWxldGUgYmxvY2suZGF0YXNldC5vcmlnaW5hbFVybDsKICAgICAgICAgICAgZGVsZXRlIGJsb2NrLmRhdGFzZXQuaXNOZXdMaW5rOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8g0JLQvtC30LLRgNCw0YnQsNC10Lwg0L7QsdGA0LDQsdC+0YLRh9C40Log0L3QsCDQutC90L7Qv9C60YMg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjwogICAgICAgICAgICBjb25zdCBuZXdFZGl0QnRuID0gYmxvY2sucXVlcnlTZWxlY3RvcignLmVkaXQtYnV0dG9uJyk7CiAgICAgICAgICAgIGlmIChuZXdFZGl0QnRuKSB7CiAgICAgICAgICAgICAgICBuZXdFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgZW50ZXJMaW5rRWRpdE1vZGUoYmxvY2spOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vINCU0L7QsdCw0LLQu9C10L3QuNC1INC90L7QstC+0LPQviDQutC+0LzQvNC10L3RgtCw0YDQuNGPCiAgICAgICAgZnVuY3Rpb24gYWRkTmV3Q29tbWVudCgpIHsKICAgICAgICAgICAgY29uc3QgY29tbWVudHNMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRzTGlzdCcpOwogICAgICAgICAgICBjb25zdCBuZXdJZCA9IERhdGUubm93KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBuZXdDb21tZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIG5ld0NvbW1lbnQuY2xhc3NOYW1lID0gJ2NvbW1lbnQtYmxvY2snOwogICAgICAgICAgICBuZXdDb21tZW50LmRhdGFzZXQuY29tbWVudElkID0gbmV3SWQ7CiAgICAgICAgICAgIAogICAgICAgICAgICBuZXdDb21tZW50LmRhdGFzZXQuaXNOZXdDb21tZW50ID0gJzEnO25ld0NvbW1lbnQuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29tbWVudC10ZXh0Ij48L2Rpdj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imljb24tYnRuIGljb24tYnRuLS1kYXJrIGVkaXQtYnV0dG9uIiB0aXRsZT0i0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwiIGFyaWEtbGFiZWw9ItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMIj48c3BhbiBjbGFzcz0iaWNvbiI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTYgMi4wMTJsMyAzTDE2LjcxMyA3LjNsLTMtM3pNNCAxNHYzaDNsOC4yOTktOC4yODdsLTMtM3ptMCA2aDE2djJINHoiIGZpbGw9ImN1cnJlbnRDb2xvciIvPjwvc3ZnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbW1lbnRzTGlzdC5hcHBlbmRDaGlsZChuZXdDb21tZW50KTsKICAgICAgICAgICAgdXBkYXRlRW1wdHlTdGF0ZXMoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vINCh0YDQsNC30YMg0LLRhdC+0LTQuNC8INCyINGA0LXQttC40Lwg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjwogICAgICAgICAgICBlbnRlckNvbW1lbnRFZGl0TW9kZShuZXdDb21tZW50KTsKICAgICAgICB9CgogICAgICAgIC8vINCU0L7QsdCw0LLQu9C10L3QuNC1INC90L7QstC+0Lkg0YHRgdGL0LvQutC4CiAgICAgICAgZnVuY3Rpb24gYWRkTmV3TGluaygpIHsKICAgICAgICAgICAgY29uc3QgbGlua3NMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtzTGlzdCcpOwogICAgICAgICAgICBjb25zdCBuZXdJZCA9IERhdGUubm93KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBuZXdMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIG5ld0xpbmsuY2xhc3NOYW1lID0gJ2xpbmstaXRlbSc7CiAgICAgICAgICAgIG5ld0xpbmsuZGF0YXNldC5saW5rSWQgPSBuZXdJZDsKICAgICAgICAgICAgbmV3TGluay5kYXRhc2V0LmlzTmV3TGluayA9ICcxJzsKICAgICAgICAgICAgbmV3TGluay5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJsaW5rLWluZm8iPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsaW5rLXR5cGUiPjwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibGluay11cmwgbGluay11cmwtLWVtcHR5IiBzdHlsZT0iZGlzcGxheTpub25lIj48L3NwYW4+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpbmstYWN0aW9ucyI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbi1idG4gaWNvbi1idG4tLWRhcmsgZWRpdC1idXR0b24iIHRpdGxlPSLQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCIgYXJpYS1sYWJlbD0i0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwiPjxzcGFuIGNsYXNzPSJpY29uIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xNiAyLjAxMmwzIDNMMTYuNzEzIDcuM2wtMy0zek00IDE0djNoM2w4LjI5OS04LjI4N2wtMy0zem0wIDZoMTZ2Mkg0eiIgZmlsbD0iY3VycmVudENvbG9yIi8+PC9zdmc+PC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIAogICAgICAgICAgICBsaW5rc0xpc3QuYXBwZW5kQ2hpbGQobmV3TGluayk7CiAgICAgICAgICAgIHVwZGF0ZUVtcHR5U3RhdGVzKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyDQodGA0LDQt9GDINCy0YXQvtC00LjQvCDQsiDRgNC10LbQuNC8INGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8KICAgICAgICAgICAgZW50ZXJMaW5rRWRpdE1vZGUobmV3TGluayk7CiAgICAgICAgfQogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg==';

// ======= DRAWER (правая панель) =======
const drawer = document.getElementById('drawer');
const drawerOverlay = document.getElementById('drawerOverlay');
const drawerClose = document.getElementById('drawerClose');
const drawerResizer = document.getElementById('drawerResizer');

const DRAWER_WIDTH_KEY = 'drawerWidthPx';
const MAX_DRAWER_VW = 95; // max drawer width as % of viewport
const SNAP_HANDLE_PX = 20;   // S0: visible handle width when drawer is closed (must match --drawer-offset default in CSS)
const CARD_MIN_WIDTH = 300;  // minmax(300px, 1fr) from CSS
const GRID_GAP = 24;         // gap: var(--space-unit)
const BODY_SIDE_PAD = 24;    // padding: var(--page-pad)

let isResizing = false;
let _dragSnapPx = SNAP_HANDLE_PX; // tracks snap position during drag

/**
 * Returns the valid discrete snap widths for the drawer in the current viewport.
 * Ordered smallest → largest (S0, then S3, S2, S1 where available).
 *   S0 = SNAP_HANDLE_PX (handle-only, drawer is closed via CSS transform)
 *   S3 = widest drawer where 3 card columns still fit
 *   S2 = widest drawer where 2 card columns still fit
 *   S1 = widest drawer where 1 card column still fit
 */
function getSnapWidths() {
  const vw = window.innerWidth;
  const snaps = [SNAP_HANDLE_PX]; // S0 is always present

  // Available content width = vw - 2*bodyPad - drawerWidth
  // For N columns: content >= N*CARD_MIN_WIDTH + (N-1)*GRID_GAP
  // → drawerWidth = vw - 2*BODY_SIDE_PAD - (N*CARD_MIN_WIDTH + (N-1)*GRID_GAP)
  const colWidths = [
    vw - 2 * BODY_SIDE_PAD - (3 * CARD_MIN_WIDTH + 2 * GRID_GAP), // S3
    vw - 2 * BODY_SIDE_PAD - (2 * CARD_MIN_WIDTH + GRID_GAP),     // S2
    vw - 2 * BODY_SIDE_PAD - CARD_MIN_WIDTH,                       // S1
  ];

  for (const w of colWidths) {
    if (w > SNAP_HANDLE_PX) snaps.push(w);
  }

  return snaps.sort((a, b) => a - b);
}

/** Returns the snap point nearest to px. */
function nearestSnap(px) {
  const snaps = getSnapWidths();
  return snaps.reduce((best, s) => Math.abs(s - px) < Math.abs(best - px) ? s : best, snaps[0]);
}

/**
 * Applies a body CSS class (drawer-state-s1/s2/s3) that matches the snap index,
 * so the car grid switches to the correct column count at each snap position.
 * The number of columns equals (snaps.length - snapIndex):
 *   last snap (widest drawer)  → 1 column  → drawer-state-s1
 *   second-last               → 2 columns → drawer-state-s2
 *   third-last (if present)   → 3 columns → drawer-state-s3
 */
function applyDrawerState(snapPx) {
  document.body.classList.remove('drawer-state-s1', 'drawer-state-s2', 'drawer-state-s3');
  if (snapPx <= SNAP_HANDLE_PX) return;
  const snaps = getSnapWidths();
  const idx = snaps.findIndex(s => Math.abs(s - snapPx) < 1);
  if (idx < 0) return;
  document.body.classList.add(`drawer-state-s${snaps.length - idx}`);
}

/**
 * Default open width: prefer S2 (2 columns), fall back to whatever is available.
 */
function getDefaultDrawerWidth() {
  const open = getSnapWidths().filter(s => s > SNAP_HANDLE_PX);
  // open is [S3?, S2?, S1?] sorted ascending; pick S2 (index -2) or the largest available
  return open.length >= 2 ? open[open.length - 2] : (open[open.length - 1] || SNAP_HANDLE_PX);
}

// Path to the HTML file used to populate the drawer iframe.  Loading
// an external file keeps this script short and eliminates the need to
// inline massive base64-encoded HTML content (which can easily break
// during editing). When the drawer is opened, we set the iframe's
// src attribute to this value.
const DRAWER_SRC = 'page2_fixed_page1_additional_FINAL_v9_no_bg_content_archive_headers.htm';

function isNarrowScreen() {
  return window.matchMedia('(max-width: 600px)').matches;
}

function clamp(v, min, max) {
  return Math.min(Math.max(v, min), max);
}

function applyDrawerWidth(px) {
  if (isNarrowScreen()) {
    drawer.style.width = '100vw';
    document.documentElement.style.setProperty('--drawer-offset', '0px');
    return;
  }
  const maxPx = Math.floor(window.innerWidth * (MAX_DRAWER_VW / 100));
  // Allow widths down to just above the handle so the user can drag toward S0
  const safePx = clamp(px, SNAP_HANDLE_PX + 1, maxPx);
  drawer.style.width = `${safePx}px`;
  document.documentElement.style.setProperty('--drawer-offset', `${safePx}px`);
}

function loadDrawerWidth() {
  const stored = parseInt(localStorage.getItem(DRAWER_WIDTH_KEY) || '', 10);
  const base = (Number.isFinite(stored) && stored > 0) ? stored : getDefaultDrawerWidth();
  // Always snap to a valid discrete position
  const snapped = nearestSnap(base);
  return snapped > SNAP_HANDLE_PX ? snapped : getDefaultDrawerWidth();
}

function saveDrawerWidth(px) {
  if (isNarrowScreen()) return; // на узком не сохраняем
  localStorage.setItem(DRAWER_WIDTH_KEY, String(px));
}

function openDrawer() {
  const drawerIframe = document.getElementById('drawerIframe');
  // Always load our external page into the iframe when opening the drawer.  Using
  // a separate HTML file via the DRAWER_SRC constant keeps this script
  // manageable and avoids inlining massive base64 strings that can break parsing.
  if (drawerIframe && drawerIframe.src !== DRAWER_SRC) {
    drawerIframe.src = DRAWER_SRC;
  }

  // ширина при открытии — snap to nearest valid discrete position
  const targetWidth = loadDrawerWidth();
  applyDrawerWidth(targetWidth);
  applyDrawerState(targetWidth);

  drawer.classList.add('open');
  drawer.setAttribute('aria-hidden', 'false');
  drawerOverlay.classList.add('visible');
  drawerOverlay.setAttribute('aria-hidden', 'false');
  // Fix card widths to 300 px while the drawer is open so cards never
  // resize during drag or snap — the whole grid block shifts left instead.
  document.body.classList.add('drawer-open');
}

function closeDrawer() {
  drawer.classList.remove('open');
  drawer.setAttribute('aria-hidden', 'true');
  drawerOverlay.classList.remove('visible');
  drawerOverlay.setAttribute('aria-hidden', 'true');
  document.body.classList.remove('drawer-open');
  document.body.classList.remove('drawer-state-s1', 'drawer-state-s2', 'drawer-state-s3');
  // Reset offset so body padding shrinks back to handle-only (20 px on desktop, 0 on mobile)
  document.documentElement.style.setProperty(
    '--drawer-offset',
    isNarrowScreen() ? '0px' : `${SNAP_HANDLE_PX}px`
  );
}

drawerClose.addEventListener('click', closeDrawer);
drawerOverlay.addEventListener('click', closeDrawer);

document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && drawer.classList.contains('open')) {
    closeDrawer();
  }
});

// ресайз (только десктоп/широкий)
function onResizeStart(e) {
  if (isNarrowScreen()) return;
  if (!drawer.classList.contains('open')) {
    openDrawer();
    return;
  }
  e.preventDefault();
  e.stopPropagation();
  isResizing = true;
  document.body.style.userSelect = 'none';
  // Record current snap so we detect when the nearest snap changes
  const currentWidth = parseInt(getComputedStyle(drawer).width, 10);
  _dragSnapPx = nearestSnap(Number.isFinite(currentWidth) ? currentWidth : loadDrawerWidth());
}

function onResizeMove(e) {
  if (!isResizing) return;
  const clientX = (e.touches && e.touches[0]) ? e.touches[0].clientX : e.clientX;
  if (typeof clientX !== 'number') return;

  // drawer is on the right: width = windowWidth - cursor position
  const nextWidth = window.innerWidth - clientX;
  const targetSnap = nearestSnap(nextWidth);

  // Only act when the nearest snap changes — this produces the "step" feel
  if (targetSnap === _dragSnapPx) return;
  _dragSnapPx = targetSnap;

  if (targetSnap <= SNAP_HANDLE_PX) {
    // Animate toward closed — keep isResizing so the user can drag back
    drawer.classList.remove('open');
    drawer.setAttribute('aria-hidden', 'true');
    document.documentElement.style.setProperty('--drawer-offset', `${SNAP_HANDLE_PX}px`);
    document.body.classList.remove('drawer-state-s1', 'drawer-state-s2', 'drawer-state-s3');
  } else {
    // Re-open if we dragged back from S0
    if (!drawer.classList.contains('open')) {
      drawer.classList.add('open');
      drawer.setAttribute('aria-hidden', 'false');
    }
    applyDrawerWidth(targetSnap);
    applyDrawerState(targetSnap);
  }
}

function onResizeEnd() {
  if (!isResizing) return;
  isResizing = false;
  document.body.style.userSelect = '';

  // Drawer is already at the last snapped position; finalise the state
  if (_dragSnapPx <= SNAP_HANDLE_PX) {
    closeDrawer();
  } else {
    // Ensure overlay and body class are set (they may have been cleared during drag to S0)
    if (!drawerOverlay.classList.contains('visible')) {
      drawerOverlay.classList.add('visible');
      drawerOverlay.setAttribute('aria-hidden', 'false');
      document.body.classList.add('drawer-open');
    }
    applyDrawerWidth(_dragSnapPx);
    applyDrawerState(_dragSnapPx);
    saveDrawerWidth(_dragSnapPx);
  }
}

if (drawerResizer) {
  drawerResizer.addEventListener('mousedown', onResizeStart);
  drawerResizer.addEventListener('touchstart', onResizeStart, { passive: false });
}
window.addEventListener('mousemove', onResizeMove);
window.addEventListener('touchmove', onResizeMove, { passive: false });
window.addEventListener('mouseup', onResizeEnd);
window.addEventListener('touchend', onResizeEnd);

// при смене размера окна — подгоняем ширину под ограничения
window.addEventListener('resize', () => {
  if (!drawer.classList.contains('open')) {
    // Keep handle offset correct (0 on mobile, SNAP_HANDLE_PX on desktop)
    document.documentElement.style.setProperty(
      '--drawer-offset',
      isNarrowScreen() ? '0px' : `${SNAP_HANDLE_PX}px`
    );
    return;
  }
  // Re-snap to nearest valid point for new viewport width
  const current = parseInt(getComputedStyle(drawer).width, 10);
  const snap = nearestSnap(Number.isFinite(current) ? current : loadDrawerWidth());
  if (snap <= SNAP_HANDLE_PX) {
    closeDrawer();
  } else {
    applyDrawerWidth(snap);
    applyDrawerState(snap);
  }
});

// ======= FULLSCREEN PHOTO VIEWER HANDLERS =======
const photoOverlay = document.getElementById('photoViewerOverlay');
const photoImgEl = document.getElementById('photoViewerImg');
function openPhotoViewer(src) {
  if (!photoOverlay || !photoImgEl) return;
  photoImgEl.src = src;
  photoOverlay.classList.add('open');
  photoOverlay.setAttribute('aria-hidden', 'false');
  document.body.style.overflow = 'hidden';
}
function closePhotoViewer() {
  if (!photoOverlay || !photoImgEl) return;
  photoOverlay.classList.remove('open');
  photoOverlay.setAttribute('aria-hidden', 'true');
  photoImgEl.src = '';
  document.body.style.overflow = '';
}
if (photoOverlay) {
  photoOverlay.addEventListener('click', closePhotoViewer);
}
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && photoOverlay && photoOverlay.classList.contains('open')) {
    closePhotoViewer();
  }
});
window.addEventListener('message', (e) => {
  try {
    if (e.data && e.data.type === 'photo_open' && e.data.src) {
      openPhotoViewer(e.data.src);
    }
  } catch(err) {}
});

// ======= LOGIN HANDLERS =======
document.getElementById('loginForm').addEventListener('submit', function(event) {
  event.preventDefault();
  const login = loginInput.value.trim();
  const password = passwordInput.value.trim();

  removeErrorState();

  if (password === '123') {
    const normLogin = normalizeLoginValue(login);
    const isAdminLogin = normLogin === 'ADMIN';
    const photographerFilter = getPhotographerFilter(normLogin);

    if (isAdminLogin || photographerFilter) {
      setSession(login, isAdminLogin ? 'admin' : 'photographer', isAdminLogin ? null : photographerFilter);

      // SUCCESS UI: подсветка + задержка
      loginInput.classList.add('success');
      passwordInput.classList.add('success');
      loginButton.disabled = true;

      // применяем роль сразу
      applyAccessControl(getSession());
      renderCars();

      setTimeout(() => {
        hideLogin();
        adjustContentOffset();
      }, 800);
    } else {
      loginInput.classList.add('error');
      passwordInput.classList.add('error');
      errorMessage.classList.add('visible');
    }
  } else {

    loginInput.classList.add('error');
    passwordInput.classList.add('error');
    errorMessage.classList.add('visible');
  }
});

// Enter = login
[loginInput, passwordInput].forEach(el => {
  el.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') loginButton.click();
  });
  el.addEventListener('input', removeErrorState);
});

// ======= INIT: проверяем сессию до запуска UI =======
// Initialise --drawer-offset immediately so the body padding is correct
// even before the drawer is ever opened.
document.documentElement.style.setProperty(
  '--drawer-offset',
  isNarrowScreen() ? '0px' : `${SNAP_HANDLE_PX}px`
);

const _initSession = getSession();
if (!_initSession) {
  showLogin();
} else {
  hideLogin();
  applyAccessControl(_initSession);
  renderCars();
  adjustContentOffset();
}
